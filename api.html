<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elvion AI | Developer API Documentation</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark-space: #0d0c22;
            --bg-content: #110f2c;
            --bg-sidebar: #0a091a;
            --bg-interactive: #000000;
            --text-primary: #e0e0e0;
            --text-secondary: #a0a0b0;
            --text-headings: #ffffff;
            --border-color: #2a284d;
            --accent-purple: #9f55ff;
            --accent-pink: #e040fb;
            --accent-blue: #00bfff;
            --accent-green: #4ade80;
            --accent-red: #f87171;
            --accent-yellow: #facc15;
            --font-body: 'Inter', sans-serif;
            --font-code: 'Fira Code', monospace;
            --shadow-glow: 0 0 15px rgba(159, 85, 255, 0.3);
        }

        *, *::before, *::after {
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            margin: 0;
            font-family: var(--font-body);
            background-color: var(--bg-dark-space);
            color: var(--text-primary);
            font-size: 16px;
            line-height: 1.7;
            overflow: hidden;
            display: flex;
            height: 100vh;
        }

        /* --- Main 3-Column Layout --- */
        .api-layout {
            display: grid;
            grid-template-columns: 280px 1fr 45%;
            width: 100%;
            height: 100vh;
        }

        /* --- Scrollbar Styling --- */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-dark-space);
        }
        ::-webkit-scrollbar-thumb {
            background-color: var(--border-color);
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background-color: var(--accent-purple);
        }

        /* --- 1. Sidebar --- */
        .sidebar {
            background-color: var(--bg-sidebar);
            border-right: 1px solid var(--border-color);
            padding: 1.5rem 0;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }

        .sidebar-header {
            padding: 0 1.5rem 1.5rem;
            border-bottom: 1px solid var(--border-color);
        }
        .sidebar-header h1 {
            margin: 0;
            font-size: 1.8rem;
            color: var(--text-headings);
            font-weight: 700;
            text-shadow: 0 0 8px var(--accent-purple);
        }
        .sidebar-header h1 span {
            color: var(--accent-purple);
        }
        .sidebar-header p {
            margin: 5px 0 0;
            color: var(--text-secondary);
            font-size: 0.8rem;
        }

        .api-key-section {
            padding: 1.5rem;
        }
        .api-key-section label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            font-weight: 500;
            display: block;
            margin-bottom: 0.5rem;
        }
        #api-key-input {
            width: 100%;
            background-color: var(--bg-dark-space);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.6rem;
            color: var(--text-primary);
            font-family: var(--font-code);
            font-size: 0.85rem;
        }
        #api-key-input:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: var(--shadow-glow);
        }

        .sidebar-nav {
            flex-grow: 1;
        }
        .sidebar-nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .sidebar-nav .nav-category {
            padding: 1.5rem 1.5rem 0.5rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            color: var(--text-secondary);
        }
        .sidebar-nav li a {
            display: block;
            padding: 0.6rem 1.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }
        .sidebar-nav li a:hover {
            color: var(--text-primary);
            background-color: rgba(159, 85, 255, 0.1);
        }
        .sidebar-nav li a.active {
            color: var(--accent-purple);
            border-left-color: var(--accent-purple);
            font-weight: 500;
            background-color: rgba(159, 85, 255, 0.05);
        }

        /* --- 2. Documentation Content --- */
        .documentation-content {
            background-color: var(--bg-content);
            padding: 3rem;
            overflow-y: auto;
        }

        .doc-section {
            margin-bottom: 5rem;
            padding-top: 2rem;
        }

        .doc-section h2 {
            font-size: 2.25rem;
            color: var(--text-headings);
            margin: 0 0 1rem 0;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        .doc-section h2 .method-badge {
            font-size: 1rem;
            padding: 0.3rem 0.7rem;
            border-radius: 6px;
            color: #fff;
            margin-right: 0.75rem;
            vertical-align: middle;
        }
        .method-badge.POST { background-color: var(--accent-purple); }
        .method-badge.GET { background-color: var(--accent-blue); }

        .doc-section h3 {
            font-size: 1.5rem;
            color: var(--text-headings);
            margin-top: 2.5rem;
            margin-bottom: 1rem;
        }
        
        p, li { color: var(--text-secondary); line-height: 1.8; }
        a { color: var(--accent-pink); text-decoration: none; }
        a:hover { text-decoration: underline; }

        code {
            font-family: var(--font-code);
            background-color: var(--bg-dark-space);
            padding: 0.2em 0.4em;
            border-radius: 4px;
            font-size: 0.9em;
            color: var(--accent-pink);
        }
        
        .endpoint-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            background-color: var(--bg-dark-space);
            padding: 0.75rem 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            margin: 1.5rem 0;
            flex-wrap: wrap;
        }
        .endpoint-info .path {
            font-family: var(--font-code);
            color: var(--text-primary);
        }
        .info-badge {
            padding: 0.3rem 0.8rem;
            border-radius: 16px;
            font-size: 0.8rem;
            font-weight: 500;
        }
        .cost-badge { background-color: var(--accent-yellow); color: #000; }
        .auth-badge { background-color: var(--accent-blue); color: #fff; }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1.5rem;
            font-size: 0.95rem;
        }
        th, td {
            padding: 1rem;
            text-align: left;
            border: 1px solid var(--border-color);
        }
        th {
            background-color: var(--bg-dark-space);
            color: var(--text-headings);
            font-weight: 500;
        }
        .required { color: var(--accent-red); font-weight: 700; }

        /* --- 3. Interactive Panel --- */
        .interactive-panel {
            background-color: var(--bg-interactive);
            padding: 3rem;
            overflow-y: auto;
            position: sticky;
            top: 0;
            height: 100vh;
        }

        .panel-content { display: none; }
        .panel-content.active { display: block; }
        
        .panel-content h3 {
            font-size: 1.2rem;
            color: var(--text-headings);
            margin: 0 0 1rem 0;
        }
        
        /* Code Examples Styling */
        .code-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }
        .code-tab {
            padding: 0.75rem 1rem;
            cursor: pointer;
            border: none;
            background: none;
            color: var(--text-secondary);
            font-family: var(--font-body);
            font-size: 0.9rem;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }
        .code-tab.active, .code-tab:hover {
            color: var(--accent-purple);
            border-bottom-color: var(--accent-purple);
        }

        .code-block { position: relative; }
        .code-block pre {
            background-color: #0d0d0d;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin: 0;
            padding: 1.25rem;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .code-block pre code { background-color: transparent; padding: 0; }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--border-color);
            border: 1px solid var(--border-color);
            color: var(--text-primary);
            padding: 0.4rem 0.7rem;
            border-radius: 6px;
            cursor: pointer;
            opacity: 0.5;
            transition: all 0.2s ease;
        }
        .code-block:hover .copy-btn { opacity: 1; }
        .copy-btn:hover { background-color: var(--accent-purple); }

        /* "Try It Out" Console Styling */
        .try-it-out {
            margin-top: 2.5rem;
            padding: 1.5rem;
            background-color: var(--bg-dark-space);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }
        .try-it-out h4 {
            font-size: 1rem;
            color: var(--text-headings);
            margin: 0 0 1rem 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 0.75rem;
        }
        .form-group { margin-bottom: 1rem; }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }
        .form-group input, .form-group textarea {
            width: 100%;
            background: var(--bg-interactive);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.7rem;
            color: var(--text-primary);
            font-family: var(--font-body);
        }
        .form-group textarea {
            min-height: 100px;
            font-family: var(--font-code);
            resize: vertical;
        }
        .execute-btn {
            width: 100%;
            padding: 0.8rem;
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-pink));
            border: none;
            border-radius: 6px;
            color: #fff;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .execute-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 20px rgba(159, 85, 255, 0.4);
        }
        .response-area {
            margin-top: 1.5rem;
        }
        .response-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            background: var(--bg-interactive);
            border: 1px solid var(--border-color);
            border-radius: 6px 6px 0 0;
            font-family: var(--font-code);
            font-size: 0.9rem;
        }
        .status-code.success { color: var(--accent-green); }
        .status-code.error { color: var(--accent-red); }
        .response-output {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-top: none;
            border-radius: 0 0 6px 6px;
            background: #0d0d0d;
        }
        .response-output pre {
            margin: 0;
            padding: 1rem;
            background: transparent;
            border: none;
        }
        
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
</head>
<body>

<div class="api-layout">
    <!-- SIDENAV -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h1>Elvion<span>AI</span></h1>
            <p>API Reference v2.0.0</p>
        </div>
        <div class="api-key-section">
            <label for="api-key-input">Your API Key</label>
            <input type="password" id="api-key-input" placeholder="Paste your API key here">
        </div>
        <nav class="sidebar-nav">
            <ul>
                <li class="nav-category">Getting Started</li>
                <li><a href="#introduction" class="nav-link active">Introduction</a></li>
                <li><a href="#authentication" class="nav-link">Authentication</a></li>
                
                <li class="nav-category">Developer Endpoints</li>
                <li><a href="#dev-seraphina-chat" class="nav-link">Seraphina Chat</a></li>
                <li><a href="#dev-bobby-chat" class="nav-link">Bobby Chat</a></li>
                <li><a href="#dev-generate-image" class="nav-link">Generate Image</a></li>

                <li class="nav-category">Account Management</li>
                <li><a href="#auth-create-key" class="nav-link">Create API Key</a></li>
                <li><a href="#auth-get-keys" class="nav-link">Get Keys & Balance</a></li>
                
                <li class="nav-category">Payments</li>
                <li><a href="#payments-initiate" class="nav-link">Initiate Funding</a></li>
            </ul>
        </nav>
    </aside>

    <!-- MAIN DOCUMENTATION -->
    <main class="documentation-content">
        <section id="introduction" class="doc-section">
            <h2>Introduction</h2>
            <p>Welcome to the Elvion AI Developer API, your gateway to integrating our powerful suite of generative AI models into your own applications. Our API is designed to be intuitive, robust, and versatile, empowering you to build next-generation experiences with advanced conversational AI, image generation, and more.</p>
            <p>This interactive documentation provides a comprehensive overview of all available endpoints. You can test every endpoint live from this page by entering your API key in the sidebar.</p>
        </section>

        <section id="authentication" class="doc-section">
            <h2>Authentication</h2>
            <p>Our API uses two primary methods of authentication depending on the endpoint's purpose.</p>
            
            <h3>Developer API Keys (Bearer Token)</h3>
            <p>For accessing our core AI models (Seraphina, Bobby, Image Generation), you must use an API key. Pass your key in the `Authorization` header as a Bearer token.</p>
            <code>Authorization: Bearer YOUR_API_KEY</code>
            <p>You can generate and manage your keys from the <a href="https://elvionai.com.ng/developer-dashboard.html" target="_blank">Elvion AI Developer Dashboard</a>. Generating a key costs 100 credits, and each subsequent API call will deduct credits from your account based on the model used.</p>
            
            <h3>Firebase Authentication (X-Firebase-Token)</h3>
            <p>Endpoints related to managing your account, such as creating keys or initiating payments, require your Firebase ID token. This is handled automatically when you are logged into our developer dashboard. The token should be passed in the `X-Firebase-Token` header.</p>
        </section>

        <!-- DEV ENDPOINTS -->
        <section id="dev-seraphina-chat" class="doc-section">
            <h2><span class="method-badge POST">POST</span>Seraphina Chat</h2>
            <p>Engage with Seraphina, our advanced research and reasoning model powered by Perplexity. This endpoint is ideal for applications requiring deep analysis, fact-checked answers with citations, and professional content generation. It supports streaming for real-time, interactive experiences.</p>
            <div class="endpoint-info">
                <span class="path">/api/developer/seraphina/chat</span>
                <span class="info-badge cost-badge">5 Credits / call</span>
                <span class="info-badge auth-badge">Bearer Token</span>
            </div>

            <h3>Request Body</h3>
            <table>
                <thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>message</code></td><td>string <span class="required">*</span></td><td>The latest user message to send to the model.</td></tr>
                    <tr><td><code>history</code></td><td>array (objects)</td><td>An array of previous messages (role: 'user' or 'assistant', content: 'string') to provide conversation context. Must be valid JSON.</td></tr>
                    <tr><td><code>stream</code></td><td>boolean</td><td>Whether to stream the response back. For the "Try It Out" console, this is handled internally. Defaults to `true`.</td></tr>
                </tbody>
            </table>
        </section>

        <section id="dev-bobby-chat" class="doc-section">
            <h2><span class="method-badge POST">POST</span>Bobby Chat</h2>
            <p>Access Bobby, our thoughtful and dependable chat model based on Thena's Llama implementation. Bobby excels at coding, creative writing, and general conversation. It's a cost-effective choice for a wide range of applications.</p>
            <div class="endpoint-info">
                <span class="path">/api/developer/bobby/chat</span>
                <span class="info-badge cost-badge">2 Credits / call</span>
                <span class="info-badge auth-badge">Bearer Token</span>
            </div>
            <h3>Request Body</h3>
            <table>
                <thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead>
                <tbody>
                    <tr><td><code>prompt</code></td><td>string <span class="required">*</span></td><td>The user's prompt or message.</td></tr>
                    <tr><td><code>systemPrompt</code></td><td>string</td><td>An optional system prompt to guide the model's behavior. Defaults to Bobby's internal persona.</td></tr>
                </tbody>
            </table>
        </section>

        <section id="dev-generate-image" class="doc-section">
            <h2><span class="method-badge POST">POST</span>Generate Image</h2>
            <p>Create stunning, high-quality images from a text prompt. This versatile endpoint can use either the advanced Thena models or the creative MiniMax engine, giving you flexibility in style and output.</p>
             <div class="endpoint-info">
                <span class="path">/api/developer/generate-image</span>
                <span class="info-badge cost-badge">15 Credits / call</span>
                <span class="info-badge auth-badge">Bearer Token</span>
            </div>
            <h3>Request Body</h3>
            <table>
                 <thead><tr><th>Parameter</th><th>Type</th><th>Description</th></tr></thead>
                 <tbody>
                    <tr><td><code>prompt</code></td><td>string <span class="required">*</span></td><td>A detailed description of the image you want to create.</td></tr>
                    <tr><td><code>model</code></td><td>string</td><td>(Thena only) The specific model to use. E.g., `v6`, `photoreal`, `anime_core`. Defaults to `v6`.</td></tr>
                    <tr><td><code>use_minimax</code></td><td>boolean</td><td>Set to `true` to use the MiniMax engine instead of Thena. Defaults to `false`.</td></tr>
                 </tbody>
            </table>
        </section>
        
        <!-- Other sections would follow the same pattern -->

    </main>

    <!-- INTERACTIVE PANEL -->
    <aside class="interactive-panel">
        
        <!-- Seraphina Chat Panel -->
        <div id="panel-dev-seraphina-chat" class="panel-content active">
            <h3>Code Examples</h3>
            <div class="code-tabs">
                <button class="code-tab active" data-lang="curl">cURL</button>
                <button class="code-tab" data-lang="python">Python</button>
                <button class="code-tab" data-lang="javascript">Node.js</button>
            </div>
            <div class="code-block" data-lang="curl">
                <pre><code class="language-bash">curl -X POST 'https://web-production-9a18.up.railway.app/api/developer/seraphina/chat' \
--header 'Authorization: Bearer YOUR_API_KEY' \
--header 'Content-Type: application/json' \
--data-raw '{
    "message": "Explain quantum computing in simple terms.",
    "history": [],
    "stream": false
}'</code></pre><button class="copy-btn">Copy</button>
            </div>
            <div class="code-block" data-lang="python" style="display:none;">
                 <pre><code class="language-python">import requests
import json

API_URL = "https://web-production-9a18.up.railway.app/api/developer/seraphina/chat"
API_KEY = "YOUR_API_KEY"

headers = {
    "Authorization": f"Bearer {API_KEY}",
    "Content-Type": "application/json"
}
payload = {
    "message": "Explain quantum computing in simple terms.",
    "stream": False
}

response = requests.post(API_URL, headers=headers, json=payload)
print(response.json())</code></pre><button class="copy-btn">Copy</button>
            </div>
             <div class="code-block" data-lang="javascript" style="display:none;">
                 <pre><code class="language-javascript">const API_URL = 'https://web-production-9a18.up.railway.app/api/developer/seraphina/chat';
const API_KEY = 'YOUR_API_KEY';

async function callSeraphina() {
  const response = await fetch(API_URL, {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      message: 'Explain quantum computing in simple terms.',
      stream: false
    })
  });
  const data = await response.json();
  console.log(data);
}

callSeraphina();</code></pre><button class="copy-btn">Copy</button>
            </div>

            <div class="try-it-out">
                <h4>Try it Live</h4>
                <form id="form-dev-seraphina-chat">
                    <div class="form-group">
                        <label for="seraphina-message">Message</label>
                        <textarea id="seraphina-message" name="message" rows="3">Explain quantum computing in simple terms.</textarea>
                    </div>
                    <div class="form-group">
                        <label for="seraphina-history">History (JSON Array)</label>
                        <textarea id="seraphina-history" name="history" rows="4">[]</textarea>
                    </div>
                    <button type="submit" class="execute-btn">Execute</button>
                </form>
                <div class="response-area" style="display:none;">
                    <h4>Response</h4>
                    <div class="response-status">
                        <span class="status-code"></span>
                        <span class="response-time"></span>
                    </div>
                    <div class="response-output">
                        <pre><code class="language-json"></code></pre>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bobby Chat Panel -->
        <div id="panel-dev-bobby-chat" class="panel-content">
             <h3>Code Examples</h3>
             <div class="code-tabs">
                <button class="code-tab active" data-lang="curl">cURL</button>
                <button class="code-tab" data-lang="python">Python</button>
                <button class="code-tab" data-lang="javascript">Node.js</button>
            </div>
            <div class="code-block" data-lang="curl">
                <pre><code class="language-bash">curl -X POST 'https://web-production-9a18.up.railway.app/api/developer/bobby/chat' \
--header 'Authorization: Bearer YOUR_API_KEY' \
--header 'Content-Type: application/json' \
--data-raw '{
    "prompt": "Write a short, gut-wrenching story about loss."
}'</code></pre><button class="copy-btn">Copy</button>
            </div>
            <!-- Python and JS examples would go here -->

            <div class="try-it-out">
                <h4>Try it Live</h4>
                <form id="form-dev-bobby-chat">
                    <div class="form-group">
                        <label for="bobby-prompt">Prompt</label>
                        <textarea id="bobby-prompt" name="prompt" rows="4">Write a python function that sorts a list of dictionaries by a specific key.</textarea>
                    </div>
                    <button type="submit" class="execute-btn">Execute</button>
                </form>
                <div class="response-area" style="display:none;">
                    <h4>Response</h4>
                    <div class="response-status">
                        <span class="status-code"></span>
                        <span class="response-time"></span>
                    </div>
                    <div class="response-output">
                        <pre><code class="language-json"></code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generate Image Panel -->
        <div id="panel-dev-generate-image" class="panel-content">
            <h3>Code Examples</h3>
            <!-- Code examples here -->
            <div class="try-it-out">
                <h4>Try it Live</h4>
                <form id="form-dev-generate-image">
                    <div class="form-group">
                        <label for="image-prompt">Prompt</label>
                        <textarea id="image-prompt" name="prompt" rows="4">A hyperrealistic portrait of a futuristic Nigerian queen, cybernetic enhancements glowing with purple light, afrofuturism.</textarea>
                    </div>
                    <div class="form-group">
                        <label for="image-model">Model (Thena only)</label>
                        <input id="image-model" name="model" value="photoreal">
                    </div>
                    <button type="submit" class="execute-btn">Execute</button>
                </form>
                <div class="response-area" style="display:none;">
                    <h4>Response</h4>
                    <div class="response-status">
                         <span class="status-code"></span>
                         <span class="response-time"></span>
                    </div>
                    <div class="response-output">
                        <p>Image will be rendered below on success.</p>
                        <img id="generated-image-output" src="" alt="Generated Image" style="max-width: 100%; border-radius: 6px; margin-top: 1rem; display: none;" />
                        <pre><code class="language-json"></code></pre>
                    </div>
                </div>
            </div>
        </div>

    </aside>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const BASE_URL = 'https://web-production-9a18.up.railway.app';
    const apiKeyInput = document.getElementById('api-key-input');
    
    // --- API Key Persistence ---
    apiKeyInput.value = localStorage.getItem('elvionApiKey') || '';
    apiKeyInput.addEventListener('input', () => {
        localStorage.setItem('elvionApiKey', apiKeyInput.value);
    });

    // --- Smooth Scrolling & Scrollspy ---
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('.doc-section');
    const interactivePanels = document.querySelectorAll('.panel-content');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const id = entry.target.getAttribute('id');
                
                // Update nav link
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === `#${id}`) {
                        link.classList.add('active');
                    }
                });

                // Update interactive panel
                interactivePanels.forEach(panel => {
                    panel.classList.remove('active');
                    if (panel.id === `panel-${id}`) {
                        panel.classList.add('active');
                    }
                });
            }
        });
    }, { rootMargin: "-50% 0px -50% 0px" });

    sections.forEach(section => observer.observe(section));

    // --- Code Snippet Logic (Tabs & Copying) ---
    document.querySelectorAll('.interactive-panel').forEach(panel => {
        const tabs = panel.querySelectorAll('.code-tab');
        const blocks = panel.querySelectorAll('.code-block');
        const copyBtns = panel.querySelectorAll('.copy-btn');

        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const lang = tab.dataset.lang;
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                blocks.forEach(b => {
                    b.style.display = b.dataset.lang === lang ? 'block' : 'none';
                });
            });
        });

        copyBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const code = btn.previousElementSibling.querySelector('code').innerText;
                navigator.clipboard.writeText(code).then(() => {
                    btn.textContent = 'Copied!';
                    setTimeout(() => { btn.textContent = 'Copy'; }, 2000);
                });
            });
        });
    });

    // --- "Try It Out" API Request Handler ---
    const handleApiRequest = async (form, endpoint) => {
        const responseArea = form.nextElementSibling;
        const responseOutput = responseArea.querySelector('.response-output pre code');
        const statusCodeEl = responseArea.querySelector('.status-code');
        const responseTimeEl = responseArea.querySelector('.response-time');
        const imageOutput = document.getElementById('generated-image-output');
        
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const apiKey = apiKeyInput.value;
            if (!apiKey) {
                alert('Please enter your API Key in the sidebar.');
                return;
            }

            const formData = new FormData(form);
            let body;
            try {
                // Attempt to parse fields that should be JSON
                body = Object.fromEntries(formData.entries());
                if (body.history) {
                    body.history = JSON.parse(body.history);
                }
            } catch (err) {
                alert('Invalid JSON in history field.');
                return;
            }

            const headers = {
                'Authorization': `Bearer ${apiKey}`,
                'Content-Type': 'application/json'
            };
            
            responseArea.style.display = 'block';
            responseOutput.textContent = 'Sending request...';
            if (imageOutput) imageOutput.style.display = 'none';
            
            const startTime = Date.now();
            try {
                const response = await fetch(`${BASE_URL}${endpoint}`, {
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify(body),
                });
                
                const endTime = Date.now();
                responseTimeEl.textContent = `${endTime - startTime} ms`;
                statusCodeEl.textContent = `Status: ${response.status}`;
                statusCodeEl.className = `status-code ${response.ok ? 'success' : 'error'}`;
                
                const responseData = await response.json();

                // Special handling for image generation
                if (endpoint === '/api/developer/generate-image' && response.ok) {
                    imageOutput.src = `data:image/png;base64,${responseData.image_b64}`;
                    imageOutput.style.display = 'block';
                }

                responseOutput.textContent = JSON.stringify(responseData, null, 2);
                hljs.highlightElement(responseOutput);

            } catch (error) {
                statusCodeEl.textContent = 'Status: Network Error';
                statusCodeEl.className = 'status-code error';
                responseOutput.textContent = error.toString();
            }
        });
    };
    
    handleApiRequest(document.getElementById('form-dev-seraphina-chat'), '/api/developer/seraphina/chat');
    handleApiRequest(document.getElementById('form-dev-bobby-chat'), '/api/developer/bobby/chat');
    handleApiRequest(document.getElementById('form-dev-generate-image'), '/api/developer/generate-image');
});
</script>

</body>
</html>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date()); 

  gtag('config', 'G-J1YTKP10ZX');
</script>
