<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Course Viewer | Elvion University</title>
  <meta name="description" content="Learn with interactive courses at Elvion University">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --dark-navy: #00001a;
      --black-bg: #000000;
      --cyan-glow: #00ffff;
      --light-blue-glow: #00aaff;
      --text-color: #e0e0e0;
      --heading-color: #ffffff;
      --gradient-start: #0a1128;
      --gradient-end: #121a30;
      --card-bg: rgba(18, 26, 48, 0.85);
      --border-glow: 0 0 10px var(--cyan-glow), 0 0 20px var(--light-blue-glow);
      --hover-glow: 0 0 15px var(--cyan-glow), 0 0 30px var(--light-blue-glow);
      --button-bg: linear-gradient(45deg, var(--cyan-glow), var(--light-blue-glow));
      --button-text-color: var(--black-bg);
      --star-color: rgba(255, 255, 255, 0.7);
      --sidebar-width: 300px;
      --success-color: #4ade80;
      --warning-color: #fbbf24;
      --error-color: #f87171;
      --primary-color: var(--cyan-glow);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--black-bg);
      color: var(--text-color);
      line-height: 1.7;
      overflow-x: hidden;
      position: relative;
      min-height: 100vh;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Orbitron', sans-serif;
      color: var(--heading-color);
      margin-top: 0;
    }

    /* Stars Animation */
    #stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .star {
      position: absolute;
      background-color: var(--star-color);
      border-radius: 50%;
      opacity: 0;
      animation: twinkle 4s infinite ease-in-out;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0; transform: scale(0.5); }
      50% { opacity: 1; transform: scale(1); }
    }

    /* Main Layout */
    .course-viewer-container {
      display: flex;
      min-height: 100vh;
      position: relative;
      z-index: 1;
    }

    /* Course Sidebar */
    .course-sidebar {
      width: var(--sidebar-width);
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(0, 255, 255, 0.2);
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .course-sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--cyan-glow);
      text-decoration: none;
      font-weight: 600;
      padding: 0.8rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      margin-bottom: 1rem;
    }

    .back-btn:hover {
      background: rgba(0, 255, 255, 0.1);
    }

    .course-info {
      text-align: center;
    }

    .course-icon-large {
      font-size: 3rem;
      color: var(--cyan-glow);
      text-shadow: var(--border-glow);
      margin-bottom: 1rem;
    }

    .course-title {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--heading-color);
    }

    .course-subtitle {
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 1rem;
    }

    .overall-progress {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .progress-label {
      font-size: 0.85rem;
      color: var(--text-color);
      margin-bottom: 0.5rem;
    }

    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--button-bg);
      border-radius: 10px;
      transition: width 0.8s ease;
      box-shadow: 0 0 10px var(--cyan-glow);
    }

    .progress-text {
      font-size: 0.85rem;
      color: var(--cyan-glow);
      font-weight: 600;
    }

    /* Lessons List */
    .lessons-list {
      padding: 1rem 0;
    }

    .lessons-header {
      padding: 0 1.5rem 1rem 1.5rem;
      font-size: 1.1rem;
      color: var(--heading-color);
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .lesson-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .lesson-item:hover {
      background: rgba(0, 255, 255, 0.05);
    }

    .lesson-item.active {
      background: rgba(0, 255, 255, 0.1);
      border-left-color: var(--cyan-glow);
    }

    .lesson-item.completed {
      opacity: 0.8;
    }

    .lesson-status {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      flex-shrink: 0;
    }

    .lesson-status.completed {
      background: var(--success-color);
      color: var(--black-bg);
    }

    .lesson-status.current {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .lesson-status.locked {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-color);
    }

    .lesson-details {
      flex: 1;
    }

    .lesson-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--heading-color);
      margin-bottom: 0.3rem;
    }

    .lesson-duration {
      font-size: 0.8rem;
      color: var(--text-color);
      opacity: 0.7;
    }

    /* Mobile Menu Toggle */
    .mobile-menu-toggle {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 101;
      background: var(--card-bg);
      border: 1px solid var(--cyan-glow);
      border-radius: 8px;
      padding: 0.5rem 0.8rem;
      color: var(--cyan-glow);
      cursor: pointer;
      box-shadow: var(--border-glow);
    }

    /* Content Area */
    .content-area {
      flex: 1;
      margin-left: var(--sidebar-width);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .content-header {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
      padding: 1.5rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .lesson-info h1 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .lesson-meta {
      display: flex;
      gap: 1.5rem;
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .lesson-meta span {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .content-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .action-btn {
      padding: 0.8rem 1.5rem;
      background: var(--button-bg);
      color: var(--button-text-color);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .action-btn:hover {
      box-shadow: var(--border-glow);
      transform: scale(1.05);
    }

    .action-btn.secondary {
      background: transparent;
      border: 2px solid var(--cyan-glow);
      color: var(--cyan-glow);
    }

    .action-btn.secondary:hover {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .action-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 2rem;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    }

    .content-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
      max-width: 900px; /* Fitting to page constraint */
      margin-left: auto;
      margin-right: auto;
    }

    .lesson-content {
      line-height: 1.8;
      font-size: 1.1rem;
    }

    .lesson-content h2 {
      color: var(--cyan-glow);
      margin: 2rem 0 1rem 0;
      font-size: 1.4rem;
    }

    .lesson-content h3 {
      color: var(--heading-color);
      margin: 1.5rem 0 0.8rem 0;
      font-size: 1.2rem;
    }

    .lesson-content p {
      margin-bottom: 1.2rem;
    }

    .lesson-content ul, .lesson-content ol {
      margin: 1rem 0 1rem 2rem;
    }

    .lesson-content li {
      margin-bottom: 0.5rem;
    }
    
    /* Code block styling for practical examples */
    .lesson-content code {
      background: rgba(0, 255, 255, 0.1);
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      color: var(--cyan-glow);
      font-family: 'Courier New', monospace;
    }

    .lesson-content pre {
      background: rgba(0, 0, 0, 0.5);
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid var(--cyan-glow);
      overflow-x: auto;
      margin: 1.5rem 0;
      box-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
      position: relative;
    }

    .lesson-content pre code {
      background: none;
      padding: 0;
      color: var(--text-color);
      display: block;
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* Interactive Code/Markdown Area Simulation */
    .interactive-code-area {
        background: #1e1e2d;
        border: 2px solid var(--primary-color);
        border-radius: 8px;
        padding: 1rem;
        margin: 1.5rem 0;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }
    .interactive-code-area textarea {
        width: 100%;
        min-height: 150px;
        background: transparent;
        color: var(--success-color);
        border: none;
        resize: vertical;
        padding: 0.5rem;
        font-family: 'Courier New', monospace;
        font-size: 1rem;
        outline: none;
    }
    .interactive-code-area .output {
        border-top: 1px dashed rgba(255, 255, 255, 0.2);
        padding-top: 0.5rem;
        color: var(--warning-color);
        font-size: 0.9rem;
        min-height: 30px;
        margin-top: 0.5rem;
    }
    .interactive-code-area .area-header {
        font-size: 0.8rem;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }


    /* Video Player Placeholder */
    .media-player {
      width: 100%;
      height: 400px;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 2rem;
      border: 1px solid rgba(0, 255, 255, 0.2);
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .media-placeholder {
      text-align: center;
      color: var(--text-color);
    }

    .media-placeholder i {
      font-size: 4rem;
      color: var(--cyan-glow);
      margin-bottom: 1rem;
      display: block;
    }

    /* Navigation Controls */
    .lesson-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2rem;
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(0, 255, 255, 0.1);
    }

    .nav-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .lesson-indicator {
      background: rgba(0, 255, 255, 0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .nav-buttons {
      display: flex;
      gap: 1rem;
    }

    /* Quiz/Assessment Styles */
    .quiz-container {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .quiz-question {
      font-size: 1.2rem;
      color: var(--heading-color);
      margin-bottom: 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
      padding-bottom: 1rem;
    }

    .quiz-options {
      display: grid;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .quiz-option {
      padding: 1rem 1.5rem;
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(0, 255, 255, 0.2);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease, transform 0.1s ease; /* Added transform for animation */
      color: var(--text-color);
      position: relative;
    }

    .quiz-option:hover {
      border-color: var(--cyan-glow);
      background: rgba(0, 255, 255, 0.05);
      transform: translateY(-2px); /* Slight hover animation */
    }

    .quiz-option.selected {
      border-color: var(--cyan-glow);
      background: rgba(0, 255, 255, 0.1);
      color: var(--cyan-glow);
    }
    
    /* Correct/Incorrect state styling with simple animation */
    .quiz-option.correct {
      border-color: var(--success-color) !important;
      background: rgba(74, 222, 128, 0.1) !important;
      color: var(--success-color) !important;
      animation: flash-correct 0.3s ease-in-out;
    }

    .quiz-option.incorrect {
      border-color: var(--error-color) !important;
      background: rgba(248, 113, 113, 0.1) !important;
      color: var(--error-color) !important;
      animation: shake 0.3s;
    }
    
    .quiz-option.correct::after {
      content: ' (Correct)';
      color: var(--success-color);
      font-weight: bold;
      margin-left: 10px;
    }
    .quiz-option.incorrect::after {
      content: ' (Incorrect)';
      color: var(--error-color);
      font-weight: bold;
      margin-left: 10px;
    }
    
    @keyframes flash-correct {
        0% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        20%, 60% { transform: translateX(-5px); }
        40%, 80% { transform: translateX(5px); }
    }


    .quiz-feedback {
      padding: 1rem;
      border-radius: 8px;
      margin-top: 1rem;
      display: none;
    }

    .quiz-feedback.correct {
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
      color: var(--success-color);
      display: block;
    }

    .quiz-feedback.incorrect {
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.3);
      color: var(--error-color);
      display: block;
    }
    
    /* Completion Modal Adjustments */
    .completion-modal .completion-icon {
        font-size: 4rem;
        color: var(--success-color);
        text-shadow: 0 0 10px var(--success-color);
        margin-bottom: 1rem;
        animation: pulse 1s infinite alternate;
    }
    
    .completion-modal .points-earned {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--cyan-glow);
        margin: 1.5rem 0;
        padding: 0.5rem 1rem;
        background: rgba(0, 255, 255, 0.1);
        border-radius: 8px;
        display: inline-block;
        border: 1px solid var(--cyan-glow);
    }
    
    @keyframes pulse {
        from { transform: scale(1); opacity: 0.8; }
        to { transform: scale(1.05); opacity: 1; }
    }


    /* Certificate Form & Final Page Styles */
    .final-page-content {
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }
    .certificate-form-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 3rem;
      box-shadow: var(--hover-glow);
      border: 1px solid var(--primary-color);
      text-align: left;
      margin-top: 2rem;
    }
    .certificate-form-card h2 {
      color: var(--success-color);
      text-shadow: 0 0 10px var(--success-color);
      margin-bottom: 1.5rem;
    }
    .certificate-form-card label {
      display: block;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-color);
    }
    .certificate-form-card input[type="text"],
    .certificate-form-card input[type="email"] {
      width: 100%;
      padding: 0.8rem;
      border: 2px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.3);
      color: var(--text-color);
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    .certificate-form-card input:focus {
      border-color: var(--cyan-glow);
      box-shadow: 0 0 5px var(--cyan-glow);
      outline: none;
    }
    .certificate-form-card .submit-btn {
      width: 100%;
      margin-top: 2rem;
    }

    /* Comment Section Styles */
    .comment-section {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 1.5rem;
        margin-top: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .comment-section textarea {
        width: 100%;
        min-height: 100px;
        padding: 1rem;
        border-radius: 8px;
        border: 2px solid rgba(0, 255, 255, 0.3);
        background: rgba(0, 0, 0, 0.5);
        color: var(--text-color);
        font-size: 1rem;
        resize: vertical;
        outline: none;
        transition: border-color 0.3s ease;
    }
    .comment-section textarea:focus {
        border-color: var(--cyan-glow);
        box-shadow: 0 0 5px var(--cyan-glow);
    }
    .comment-section .comment-btn {
        margin-top: 1rem;
        padding: 0.6rem 1.2rem;
        font-weight: 500;
        float: right;
    }

    /* Completion Modal */
    .completion-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .completion-content {
      background: var(--card-bg);
      padding: 3rem;
      border-radius: 15px;
      text-align: center;
      max-width: 500px;
      box-shadow: var(--hover-glow);
      border: 1px solid rgba(0, 255, 255, 0.3);
    }
    
    /* Loading State */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 50vh;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(0, 255, 255, 0.1);
      border-top-color: var(--cyan-glow);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      margin-top: 1rem;
      color: var(--text-color);
      font-size: 1.1rem;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .course-sidebar {
        transform: translateX(-100%);
      }

      .course-sidebar.active {
        transform: translateX(0);
      }

      .content-area {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .main-content {
        padding: 1rem;
        padding-top: 4rem;
      }

      .content-header {
        padding: 1rem;
        flex-direction: column;
        align-items: flex-start;
      }

      .content-actions {
        width: 100%;
        justify-content: stretch;
      }

      .action-btn {
        flex: 1;
        justify-content: center;
      }

      .lesson-navigation {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
      }

      .nav-buttons {
        width: 100%;
        justify-content: stretch;
      }

      .nav-buttons .action-btn {
        flex: 1;
      }
    }

    @media (max-width: 768px) {
      .media-player {
        height: 250px;
      }

      .content-card {
        padding: 1.5rem;
      }

      .completion-content {
        margin: 1rem;
        padding: 2rem;
      }

      .quiz-option {
        padding: 0.8rem 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="stars-container"></div>

  <button class="mobile-menu-toggle" id="mobileMenuToggle">
    <i class="fas fa-bars"></i>
  </button>

  <div class="course-viewer-container">
    <aside class="course-sidebar" id="courseSidebar">
      <div class="course-sidebar-header">
        <a href="studyingatelvion.html" class="back-btn">
          <i class="fas fa-arrow-left"></i>
          Back to Dashboard
        </a>
        
        <div class="course-info">
          <i id="courseIconLarge" class="course-icon-large"></i>
          <h2 id="courseTitle" class="course-title">Loading...</h2>
          <p id="courseSubtitle" class="course-subtitle">Please wait...</p>
          
          <div class="overall-progress">
            <div class="progress-label">Overall Progress</div>
            <div class="progress-bar-container">
              <div id="overallProgressBar" class="progress-bar-fill" style="width: 0%"></div>
            </div>
            <div class="progress-text"><span id="overallProgressText">0% Complete</span></div>
            <div class="progress-text" style="margin-top: 0.5rem;"><i class="fas fa-trophy"></i> Total Points: <span id="totalPointsEarnedSidebar">0</span></div>
          </div>
        </div>
      </div>

      <div class="lessons-list">
        <div class="lessons-header">Course Lessons</div>
        <div id="lessonsContainer">
          </div>
      </div>
    </aside>

    <main class="content-area">
      <div class="loading-container" id="loadingContainer">
        <div class="loading-spinner"></div>
        <p class="loading-text">Loading course content...</p>
      </div>

      <header class="content-header" id="contentHeader" style="display: none;">
        <div class="lesson-info">
          <h1 id="lessonTitle">Lesson Title</h1>
          <div class="lesson-meta">
            <span><i class="fas fa-clock"></i> <span id="lessonDuration">45 min</span></span>
            <span><i class="fas fa-book"></i> Lesson <span id="currentLessonNumber">1</span> of <span id="totalLessons">8</span></span>
            <span><i class="fas fa-star"></i> <span id="lessonPoints">10</span> Points</span>
          </div>
        </div>
        <div class="content-actions">
          <button id="markCompleteBtn" class="action-btn" style="display: none;">
            <i class="fas fa-check"></i>
            Mark Complete
          </button>
        </div>
      </header>

      <section class="main-content" id="mainContent" style="display: none;">
        
        <div id="finalCoursePage" style="display: none;" class="final-page-content">
            <h1 style="color: var(--success-color); text-shadow: var(--hover-glow);">Course Completed!</h1>
            <p class="lead" style="margin-bottom: 2rem;">
                Congratulations! You have completed all lessons and earned your GP! The final step is to request your certificate.
            </p>
            
            <div class="overall-progress" style="margin-bottom: 3rem; background: var(--black-bg); border: 2px solid var(--success-color);">
                <div class="progress-label" style="font-size: 1.1rem; color: var(--success-color);">Your Final Course Grade Point (GP)</div>
                <div class="progress-text" style="font-size: 2rem; color: var(--success-color); font-weight: 800;"><span id="finalTotalPoints">0</span> Points</div>
                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.8;">(Based on 10 points per successfully completed lesson quiz)</p>
            </div>

            <div class="certificate-form-card">
                <h2>Certificate & Project Submission</h2>
                <p style="margin-bottom: 1.5rem; color: var(--warning-color);">
                    To receive your certificate, please fill in your details below. For courses with a project (e.g., Computer Science, Software Engineering, Visual Arts), please **email your Final Project** (as outlined in the last lesson) to: <strong style="color: var(--cyan-glow);">elvionailabs@gmail.com</strong>.
                </p>
                <form id="certificateForm" action="https://formspree.io/f/mldrbpwo" method="post">
                    <input type="hidden" name="_subject" id="formSubject">
                    <input type="hidden" name="Course Completed" id="completedCourseName">
                    <input type="hidden" name="Total Points Earned" id="formTotalPoints">
                    
                    <label for="fullName">Full Name (for Certificate):</label>
                    <input type="text" id="fullName" name="Full Name" required>

                    <label for="email">Email Address (for delivery):</label>
                    <input type="email" id="email" name="Email" required>

                    <label for="studentId">Elvion Student ID (Optional):</label>
                    <input type="text" id="studentId" name="Student ID">

                    <button type="submit" class="action-btn submit-btn">
                        <i class="fas fa-certificate"></i> Request Certificate
                    </button>
                </form>

                <div class="comment-section">
                    <h4>Feedback & Questions</h4>
                    <form>
                        <textarea placeholder="Share your experience, ask a question, or send a thank you note to Elvion!"></textarea>
                        <button type="submit" class="action-btn comment-btn secondary" style="background: var(--dark-navy); color: var(--cyan-glow);">Submit Feedback</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="media-player" id="mediaPlayer">
          <div class="media-placeholder">
            <i class="fas fa-play-circle"></i>
            <p id="mediaPlaceholderText">Video/Media content coming soon</p>
            <p style="font-size: 0.9rem; opacity: 0.7;">For now, please read the lesson content below</p>
          </div>
        </div>

        <div class="content-card">
          <div id="lessonContent" class="lesson-content">
            </div>
        </div>

        <div id="quizContainer" class="quiz-container" style="display: none;">
          <h3 style="margin-bottom: 1.5rem; color: var(--warning-color);"><i class="fas fa-clipboard-check"></i> Mandatory Quiz: Pass to Proceed</h3>
          <p style="margin-bottom: 2rem; border-bottom: 1px solid rgba(0, 255, 255, 0.1); padding-bottom: 1rem;">
            You must correctly answer all questions below before the 'Next' lesson button is enabled.
          </p>
          <div id="quizQuestions">
            </div>
          <button id="submitQuizBtn" class="action-btn" style="width: 100%; margin-top: 2rem;">
            <i class="fas fa-paper-plane"></i> Submit Answers
          </button>
          <div id="quizResult" style="margin-top: 1rem;"></div>
        </div>
      </section>

      <nav class="lesson-navigation" id="lessonNavigation" style="display: none;">
        <div class="nav-info">
          <div class="lesson-indicator">
            Lesson <span id="navCurrentLesson">1</span> of <span id="navTotalLessons">8</span>
          </div>
          <span><i class="fas fa-trophy"></i> GP: <span id="totalPointsEarnedNav">0</span> Points</span>
        </div>
        <div class="nav-buttons">
          <button id="prevLessonBtn" class="action-btn secondary">
            <i class="fas fa-chevron-left"></i>
            Previous
          </button>
          <button id="nextLessonBtn" class="action-btn">
            Next
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </nav>
    </main>
  </div>

  <div id="completionModal" class="completion-modal">
    <div class="completion-content">
      <i class="fas fa-trophy completion-icon"></i>
      <h2 class="completion-title">Lesson Complete!</h2>
      <p class="completion-message">
        Congratulations! You've successfully completed the quiz and this lesson.
      </p>
      <div class="points-earned">
        <i class="fas fa-star"></i>
        You earned <span id="pointsEarned">10</span> points!
      </div>
      <div style="display: flex; gap: 1rem;">
        <button id="continueBtn" class="action-btn" style="flex: 1;">
          Continue Learning
        </button>
        <button id="backToDashboardBtn" class="action-btn secondary" style="flex: 1;">
          Back to Dashboard
        </button>
      </div>
    </div>
  </div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
        getAuth,
        onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import {
        getFirestore,
        doc,
        getDoc,
        updateDoc
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAyROm0aBGjry6NUfhNM3e0qwPcCDoIqSk",
        authDomain: "elvionai.firebaseapp.com",
        projectId: "elvionai",
        storageBucket: "elvionai.firebasestorage.app",
        messagingSenderId: "161078300830",
        appId: "1:161078300830:web:f460df8591704eb0e96b8f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // --- FALLBACK/DEFAULT LESSON & QUIZ FOR NEW COURSES ---
    const defaultLessonContent = `
        <h2>Welcome to Your Course!</h2>
        <p>This is the first lesson of your course. Here you will learn the foundational concepts.</p>
        <p>This course is designed to provide you with a comprehensive, pre-university foundation in your chosen field. Our learning methodology focuses on practical knowledge and critical thinking.</p>
        
        <h3>Elvion University Philosophy</h3>
        <p>Elvion University is dedicated to **providing free, quality pre-degree knowledge and certificates** to empower future students globally. Your commitment to completing this course is your most valuable credential.</p>
        
        <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-color: var(--warning-color);">
            <div class="area-header" style="color: var(--warning-color);"><span>Course Focus</span></div>
            <p>Please remember to focus on the core concepts of this subject. You will be tested on the content to ensure you grasp the fundamentals before moving to the next lesson.</p>
        </div>
    `;

    const defaultLesson = {
        id: 1,
        title: 'Course Introduction',
        duration: '40 min',
        content: defaultLessonContent,
        quiz: [
            { type: 'mcq', question: 'What is the main purpose of Elvion University?', options: ['Awarding accredited degrees', 'Providing free pre-degree knowledge and certificates', 'Replacing traditional universities', 'Offering high-cost private education'], answer: 'Providing free pre-degree knowledge and certificates' },
            { type: 'mcq', question: 'How is student progress measured in this course viewer?', options: ['Monthly Exams', 'Lesson by lesson mandatory quizzes', 'Instructor approval only', 'Number of videos watched'], answer: 'Lesson by lesson mandatory quizzes' },
        ]
    };

    // Helper to generate default lessons for other courses
    const generateDefaultLessons = (count, coursePrefix, isProject) => {
        return Array(count).fill(0).map((_, i) => {
            let lessonTitle = `Lesson ${i + 1}: Introduction to ${coursePrefix} Concepts`;
            let content = defaultLessonContent.replace(/Welcome!|This is the first lesson/g, `Welcome to ${coursePrefix}!`).replace(/Introduction/g, lessonTitle);

            if (i === 0) {
                // Keep the original quiz for the first lesson of a new course
                return {
                    ...defaultLesson,
                    id: i + 1,
                    title: `${coursePrefix} ${lessonTitle}`,
                    content: content,
                };
            }

            if (i === count - 1) {
                lessonTitle = isProject ? `Lesson ${i + 1}: Final Project / Capstone` : `Lesson ${i + 1}: Conclusion & Next Steps`;
                content = `<h2>${lessonTitle}</h2>
                    <p>Congratulations on reaching the final lesson of the ${coursePrefix} course!</p>
                    <p>This course's final requirement is a **Project Submission** (if \`isProject\` is true) or a final reflection. Follow the certificate steps on the next page.</p>
                    ${isProject ? `<p style="color: var(--cyan-glow);">**Project Submission Required:** Please check the last lesson for specific instructions and remember to **email your project to elvionailabs@gmail.com**.</p>` : ''}
                `;

                // Final lesson quiz should be specific if it's a project
                const finalQuiz = isProject ? [
                    { type: 'mcq', question: `For the ${coursePrefix} course, what is the final deliverable requirement?`, options: ['A final written exam', 'A Project/Capstone Submission', 'A face-to-face interview', 'A group presentation'], answer: 'A Project/Capstone Submission' },
                    { type: 'text', question: 'What is the email address to which you must submit your project for certificate review? (Enter exactly)', answer: 'elvionailabs@gmail.com' },
                ] : [
                    { type: 'mcq', question: `How many lessons did you complete in the ${coursePrefix} course?`, options: ['1', '5', '8', count.toString()], answer: count.toString() },
                    { type: 'mcq', question: 'What is the next suggested step after completing this course?', options: ['Retake the first lesson', 'Explore another Elvion course or request your certificate', 'Close the browser', 'Nothing'], answer: 'Explore another Elvion course or request your certificate' },
                ];

                return {
                    id: i + 1,
                    title: `${coursePrefix} ${lessonTitle}`,
                    duration: `${40 + Math.floor(Math.random() * 20)} min`, // Varied duration
                    content: content,
                    quiz: finalQuiz,
                };
            }

            // Simplified, universal quiz for placeholder lessons after the first one
            const simpleQuiz = [
                { type: 'mcq', question: `How many lessons are in the ${coursePrefix} course? (Hint: The answer is in the course metadata)`, options: ['1', '5', '8', count.toString()], answer: count.toString() },
                { type: 'mcq', question: `What is the most important skill for a ${coursePrefix} professional?`, options: ['Memorization', 'Critical Thinking & Problem Solving', 'Speed Reading', 'Ignoring details'], answer: 'Critical Thinking & Problem Solving' },
            ];

            return {
                id: i + 1,
                title: `${coursePrefix} ${lessonTitle}`,
                duration: `${40 + Math.floor(Math.random() * 20)} min`, // Varied duration
                content: content,
                quiz: simpleQuiz,
            };
        });
    };

    // --- UPDATED AND EXPANDED COURSE DATABASE (Incorporating all your courses) ---
    const cs101Lessons = [
    {
        id: 1,
        title: 'L1: Foundations of Programming & Your First Task',
        duration: '60 min',
        content: `
            <h2>Welcome to Programming!</h2>
            <p>Programming is the art and science of giving instructions to a computer to perform a specific task. At its core, it's about problem-solving. Before we write code, we must think like an engineer, breaking down a large problem into small, manageable steps. This step-by-step plan is called an <strong>algorithm</strong>.</p>
            
            <h3>The Concept of Algorithms</h3>
            <p>Think of an algorithm as a recipe. A recipe to bake a cake has a finite number of clear, sequential steps. If you follow them precisely, you get a cake. A good algorithm is clear, effective, and guaranteed to end.</p>
            <p><strong>Example: Algorithm to greet a user:</strong></p>
            <ol>
                <li>Ask the user for their name.</li>
                <li>Store the user's name in memory.</li>
                <li>Combine the greeting "Hello, " with the stored name.</li>
                <li>Display the full greeting on the screen.</li>
            </ol>

            <h3>Variables and Data Types: The Building Blocks</h3>
            <p>To execute our algorithm, we need to store information. We do this using <strong>variables</strong>â€”containers for data. Every variable has a <strong>data type</strong> that tells the computer what kind of information it holds.</p>
            <ul>
                <li><strong>String:</strong> For text. e.g., <code>"Elvion"</code> or <code>"What is your name?"</code></li>
                <li><strong>Integer:</strong> For whole numbers. e.g., <code>25</code> or <code>-100</code></li>
                <li><strong>Float:</strong> For decimal numbers. e.g., <code>3.14159</code></li>
                <li><strong>Boolean:</strong> For true or false states. e.g., <code>True</code> or <code>False</code></li>
            </ul>
            <p>Let's see this in action with a simple Python program that implements our greeting algorithm:</p>
            <pre><code># Python Example
# 1. Ask the user and 2. Store the name in a variable
user_name = input("Enter your name: ")

# 3. & 4. Combine the string and display the greeting
print("Hello, " + user_name + "! Welcome to our project.")</code></pre>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L1 Task: Setting Up Your Project </span></div>
                <p>For this course, we will build a <strong>Simple Messenger</strong> application step-by-step. Your first task is to set up the project file.</p>
                <ol>
                    <li>Create a new folder on your computer named <code>ElvionMessenger</code>.</li>
                    <li>Inside this folder, create a new file named <code>main.py</code>.</li>
                    <li>In <code>main.py</code>, write your very first function. A <strong>function</strong> is a reusable block of code. Type the following exactly:</li>
                </ol>
                <pre><code>def greet_user(name):
    print(f"Welcome to the Elvion Messenger, {name}!")

# This line calls the function to test it
greet_user("Alex")</code></pre>
                <p>Save the file. You have just created the first functional piece of our application!</p>
            </div>
            
            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Book:</strong> Automate the Boring Stuff with Python by Al Sweigart. (An excellent, free-to-read online book for beginners that focuses on practical programming).</li>
                <li><strong>Official Documentation:</strong> <a href="https://docs.python.org/3/tutorial/index.html" target="_blank">The Official Python Tutorial</a> (The definitive source for learning Python syntax and features).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'In programming, what is a step-by-step procedure for solving a problem called?', options: ['A Variable', 'A Syntax', 'An Algorithm', 'A Function'], answer: 'An Algorithm' },
            { type: 'mcq', question: 'Which data type is most appropriate for storing the price of an item, like $9.99?', options: ['Integer', 'String', 'Boolean', 'Float'], answer: 'Float' },
            { type: 'mcq', question: 'What is the primary purpose of a function in programming?', options: ['To store a single piece of data', 'To create a reusable block of code that performs a specific action', 'To stop the program from running', 'To comment and explain the code'], answer: 'To create a reusable block of code that performs a specific action' },
            { type: 'text', question: 'In our L1 Task, what is the name of the function we created?', answer: 'greet_user' },
        ]
    },
    {
        id: 2,
        title: 'L2: Organizing Data with Data Structures',
        duration: '75 min',
        content: `
            <h2>What are Data Structures?</h2>
            <p>As programs become more complex, we need efficient ways to organize and store data. A <strong>data structure</strong> is a specialized format for organizing, processing, retrieving, and storing data. Choosing the right data structure is critical for writing efficient and scalable code.</p>

            <h3>The List: An Ordered Collection</h3>
            <p>A <strong>List</strong> (or an Array in other languages) is an ordered collection of items. You can access any item by its position, called an <strong>index</strong>, which starts at 0.</p>
            <pre><code># A Python List of strings
fruits = ["apple", "banana", "cherry"]

# Accessing the first item (index 0)
first_fruit = fruits[0]  # This is "apple"

# Adding an item to the end of the list
fruits.append("orange")
print(fruits)  # Output: ['apple', 'banana', 'cherry', 'orange']</code></pre>

            <h3>The Dictionary: Key-Value Pairs</h3>
            <p>A <strong>Dictionary</strong> is an unordered collection of data stored as <strong>key-value pairs</strong>. Instead of using a numeric index, you use a unique key (which is a string) to access its corresponding value. This is extremely fast and efficient for lookups.</p>
            <pre><code># A Python Dictionary
student = {
    "name": "John Doe",
    "age": 21,
    "is_enrolled": True
}

# Accessing the value associated with the "name" key
student_name = student["name"] # This is "John Doe"

# Adding a new key-value pair
student["grade"] = "A"
print(student) # Output will include the new grade</code></pre>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L2 Task: Storing User Data </span></div>
                <p>Our messenger app needs to handle multiple users. A list of dictionaries is a perfect way to store this data for now.</p>
                <p>In your <code>main.py</code> file, below your <code>greet_user</code> function, add the following code to create our initial user database:</p>
                <pre><code># This is a list that will hold all our user data
users_db = [
    {
        "username": "alex_wonder",
        "status": "Online",
        "last_seen": "2:30 PM"
    },
    {
        "username": "ben_coder",
        "status": "Offline",
        "last_seen": "11:15 AM"
    },
    {
        "username": "chloe_designer",
        "status": "Online",
        "last_seen": "2:45 PM"
    }
]

# Add a line to print the username of the second user in the list
print(users_db[1]["username"]) # This should print "ben_coder"</code></pre>
                <p>You have now structured the data for our application's users. This is a fundamental step in building any software that manages information.</p>
            </div>

            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Official Documentation:</strong> <a href="https://docs.python.org/3/tutorial/datastructures.html" target="_blank">More on Python Data Structures</a> (The official guide on lists, dictionaries, tuples, and sets).</li>
                <li><strong>Article:</strong> <a href="https://realpython.com/python-dicts/" target="_blank">Python Dictionaries (Real Python)</a> (A comprehensive, practical guide to using dictionaries effectively).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'Which data structure stores data in key-value pairs?', options: ['List', 'Integer', 'Dictionary', 'String'], answer: 'Dictionary' },
            { type: 'mcq', question: 'In a list of 5 items, what is the index of the very last item?', options: ['5', '4', '0', '1'], answer: '4' },
            { type: 'mcq', question: 'In our L2 Task, what type of data structure is `users_db` itself?', options: ['Dictionary', 'String', 'List', 'Integer'], answer: 'List' },
            { type: 'text', question: 'What is the Python method to add a new item to the end of a list?', answer: 'append' },
            { type: 'mcq', question: 'What will `users_db[0]["status"]` return based on the code from our L2 Task?', options: ['Offline', 'Online', '2:30 PM', 'alex_wonder'], answer: 'Online' },
        ]
    },
    {
        id: 3,
        title: 'L3: Object-Oriented Programming (OOP)',
        duration: '70 min',
        content: `
            <h2>A Smarter Way to Code: OOP</h2>
            <p>While dictionaries are useful, they can become disorganized as our program grows. <strong>Object-Oriented Programming (OOP)</strong> is a powerful paradigm that organizes code around <strong>objects</strong>, which bundle together data (attributes) and the functions that operate on that data (methods). Think of it as creating custom, intelligent data structures.</p>

            <h3>Classes and Objects: The Blueprint and the Product</h3>
            <p>A <strong>Class</strong> is a blueprint for creating objects. It defines the attributes and methods that all objects of that class will have. An <strong>Object</strong> is a specific instance created from that class.</p>
            <p><strong>Analogy:</strong> A `Car` class is the blueprint. It defines that all cars will have a `color` and a `max_speed` (attributes), and the ability to `start_engine()` (a method). Your specific red Ferrari is an object (an instance) of the `Car` class.</p>
            <pre><code># This is the blueprint for a Dog
class Dog:
    # The __init__ method is the constructor, run when a new object is created
    def __init__(self, name, age):
        self.name = name  # This is an attribute
        self.age = age    # This is an attribute

    # This is a method (a function that belongs to the class)
    def bark(self):
        return f"{self.name} says Woof!"

# Create two Dog objects (instances of the Dog class)
my_dog = Dog("Buddy", 5)
your_dog = Dog("Lucy", 3)

# Call the bark method on one of the objects
print(my_dog.bark())  # Output: Buddy says Woof!
print(your_dog.name)  # Output: Lucy</code></pre>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L3 Task: Creating a User Class </span></div>
                <p>Let's upgrade our messenger's architecture. Instead of using a dictionary for each user, we will create a `User` class. This makes our code cleaner, more organized, and easier to maintain.</p>
                <p>In <code>main.py</code>, you can now remove the old `users_db` list. Replace it with this new `User` class definition:</p>
                <pre><code>class User:
    def __init__(self, username, status="Online"):
        self.username = username
        self.status = status

    def get_profile_info(self):
        return f"User: {self.username}, Status: {self.status}"

# Now, instead of a list of dictionaries, we create a list of User objects
users_list = [
    User("alex_wonder"),
    User("ben_coder", "Offline"),
    User("chloe_designer")
]

# Let's test it by getting the profile of the first user
print(users_list[0].get_profile_info())
# Expected Output: User: alex_wonder, Status: Online</code></pre>
                <p>Congratulations! You've just implemented a more professional and scalable way to manage data in our application using OOP principles.</p>
            </div>

            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Article:</strong> <a href="https://realpython.com/python3-object-oriented-programming/" target="_blank">Object-Oriented Programming (OOP) in Python 3</a> (A very detailed and beginner-friendly guide on Real Python).</li>
                <li><strong>Book:</strong> Head First Design Patterns by Eric Freeman & Elisabeth Robson. (A classic book that makes learning OOP concepts and patterns fun and intuitive).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'In OOP, what is the "blueprint" for creating objects called?', options: ['An Object', 'A Method', 'A Class', 'An Attribute'], answer: 'A Class' },
            { type: 'mcq', question: 'What is a function that belongs to a class called?', options: ['A Variable', 'A Method', 'A Parameter', 'A Loop'], answer: 'A Method' },
            { type: 'mcq', question: 'In our `User` class, `username` and `status` are examples of what?', options: ['Methods', 'Classes', 'Constructors', 'Attributes'], answer: 'Attributes' },
            { type: 'text', question: 'In a Python class, what is the special name of the constructor method?', answer: '__init__' },
        ]
    },
    {
        id: 4,
        title: 'L4: Introduction to Database Systems',
        duration: '65 min',
        content: `
            <h2>Why We Need Databases</h2>
            <p>Our current list of users is stored in memory, which means if we restart our program, all the data is lost. To store data <strong>persistently</strong>, we need a <strong>database</strong>. A database is an organized collection of structured information, or data, typically stored electronically in a computer system.</p>

            <h3>Relational Databases and SQL</h3>
            <p>The most common type of database is a <strong>Relational Database</strong>, which organizes data into tables. Think of a table like a spreadsheet with rows and columns. To communicate with these databases, we use a special language called <strong>SQL (Structured Query Language)</strong>.</p>
            <p>The four main operations in SQL are known as <strong>CRUD</strong>:</p>
            <ul>
                <li><strong>C</strong>reate: Add new data. (<code>INSERT</code>)</li>
                <li><strong>R</strong>ead: Retrieve data. (<code>SELECT</code>)</li>
                <li><strong>U</strong>pdate: Modify existing data. (<code>UPDATE</code>)</li>
                <li><strong>D</strong>elete: Remove data. (<code>DELETE</code>)</li>
            </ul>

            <h3>Designing a Table</h3>
            <p>Before we can store data, we must define the structure of our table using the <code>CREATE TABLE</code> command. Each column has a name and a data type (like <code>INT</code> for integer or <code>VARCHAR(255)</code> for a string with a max length).</p>
            <pre><code>-- This is an SQL command, not Python
CREATE TABLE Users (
    UserID INT PRIMARY KEY, -- A unique ID for each user
    UserName VARCHAR(50) NOT NULL, -- The user's name, which cannot be empty
    Email VARCHAR(100) UNIQUE -- The user's email, which must be unique
);

-- This command retrieves the names and emails of all users from the Users table
SELECT UserName, Email FROM Users;</code></pre>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L4 Task: Designing Our Messages Table </span></div>
                <p>We need a way to store the messages sent between users. Your task is to design the SQL table for this. You don't need to write Python code for this lesson.</p>
                <ol>
                    <li>Go to an online SQL playground like <a href="https://www.db-fiddle.com/" target="_blank">DB Fiddle</a> or <a href="https://sqliteonline.com/" target="_blank">SQLite Online</a>.</li>
                    <li>In the SQL editor, write a <code>CREATE TABLE</code> command for a table named <code>Messages</code>.</li>
                    <li>The table must have the following columns:
                        <ul>
                            <li><code>MessageID</code> (an integer that is the primary key)</li>
                            <li><code>SenderID</code> (an integer)</li>
                            <li><code>ReceiverID</code> (an integer)</li>
                            <li><code>MessageText</code> (a string that can hold up to 500 characters)</li>
                            <li><code>Timestamp</code> (a datetime value)</li>
                        </ul>
                    </li>
                </ol>
                <p>This design is the blueprint for how our messenger will store every message sent, forming the core of the application's data layer.</p>
            </div>

            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Website:</strong> <a href="https://www.w3schools.com/sql/" target="_blank">W3Schools SQL Tutorial</a> (A great interactive tutorial for learning the basics of SQL).</li>
                <li><strong>Video:</strong> <a href="https://www.youtube.com/watch?v=HXV3zeQKqGY" target="_blank">SQL for Beginners by freeCodeCamp</a> (A comprehensive 4-hour video course on YouTube).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'What does SQL stand for?', options: ['Structured Query Logic', 'Simple Question Language', 'Structured Query Language', 'Standard Query Lingo'], answer: 'Structured Query Language' },
            { type: 'mcq', question: 'Which SQL command is used to retrieve data from a database?', options: ['GET', 'READ', 'FETCH', 'SELECT'], answer: 'SELECT' },
            { type: 'mcq', question: 'In a relational database, data is organized into what?', options: ['Objects', 'Documents', 'Tables', 'Files'], answer: 'Tables' },
            { type: 'text', question: 'What does the "C" in the acronym CRUD stand for?', answer: 'Create' },
        ]
    },
    {
        id: 5,
        title: 'L5: Software Engineering Principles',
        duration: '60 min',
        content: `
            <h2>From Code to System: The Engineering Mindset</h2>
            <p>Writing code is just one part of building software. <strong>Software Engineering</strong> is the disciplined, systematic approach to designing, developing, testing, and maintaining large-scale software systems. It's about ensuring our software is reliable, efficient, and maintainable.</p>

            <h3>The Software Development Life Cycle (SDLC)</h3>
            <p>The SDLC outlines the stages of software creation. A popular modern methodology is <strong>Agile</strong>, which focuses on iterative development. Instead of building the entire application at once, an Agile team builds and releases small, functional pieces in cycles called <strong>sprints</strong>.</p>
            
            <h3>Writing Requirements with User Stories</h3>
            <p>Before we write code, we must understand what to build. A <strong>User Story</strong> is a simple, informal description of a feature from the perspective of the end-user. It follows a simple template:</p>
            <p><strong>As a [type of user], I want to [perform some action] so that I can [achieve some goal].</strong></p>
            <p>For example: "As a messenger user, I want to see a list of my contacts so that I can select someone to message."</p>

            <h3>Version Control with Git</h3>
            <p>When working on a project, especially in a team, we need a way to track changes. <strong>Git</strong> is a version control system that acts like a "save" button for your entire project. You save snapshots of your code, called <strong>commits</strong>, which allows you to review history and collaborate effectively. <strong>GitHub</strong> is a website that hosts Git repositories, enabling cloud storage and collaboration for your projects.</p>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L5 Task: Defining Our Messenger's Features </span></div>
                <p>Let's apply an engineering mindset to plan our Simple Messenger. Your task is to think like a user and write the core User Stories. This is a critical planning step that happens before any more code is written.</p>
                <p>Create a new text file on your computer named <code>features.txt</code>. In this file, write at least three User Stories for our app, following the template. Here is one to get you started:</p>
                <pre><code>// User Story 1:
As a user, I want to see the online status of other users so that I know who is available to chat.

// User Story 2:
...

// User Story 3:
...</code></pre>
                <p>Think about essential features: sending a message, seeing your message history, etc. This document becomes the high-level requirement list for our application.</p>
            </div>

            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Website:</strong> <a href="https://www.atlassian.com/agile/project-management/user-stories" target="_blank">Atlassian's Guide to User Stories</a> (An excellent industry guide on how to write effective user stories).</li>
                <li><strong>Tool:</strong> <a href="https://github.com/" target="_blank">GitHub</a> (The most popular platform for hosting code. It is essential for every software developer to have an account).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'Which development methodology focuses on building software in short, iterative cycles?', options: ['Waterfall', 'Agile', 'Spiral', 'V-Model'], answer: 'Agile' },
            { type: 'mcq', question: 'What is the primary purpose of Git?', options: ['To write code', 'To test software', 'To track changes in source code (version control)', 'To deploy applications'], answer: 'To track changes in source code (version control)' },
            { type: 'mcq', question: 'What is the first part of a standard User Story template?', options: ['"I want to..."', '"As a..."', '"So that..."', '"The feature is..."'], answer: '"As a..."' },
            { type: 'text', question: 'A snapshot of your code saved in Git is called a what?', answer: 'commit' },
        ]
    },
    {
        id: 6,
        title: 'L6: Understanding Computer Networks',
        duration: '55 min',
        content: `
            <h2>How Computers Talk: An Introduction to Networks</h2>
            <p>Our messenger application won't just run on one computer; users need to communicate across the internet. <strong>Computer Networking</strong> is the practice of connecting computers together to share data and resources. The internet itself is the largest computer network in the world.</p>

            <h3>The Client-Server Model</h3>
            <p>Most internet applications, including our messenger, use the <strong>Client-Server Model</strong>.
            <ul>
                <li>The <strong>Client</strong> is the user's device (e.g., your web browser or a mobile app). It requests information or sends data.</li>
                <li>The <strong>Server</strong> is a powerful computer that is always on, listening for requests. It processes the request, interacts with the database, and sends a response back to the client.</li>
            </ul>
            In our app, when you send a message, your client sends the message to the server. The server saves it to the database and then pushes it to the recipient's client.</p>

            <h3>IP Addresses and Protocols</h3>
            <p>Every device on the internet has a unique address called an <strong>IP Address</strong> (e.g., `192.168.1.1`). But to ensure communication is orderly, devices follow a set of rules called <strong>protocols</strong>.</p>
            <ul>
                <li><strong>TCP (Transmission Control Protocol):</strong> Ensures reliable, ordered delivery of data. It's like sending a tracked package; you get confirmation it arrived correctly. This is crucial for chat messages.</li>
                <li><strong>HTTP (Hypertext Transfer Protocol):</strong> The protocol used for loading websites. It's a request-response protocol built on top of TCP.</li>
            </ul>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L6 Task: Diagramming the Architecture </span></div>
                <p>This is a conceptual task. Your goal is to visualize how our Simple Messenger works. You can use a simple drawing tool (like MS Paint, or an online tool like <a href="https://app.diagrams.net/" target="_blank">draw.io</a>) or even just a pen and paper.</p>
                <p>Create a simple diagram that includes three boxes:</p>
                <ol>
                    <li><strong>Your Client (User A)</strong></li>
                    <li><strong>The Messenger Server</strong></li>
                    <li><strong>The Database</strong></li>
                </ol>
                <p>Draw arrows to show the flow of a message:
                    <br>1. From User A's Client to the Server (The "send" request).
                    <br>2. From the Server to the Database (To "store" the message).
                    <br>3. From the Server to another client (User B) to "deliver" the message.
                </p>
                <p>This high-level diagram represents the basic architecture of almost every modern messaging application.</p>
            </div>

            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Video:</strong> <a href="https://www.youtube.com/watch?v=IPvYjXCsTg8" target="_blank">How the Internet Works in 5 Minutes</a> (A classic, easy-to-understand explanation of the basics).</li>
                <li><strong>Article:</strong> <a href="https://developer.mozilla.org/en-US/docs/Learn/Common_questions/What_is_a_web_server" target="_blank">What is a web server? (MDN)</a> (A great explanation of the server's role from the Mozilla Developer Network).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'In the Client-Server model, which component is responsible for storing persistent data?', options: ['The Client', 'The Network', 'The Server (by communicating with a database)', 'The Protocol'], answer: 'The Server (by communicating with a database)' },
            { type: 'mcq', question: 'What is the unique address of a device on the internet called?', options: ['A MAC Address', 'An IP Address', 'A Protocol Address', 'A Server Address'], answer: 'An IP Address' },
            { type: 'mcq', question: 'Which protocol is responsible for ensuring the reliable and ordered delivery of data?', options: ['HTTP', 'IP', 'HTML', 'TCP'], answer: 'TCP' },
            { type: 'text', question: 'What is the name of the architectural model that divides tasks between a requester and a provider of a resource?', answer: 'Client-Server Model' },
        ]
    },
    {
        id: 7,
        title: 'L7: Introduction to Artificial Intelligence',
        duration: '65 min',
        content: `
            <h2>What is Artificial Intelligence (AI)?</h2>
            <p><strong>Artificial Intelligence (AI)</strong> is a broad field of computer science dedicated to creating systems that can perform tasks that typically require human intelligence. This includes learning, reasoning, problem-solving, perception, and language understanding.</p>

            <h3>Machine Learning: Learning from Data</h3>
            <p><strong>Machine Learning (ML)</strong> is a subset of AI where systems are not explicitly programmed with rules, but instead, they <strong>learn</strong> patterns from large amounts of data. The three main types are:</p>
            <ul>
                <li><strong>Supervised Learning:</strong> The system learns from labeled data. You show it thousands of pictures labeled "cat" and "not a cat," and it learns to identify new cats. This is used for spam detection, image recognition, and prediction.</li>
                <li><strong>Unsupervised Learning:</strong> The system finds hidden patterns in unlabeled data. For example, grouping customers into different segments based on their purchasing behavior.</li>
                <li><strong>Reinforcement Learning:</strong> The system learns by trial and error, receiving rewards for good actions and penalties for bad ones. This is how AI learns to play games like Chess or Go.</li>
            </ul>

            <h3>AI in the Real World</h3>
            <p>AI is already a part of your daily life, from the recommendation algorithms on Netflix and Spotify to the navigation advice from Google Maps and the spam filter in your email inbox.</p>

            <div class="interactive-code-area" style="border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span> L7 Task: Adding "Intelligence" to Our Messenger </span></div>
                <p>Let's add a very simple "intelligent" feature to our messenger: a basic profanity filter. This is a classic example of a text classification task, which is a form of Supervised Learning.</p>
                <p>In your <code>main.py</code> file, add a new function that checks if a message contains a "banned" word. This simulates how a real content moderation AI might work.</p>
                <pre><code># A simple list of "banned" words for our simulation
banned_words = ["danger", "attack", "malicious"]

def moderate_message(message):
    # Convert the message to lowercase to make the check case-insensitive
    message_lower = message.lower()
    
    for word in banned_words:
        if word in message_lower:
            return "Message Rejected: Contains inappropriate content."
            
    return "Message Approved."

# Let's test our new function
test_message1 = "This is a dangerous message."
test_message2 = "This is a perfectly fine message."

print(f"'{test_message1}': {moderate_message(test_message1)}")
print(f"'{test_message2}': {moderate_message(test_message2)}")
# Expected Output: Rejected for the first, Approved for the second.</code></pre>
                <p>While simple, this function demonstrates the core logic of an automated moderation systemâ€”a common and practical application of AI.</p>
            </div>

            <h3>Further Reading & Resources</h3>
            <ul>
                <li><strong>Book:</strong> AI Superpowers by Kai-Fu Lee. (An accessible book about the state of AI and its global impact).</li>
                <li><strong>Video Course:</strong> <a href="https://www.youtube.com/watch?v=i_LwzRVP7bg" target="_blank">Machine Learning for Everybody</a> (A fun and easy-to-understand video series that explains the core concepts of ML).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'Which subset of AI involves systems learning from data without being explicitly programmed?', options: ['Data Science', 'Cybernetics', 'Machine Learning', 'Robotics'], answer: 'Machine Learning' },
            { type: 'mcq', question: 'Training an email spam filter with thousands of emails labeled as "spam" or "not spam" is an example of what?', options: ['Supervised Learning', 'Unsupervised Learning', 'Reinforcement Learning', 'Deep Learning'], answer: 'Supervised Learning' },
            { type: 'mcq', question: 'What is the goal of Reinforcement Learning?', options: ['To find hidden patterns in unlabeled data', 'To learn from labeled examples', 'To learn through trial and error using rewards and penalties', 'To perfectly mimic human conversation'], answer: 'To learn through trial and error using rewards and penalties' },
            { type: 'text', question: 'In our L7 Task, if a message is "This is a Malicious attack", what will our function return?', answer: 'Message Rejected: Contains inappropriate content.' },
        ]
    },
    {
        id: 8,
        title: 'Final Project: Building the Simple Messenger',
        duration: '180 min',
        content: `
            <h2>Final Project: Assembling the Pieces</h2>
            <p class="lead" style="color: var(--warning-color);">Congratulations on reaching the final lesson! You have learned about programming, data structures, OOP, databases, engineering principles, networking, and AI. Now it's time to put it all together.</p>
            
            <h3>Your Project Goal</h3>
            <p>Your goal is to build a functional, command-line version of the <strong>Elvion Simple Messenger</strong> application using Python. This project will demonstrate the concepts you learned in lessons 1-7.</p>
            
            <h4>Minimum Viable Product (MVP) Requirements:</h4>
            <p>Your final <code>main.py</code> script should be a runnable program that achieves the following, using the code you've already written as a starting point:</p>
            <ol>
                <li><strong>Use the <code>User</code> Class (Lesson 3):</strong> The program should start by creating a few instances of your <code>User</code> class.</li>
                <li><strong>Simulate a User Login:</strong> Ask the user to enter a username. Check if that username exists in your list of <code>User</code> objects.</li>
                <li><strong>Display a Menu:</strong> After "login," show the user a simple menu of options, such as:
                    <ul>
                        <li>1. Send a new message</li>
                        <li>2. View my messages</li>
                        <li>3. View all users</li>
                        <li>4. Exit</li>
                    </ul>
                </li>
                <li><strong>Implement "Send Message":</strong> This function should ask for a recipient's username and the message text. It should use your <code>moderate_message</code> function (Lesson 7) before "sending."</li>
                <li><strong>Simulate the Database:</strong> You don't need a real database yet. You can store messages in a simple List in your program, where each message is a Dictionary (e.g., <code>{"sender": "alex", "recipient": "ben", "text": "Hello!"}</code>).</li>
            </ol>

            <h3>Submission Guidelines (Crucial)</h3>
            <p>This project is about applying what you've learned and demonstrating your ability to integrate different concepts into a single, working program.</p>
            <ol>
                <li><strong>The Code:</strong> Your final project should consist of your <code>main.py</code> file and your <code>features.txt</code> file. The best practice is to upload your project folder to <strong>GitHub</strong> and submit the link to your repository.</li>
                <li><strong>The Documentation:</strong> In your GitHub repository, you must have a <code>README.md</code> file. This file should briefly explain what the project does and how to run it.</li>
            </ol>
            <p style="color: var(--cyan-glow);"><strong>Submit the link to your GitHub repository to: elvionailabs@gmail.com</strong> after filling out the certificate form on the next page.</p>
        `,
        quiz: [
            { type: 'mcq', question: 'What is the main goal of the final project?', options: ['To build a mobile app', 'To integrate concepts from lessons 1-7 into a single Python application', 'To design a database', 'To write an AI algorithm'], answer: 'To integrate concepts from lessons 1-7 into a single Python application' },
            { type: 'mcq', question: 'Which concept from Lesson 3 is a mandatory requirement for managing user data in the project?', options: ['Using a simple list of names', 'Using the User Class', 'Reading from a text file', 'Using a dictionary'], answer: 'Using the User Class' },
            { type: 'mcq', question: 'How are messages meant to be stored for the MVP version of the project?', options: ['In a real SQL database', 'In a simple List of Dictionaries within the program', 'They are not stored', 'In a separate text file'], answer: 'In a simple List of Dictionaries within the program' },
            { type: 'text', question: 'What is the name of the documentation file you must include in your GitHub repository?', answer: 'README.md' },
        ]
    }
];
    // --- SOFTWARE ENGINEERING COURSE CONTENT (ALL Template Literals) ---
    const swe101Lessons = [
        {
            id: 1,
            title: 'L1: Software Engineering Discipline & Mindset',
            duration: '50 min',
            content: `
                <h2>What is Software Engineering? (SWE)</h2>
                <p>Software Engineering is the systematic, disciplined, quantifiable approach to the development, operation, and maintenance of software. It's not just coding; it's about building complex systems reliably, on time, and within budget, treating software development as an engineering discipline.</p>

                <h3>Why Engineering?</h3>
                <p>Unlike simple programming (where one person writes code for a small task), Software Engineering deals with:</p>
                <ul>
                    <li><strong>Scale:</strong> Projects involving hundreds of developers and millions of lines of code.</li>
                    <li><strong>Reliability:</strong> The software must work correctly, especially in critical applications (e.g., medical, aviation).</li>
                    <li><strong>Maintainability:</strong> The ability for future teams to update and fix the software efficiently.</li>
                </ul>

                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--warning-color);">
                    <div class="area-header" style="color: var(--warning-color);"><span>The SWE Mindset</span></div>
                    <p>The core mindset of an engineer is: **Plan, Test, Document, and Optimize**. A software engineer spends far more time designing and verifying than writing the initial code.</p>
                </div>
                
                <h3>Activity: The Bridge Analogy</h3>
                <p>Consider a bridge builder (Civil Engineer) vs. someone nailing two boards together (Hobbyist). The bridge requires extensive planning, stress testing, material science, and regulatory compliance. Software development for a bank's security system is like building a bridge; an engineer is required.</p>
                
                <h3>Further Reading</h3>
                <ul>
                    <li>IEEE/ISO Standard for Software Engineering: <code>iso.org/standard/24640.html</code></li>
                    <li>"The Mythical Man-Month" by Frederick Brooks (On software project management).</li>
                </ul>
            `,
            quiz: [
                { type: 'mcq', question: 'Software Engineering is defined as a systematic, disciplined, quantifiable approach to:', options: ['Only coding tasks', 'The development, operation, and maintenance of software', 'Only bug fixing', 'Writing short scripts'], answer: 'The development, operation, and maintenance of software' },
                { type: 'mcq', question: 'Which characteristic is a major concern for Software Engineering but less so for simple programming?', options: ['Writing variable names', 'Choosing a text editor', 'Dealing with project scale and maintainability', 'Debugging basic loops'], answer: 'Dealing with project scale and maintainability' },
            ],
        },
        {
            id: 2,
            title: 'L2: SDLC and Methodologies (Agile vs. Waterfall)',
            duration: '60 min',
            content: `
                <h2>The Software Development Lifecycle (SDLC)</h2>
                <p>The SDLC is a process followed by a software project within a software organization. It outlines a detailed plan for how to develop, maintain, replace, or alter software systems. The common phases are: Planning, Requirements Analysis, Design, Implementation (Coding), Testing, Deployment, and Maintenance.</p>

                <h3>Waterfall Methodology</h3>
                <p>The Waterfall model is a sequential design process, where progress flows steadily downwards like a waterfall. Each phase must be completed and signed off before the next phase can begin.</p>
                <ul>
                    <li>**Pros:** Simple to understand, easy to manage due to rigid phases, good for small projects with clearly defined, unchanging requirements.</li>
                    <li>**Cons:** High risk for complex projects; no working software until late in the cycle; difficult to respond to changing requirements.</li>
                </ul>

                <h3>Agile Methodology</h3>
                <p>Agile is an iterative, incremental approach. It focuses on delivering value quickly and responding to change. It is guided by the **Agile Manifesto** principles: individuals and interactions over processes and tools, working software over comprehensive documentation, customer collaboration over contract negotiation, and responding to change over following a plan.</p>
                <ul>
                    <li>**Key Concepts:** **Sprints** (short, time-boxed iterations, typically 2-4 weeks), **Daily Standups**, **Product Backlogs**.</li>
                    <li>**Pros:** High customer satisfaction, early and continuous delivery of working software, highly adaptable to changes.</li>
                    <li>**Cons:** Requires intense customer involvement, can be hard to measure progress for complex projects without clear documentation.</li>
                </ul>

                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--primary-color);">
                    <div class="area-header" style="color: var(--primary-color);"><span>Real-World SDLC</span></div>
                    <p>Most modern tech companies use variations of Agile (like Scrum or Kanban) because product requirements in the tech industry change constantly. Waterfall is generally reserved for government contracts or embedded systems where requirements are fixed from the start.</p>
                </div>
            `,
            quiz: [
                { type: 'mcq', question: 'Which SDLC methodology requires that each phase be completed and signed off before the next phase begins?', options: ['Agile', 'Scrum', 'Kanban', 'Waterfall'], answer: 'Waterfall' },
                { type: 'mcq', question: 'The Agile methodology prioritizes "working software" over what, according to the manifesto?', options: ['Individuals and interactions', 'Comprehensive documentation', 'Responding to change', 'Customer collaboration'], answer: 'Comprehensive documentation' },
            ],
        },
        {
            id: 3,
            title: 'L3: Requirements and Design Documentation',
            duration: '45 min',
            content: `
                <h2>The Importance of Documentation</h2>
                <p>In software engineering, documentation is the blueprint for development. It ensures everyoneâ€”from the customer to the developerâ€”is aligned on what needs to be built and how it will function. Two critical types of documents are requirements and design.</p>

                <h3>Requirements Documentation (SRS)</h3>
                <p>The **Software Requirements Specification (SRS)** documents the functional and non-functional requirements of the system. This answers: **"What will the system do?"**</p>
                <ul>
                    <li>**Functional Requirements:** Define the features and services the system provides (e.g., "The system shall allow users to log in with a valid username and password").</li>
                    <li>**Non-functional Requirements:** Define the qualities of the system (e.g., **Performance:** "The system shall load the dashboard in under 2 seconds." **Security:** "All user data must be encrypted.").</li>
                </ul>

                <h3>Design Documentation</h3>
                <p>The Design Document details the high-level architecture and low-level component design. This answers: **"How will the system be built?"**</p>
                <ul>
                    <li>**UML Diagrams:** **Unified Modeling Language** diagrams (like Class Diagrams or Use Case Diagrams) are used to visually model the system's structure and behavior.</li>
                    <li>**Use Cases:** Describes how a user interacts with the system to achieve a specific goal (e.g., "User logs in" or "User creates a new order").</li>
                </ul>

                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--success-color);">
                    <div class="area-header" style="color: var(--success-color);"><span>The Engineer's Motto</span></div>
                    <p>A poorly written requirement leads to poorly written code. A Software Engineer's first job is not to code, but to **ensure the requirements are complete, consistent, and unambiguous.**</p>
                </div>
            `,
            quiz: [
                { type: 'mcq', question: 'Which requirement specifies the qualities of a system, such as speed or security?', options: ['Functional Requirement', 'Business Requirement', 'Non-functional Requirement', 'User Story'], answer: 'Non-functional Requirement' },
                { type: 'mcq', question: 'The Software Requirements Specification (SRS) primarily answers which question?', options: ['How long will it take to build?', 'What will the system do?', 'What coding language is best?', 'How much will it cost?'], answer: 'What will the system do?' },
            ],
        },
        {
            id: 4,
            title: 'L4: Introduction to Design Patterns',
            duration: '75 min',
            content: `
                <h2>Solving Common Problems with Design Patterns</h2>
                <p>In software engineering, a **Design Pattern** is a reusable solution to a commonly occurring problem within a given context in software design. They are not finished designs that can be plugged straight into your code; they are templates or blueprints for how to solve a problem.</p>

                <h3>The Three Categories</h3>
                <p>Patterns are usually categorized into three groups:</p>
                <ol>
                    <li>**Creational Patterns:** Concerned with the way objects are created (e.g., Factory, Singleton).</li>
                    <li>**Structural Patterns:** Concerned with composing classes and objects (e.g., Adapter, Decorator).</li>
                    <li>**Behavioral Patterns:** Concerned with communication between objects (e.g., Observer, Strategy).</li>
                </ol>

                <h3>Pattern Deep Dive: The Singleton Pattern (Creational)</h3>
                <p>The Singleton Pattern ensures a class has only **one instance** and provides a global point of access to it. This is useful for things like a single database connection pool or a global configuration manager.</p>
                <pre><code>// Example Concept: Singleton
class ConfigurationManager {
    private static instance: ConfigurationManager;
    private constructor() { /* Load settings */ }
    
    public static getInstance(): ConfigurationManager {
        if (!ConfigurationManager.instance) {
            ConfigurationManager.instance = new ConfigurationManager();
        }
        return ConfigurationManager.instance;
    }
}</code></pre>

                <h3>Pattern Deep Dive: The Factory Pattern (Creational)</h3>
                <p>The Factory Pattern provides an interface for creating objects in a superclass, but allows subclasses to alter the type of objects that will be created. This decouples the object creation logic from the client code.</p>
                <p style="color: var(--cyan-glow);">**Benefit:** Using design patterns leads to code that is more robust, reusable, and easier to maintain because it follows well-established engineering best practices.</p>
            `,
            quiz: [
                { type: 'mcq', question: 'A Design Pattern is best described as:', options: ['A finished, plug-and-play piece of code', 'A template for solving a common problem in a specific context', 'A legal contract for software design', 'A programming language feature'], answer: 'A template for solving a common problem in a specific context' },
                { type: 'mcq', question: 'Which creational pattern ensures a class has only one instance and provides a global access point?', options: ['Observer', 'Factory', 'Decorator', 'Singleton'], answer: 'Singleton' },
            ],
        },
        {
            id: 5,
            title: 'L5: Final Project: Architecting a System',
            duration: '90 min',
            content: `
                <h2>Course Capstone: The Architectural Design Document</h2>
                <p>Congratulations on completing the core lessons! Your final requirement is to apply the principles of Requirements Analysis, SDLC, and Design to create a professional **Architectural Design Document** for a new software system.</p>

                <h3>Project Brief: The "Elvion Academy Planner"</h3>
                <p>Design a system that allows Elvion University students to track their course progress, manage due dates, and visualize their overall Grade Point (GP) progress across all courses.</p>

                <h3>Required Sections for Submission</h3>
                <p>Your Design Document (PDF or Markdown file) must include the following sections (2000-word minimum total):</p>
                <ol>
                    <li>**Overview & Goals:** (500 words) What is the system? What problem does it solve? Define the target user.</li>
                    <li>**Requirements (SRS):** (500 words) Detail at least 5 **Functional** and 5 **Non-functional** requirements (e.g., Performance, Security, Usability).</li>
                    <li>**SDLC Justification:** (300 words) Which methodology (Agile or Waterfall) would you choose for this project and why?</li>
                    <li>**Architectural Design:** (700 words)
                        <ul>
                            <li>Propose a high-level architecture (e.g., 3-Tier, Microservices).</li>
                            <li>Identify two key components (e.g., Database, Authentication Service).</li>
                            <li>**Design Pattern Application:** Specify one Creational and one Structural/Behavioral design pattern you would use in a component and justify its use.</li>
                        </ul>
                    </li>
                </ol>
                
                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--success-color);">
                    <div class="area-header" style="color: var(--success-color);"><span>Submission Instructions</span></div>
                    <p>This is a non-code project. Your final submission is the written document. Save your document as: <strong>SWE101_YourName_DesignDoc.pdf</strong>.</p>
                    <p style="color: var(--error-color); font-weight: bold;">**ACTION:** Email your final document to: <code>elvionailabs@gmail.com</code></p>
                </div>
                <p>Once you pass the final quiz below, click "Final Exam/Certificate" in the navigation bar to proceed with certificate request.</p>
            `,
            quiz: [
                { type: 'mcq', question: 'For the SWE101 course, what is the final deliverable requirement?', options: ['A full, working code application', 'An Architectural Design Document', 'A face-to-face interview', 'A group presentation'], answer: 'An Architectural Design Document' },
                { type: 'text', question: 'What is the email address to which you must submit your project for certificate review? (Enter exactly)', answer: 'elvionailabs@gmail.com' },
            ],
        }
    ];


    // Assembling all courses
    const allCourses = [
        { id: 'cs101', title: 'Computer Science', description: 'Fundamentals of computing, programming, and algorithms', icon: 'fas fa-laptop-code', totalLessons: 8, estimatedHours: 120, mediaType: 'video', lessons: cs101Lessons },
        // NEW SOFTWARE ENGINEERING COURSE - CORRECTLY LINKED
        { id: 'swe101', title: 'Software Engineering', description: 'Design, develop, and maintain large-scale software systems.', icon: 'fas fa-cogs', totalLessons: 5, estimatedHours: 80, mediaType: 'video', lessons: swe101Lessons },
        // OTHER COURSES WITH GENERATED PLACEHOLDERS
        { id: 'law101', title: 'Law (LLB)', description: 'Comprehensive study of legal principles and practice.', icon: 'fas fa-balance-scale', totalLessons: 6, estimatedHours: 90, mediaType: 'video', lessons: generateDefaultLessons(6, 'LAW', false) },
        { id: 'eng101', title: 'English & Literary Studies', description: 'Study of English language, literature, and critical analysis.', icon: 'fas fa-pen-nib', totalLessons: 4, estimatedHours: 60, mediaType: 'audio', lessons: generateDefaultLessons(4, 'ENG', false) },
        { id: 'his101', title: 'History & Strategic Studies', description: 'World history, Nigerian history, and strategic studies.', icon: 'fas fa-globe-africa', totalLessons: 5, estimatedHours: 75, mediaType: 'audio', lessons: generateDefaultLessons(5, 'HIS', false) },
        { id: 'bus101', title: 'Business Administration', description: 'Principles of management, marketing, finance, and entrepreneurship.', icon: 'fas fa-chart-line', totalLessons: 7, estimatedHours: 100, mediaType: 'audio', lessons: generateDefaultLessons(7, 'BUS', true) },
        { id: 'mass101', title: 'Mass Communication', description: 'Journalism, public relations, broadcasting, and digital media communication.', icon: 'fas fa-bullhorn', totalLessons: 6, estimatedHours: 90, mediaType: 'audio', lessons: generateDefaultLessons(6, 'MASS', false) },
        { id: 'math101', title: 'Mathematics Education', description: 'Methods and strategies for teaching mathematics.', icon: 'fas fa-calculator', totalLessons: 5, estimatedHours: 70, mediaType: 'audio', lessons: generateDefaultLessons(5, 'MATED', false) },
        { id: 'aed101', title: 'Adult Education', description: 'Teaching and learning strategies for adult learners.', icon: 'fas fa-chalkboard-teacher', totalLessons: 4, estimatedHours: 60, mediaType: 'audio', lessons: generateDefaultLessons(4, 'ADULT', false) },
        {
            id: 'visart101',
            title: 'Visual Arts & Digital Media',
            description: 'A study of animation, painting, graphic design, and digital art.',
            icon: 'fas fa-palette',
            totalLessons: 6,
            estimatedHours: 95,
            mediaType: 'video',
            lessons: generateDefaultLessons(6, 'VA', true)
        },
    ];

    let currentUser = null;
    let userData = null;
    let currentCourse = null;
    let currentLesson = 1;
    let totalLessons = 0;
    let quizPassed = false; // New state to track if quiz is passed for navigation

    // URL Parameters
    const urlParams = new URLSearchParams(window.location.search);
    const courseId = urlParams.get('courseId');
    const lessonParam = urlParams.get('lesson');

    // ... (DOM Content Loaded and Star Animation code remains the same)

    // Mobile Menu Toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const courseSidebar = document.getElementById('courseSidebar');

    mobileMenuToggle.addEventListener('click', () => {
        courseSidebar.classList.toggle('active');
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
        if (window.innerWidth <= 992) {
            if (!courseSidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                courseSidebar.classList.remove('active');
            }
        }
    });

    // Auth State Management
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            await loadUserData();
            await initializeCourseViewer();
        } else {
            // Redirect to enrollment page if not logged in
            window.location.href = 'enroll.html';
        }
    });

    async function loadUserData() {
        try {
            const userDocRef = doc(db, 'users', currentUser.uid);
            const userDoc = await getDoc(userDocRef);

            if (userDoc.exists()) {
                userData = userDoc.data();
                // Ensure totalPoints exists for new users
                if (userData.totalPoints === undefined) {
                    userData.totalPoints = 0;
                    await updateDoc(userDocRef, { totalPoints: 0 });
                }
            } else {
                // Redirect to dashboard (or enrollment flow) if user data is missing
                window.location.href = 'studyingatelvion.html';
            }
        } catch (error) {
            console.error('Error loading user data:', error);
            alert('Error loading user data. Please try again.');
        }
    }

    async function initializeCourseViewer() {
        if (!courseId) {
            alert('No course specified');
            window.location.href = 'studyingatelvion.html';
            return;
        }

        currentCourse = findCourseById(courseId);
        if (!currentCourse) {
            alert('Course not found');
            window.location.href = 'studyingatelvion.html';
            return;
        }

        totalLessons = currentCourse.totalLessons;
        currentLesson = parseInt(lessonParam) || 1;

        // Check if user is enrolled
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        if (!enrolledCourse) {
            alert('You are not enrolled in this course');
            window.location.href = 'studyingatelvion.html';
            return;
        }

        setupCourseInterface();
        renderLessonsList();
        loadLesson(currentLesson);

        document.getElementById('loadingContainer').style.display = 'none';
        document.getElementById('contentHeader').style.display = 'flex';
        document.getElementById('mainContent').style.display = 'block';
        document.getElementById('lessonNavigation').style.display = 'flex';
    }

    function findCourseById(courseId) {
        return allCourses.find(c => c.id === courseId);
    }

    function setupCourseInterface() {
        document.getElementById('courseIconLarge').className = `course-icon-large ${currentCourse.icon}`;
        document.getElementById('courseTitle').textContent = currentCourse.title;
        document.getElementById('courseSubtitle').textContent = currentCourse.description;

        // Populate Certificate Form details
        document.getElementById('formSubject').value = `Certificate Request: ${currentCourse.title}`;
        document.getElementById('completedCourseName').value = currentCourse.title;

        updateOverallProgress();
    }

    function updateOverallProgress() {
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        const progress = enrolledCourse?.progress || 0;
        const completedLessons = enrolledCourse?.completedLessons?.length || 0;

        document.getElementById('overallProgressBar').style.width = `${progress}%`;
        document.getElementById('overallProgressText').textContent = `${progress}% Complete (${completedLessons}/${totalLessons} lessons)`;

        // Update Total Points for GP (sidebar and nav)
        document.getElementById('totalPointsEarnedSidebar').textContent = userData.totalPoints || 0;
        document.getElementById('totalPointsEarnedNav').textContent = userData.totalPoints || 0;
        document.getElementById('formTotalPoints').value = userData.totalPoints || 0;
        document.getElementById('finalTotalPoints').textContent = userData.totalPoints || 0;
    }

    function renderLessonsList() {
        const container = document.getElementById('lessonsContainer');
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        const completedLessons = enrolledCourse?.completedLessons || [];

        container.innerHTML = '';

        currentCourse.lessons.forEach((lesson) => {
            const lessonNumber = lesson.id;
            const isCompleted = completedLessons.includes(lessonNumber);
            const isCurrent = lessonNumber === currentLesson;
            const isAccessible = lessonNumber <= (enrolledCourse?.currentLesson || 1);

            const lessonItem = document.createElement('div');
            lessonItem.className = `lesson-item ${isCurrent ? 'active' : ''} ${isCompleted ? 'completed' : ''}`;

            let statusIcon, statusClass;
            if (isCompleted) {
                statusIcon = '<i class="fas fa-check"></i>';
                statusClass = 'completed';
            } else if (isCurrent) {
                statusIcon = lessonNumber;
                statusClass = 'current';
            } else if (isAccessible) {
                statusIcon = lessonNumber;
                statusClass = ''; // Accessible but not current/completed
            } else {
                statusIcon = '<i class="fas fa-lock"></i>';
                statusClass = 'locked';
            }

            lessonItem.innerHTML = `
                <div class="lesson-status ${statusClass}">${statusIcon}</div>
                <div class="lesson-details">
                    <div class="lesson-title">${lesson.title}</div>
                    <div class="lesson-duration">${lesson.duration}</div>
                </div>
            `;

            if (isAccessible) {
                lessonItem.style.cursor = 'pointer';
                lessonItem.addEventListener('click', () => {
                    if (lessonNumber !== currentLesson) {
                        loadLesson(lessonNumber);
                        courseSidebar.classList.remove('active'); // Close on mobile navigation
                    }
                });
            } else {
                lessonItem.style.opacity = '0.5';
                lessonItem.style.cursor = 'not-allowed';
            }

            container.appendChild(lessonItem);
        });

        // Add the final certificate page link
        if (enrolledCourse?.progress === 100) {
            const finalItem = document.createElement('div');
            finalItem.className = `lesson-item ${currentLesson === totalLessons + 1 ? 'active' : ''}`;
            finalItem.style.borderLeftColor = 'var(--success-color)';
            finalItem.innerHTML = `
                <div class="lesson-status completed" style="background: var(--success-color);"><i class="fas fa-certificate"></i></div>
                <div class="lesson-details">
                    <div class="lesson-title" style="color: var(--success-color); font-weight: 700;">Final Exam/Certificate</div>
                    <div class="lesson-duration">Your Course GP is Ready</div>
                </div>
            `;
            finalItem.style.cursor = 'pointer';
            finalItem.addEventListener('click', () => {
                loadLesson(totalLessons + 1);
                courseSidebar.classList.remove('active'); // Close on mobile navigation
            });
            container.appendChild(finalItem);
        }
    }

    function loadLesson(lessonNumber) {
        currentLesson = lessonNumber;
        quizPassed = false; // Reset quiz state for the new lesson

        // Update URL without reloading
        const newUrl = new URL(window.location);
        newUrl.searchParams.set('lesson', lessonNumber);
        window.history.pushState({}, '', newUrl);

        // Hide all main content elements first
        document.getElementById('finalCoursePage').style.display = 'none';
        document.getElementById('contentHeader').style.display = 'flex';
        document.getElementById('lessonNavigation').style.display = 'flex';
        const contentCard = document.querySelector('.content-card');
        const quizContainer = document.getElementById('quizContainer');
        const mediaPlayer = document.getElementById('mediaPlayer');

        contentCard.style.display = 'block';
        mediaPlayer.style.display = 'flex';

        if (currentLesson === totalLessons + 1) {
            // Final Page Logic
            document.getElementById('contentHeader').style.display = 'none';
            document.getElementById('lessonNavigation').style.display = 'none';
            document.getElementById('finalCoursePage').style.display = 'block';
            contentCard.style.display = 'none';
            quizContainer.style.display = 'none';
            mediaPlayer.style.display = 'none';

            updateOverallProgress(); // Refresh GP
        } else {
            // Lesson Page Logic
            const lesson = currentCourse.lessons.find(l => l.id === lessonNumber);
            if (!lesson) return;

            // Update header
            document.getElementById('lessonTitle').textContent = lesson.title;
            document.getElementById('lessonDuration').textContent = lesson.duration;
            document.getElementById('currentLessonNumber').textContent = lessonNumber;
            document.getElementById('totalLessons').textContent = totalLessons;
            document.getElementById('lessonPoints').textContent = '10';
            document.getElementById('markCompleteBtn').style.display = 'none';

            // Update navigation
            document.getElementById('navCurrentLesson').textContent = lessonNumber;
            document.getElementById('navTotalLessons').textContent = totalLessons;

            // Update content
            document.getElementById('lessonContent').innerHTML = lesson.content;

            // Update media player
            const mediaPlaceholderText = document.getElementById('mediaPlaceholderText');
            if (currentCourse.mediaType === 'audio') {
                mediaPlayer.innerHTML = `
                    <audio controls style="width:100%; height: auto; outline:none; border-radius:10px; box-shadow:0 0 8px var(--cyan-glow);">
                        <source src="university/generic_audio.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                `;
                mediaPlaceholderText.textContent = 'Audio content for this lesson is available above.';
            } else {
                mediaPlayer.innerHTML = `
                <div class="media-placeholder">
                    <i class="fas fa-play-circle"></i>
                    <p id="mediaPlaceholderText">Video content coming soon</p>
                    <p style="font-size: 0.9rem; opacity: 0.7;">For now, please read the lesson content below</p>
                </div>
                `;
                mediaPlaceholderText.textContent = 'Video content coming soon';
            }

            // Render Quiz
            const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
            const isCompleted = enrolledCourse?.completedLessons?.includes(currentLesson);

            if (lesson.quiz) {
                quizContainer.style.display = 'block';
                renderQuiz(lesson.quiz, isCompleted);
            } else {
                quizContainer.style.display = 'none';
            }
        }

        // Update navigation buttons and state
        updateNavigationControls();

        // Update sidebar
        renderLessonsList();

        // Scroll to top
        window.scrollTo(0, 0);
    }

    function updateNavigationControls() {
        const prevBtn = document.getElementById('prevLessonBtn');
        const nextBtn = document.getElementById('nextLessonBtn');
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        const isCompleted = enrolledCourse?.completedLessons?.includes(currentLesson);
        const isCourseFullyCompleted = enrolledCourse?.progress === 100;

        // Previous Button Logic
        prevBtn.disabled = currentLesson <= 1;

        // Next Button Logic
        if (currentLesson === totalLessons) {
            nextBtn.textContent = 'Final Exam/Certificate';
            // Enable only if all lessons are completed (progress 100%)
            nextBtn.disabled = !isCourseFullyCompleted && !isCompleted; // Use isCompleted as a fallback if progress hasn't updated immediately
        } else if (currentLesson === totalLessons + 1) {
            // On Final Page, next is always disabled
            nextBtn.textContent = 'Course Completed';
            nextBtn.disabled = true;
        } else if (isCompleted || quizPassed) {
            nextBtn.textContent = 'Next Lesson';
            nextBtn.disabled = false;
        } else {
            nextBtn.textContent = 'Pass Quiz to Unlock';
            nextBtn.disabled = true;
        }
    }

    // --- QUIZ LOGIC (Updated to include animation/feedback) ---

    function renderQuiz(quizData, isLessonCompleted) {
        const quizQuestionsContainer = document.getElementById('quizQuestions');
        quizQuestionsContainer.innerHTML = '';
        document.getElementById('quizResult').innerHTML = ''; // Clear result area

        // Hide submit button if lesson is already completed
        const submitBtn = document.getElementById('submitQuizBtn');
        submitBtn.style.display = isLessonCompleted ? 'none' : 'block';

        quizData.forEach((q, index) => {
            const questionElement = document.createElement('div');
            questionElement.className = 'quiz-question-wrapper';
            questionElement.style.marginBottom = '2rem'; // Separating questions

            questionElement.innerHTML = `
                <div class="quiz-question">Question ${index + 1}: ${q.question}</div>
                <div class="quiz-options" data-question-index="${index}">
                    ${q.type === 'mcq' ? q.options.map(option => `
                        <div class="quiz-option" data-answer="${option}" ${isLessonCompleted ? 'style="cursor: default;"' : ''}>${option}</div>
                    `).join('') : ''}
                    ${q.type === 'text' ? `
                        <input type="text" class="text-input-answer" placeholder="Type your answer here..." style="width: 100%; padding: 1rem; border-radius: 8px; border: 2px solid rgba(0, 255, 255, 0.3); background: rgba(0, 0, 0, 0.5); color: var(--text-color); font-size: 1rem;" ${isLessonCompleted ? 'disabled' : ''}>
                    ` : ''}
                </div>
            `;
            quizQuestionsContainer.appendChild(questionElement);
        });

        // Add event listeners for MCQ selection only if not completed
        if (!isLessonCompleted) {
            quizQuestionsContainer.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function () {
                    const optionsGroup = this.closest('.quiz-options');
                    // Deselect all others in the group
                    optionsGroup.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
                    // Select the clicked one
                    this.classList.add('selected');
                });
            });
        } else {
            // If completed, visually mark the correct answer on load
            quizData.forEach((q, index) => {
                const optionsGroup = document.querySelector(`.quiz-options[data-question-index="${index}"]`);
                if (q.type === 'mcq') {
                    // Mark the correct answer
                    optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                } else if (q.type === 'text') {
                    const input = optionsGroup.querySelector(`.text-input-answer`);
                    input.value = q.answer;
                    input.style.border = `2px solid var(--success-color)`;
                }
            });
            document.getElementById('quizResult').innerHTML = `<div class="quiz-feedback correct"><i class="fas fa-check-circle"></i> **Lesson Already Completed!** You may move to the next lesson.</div>`;
            quizPassed = true;
            updateNavigationControls();
        }
    }

    document.getElementById('submitQuizBtn').addEventListener('click', () => {
        const lesson = currentCourse.lessons.find(l => l.id === currentLesson);
        const quizData = lesson.quiz;
        let allCorrect = true;
        let score = 0;

        // Reset and evaluate
        quizData.forEach((q, index) => {
            const optionsGroup = document.querySelector(`.quiz-options[data-question-index="${index}"]`);
            let isCorrect = false;

            if (q.type === 'mcq') {
                const selectedOption = optionsGroup.querySelector('.quiz-option.selected');

                // Clear all previous result classes and animation classes first
                optionsGroup.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('correct', 'incorrect'));

                if (selectedOption) {
                    if (selectedOption.dataset.answer === q.answer) {
                        isCorrect = true;
                        selectedOption.classList.add('correct');
                    } else {
                        selectedOption.classList.add('incorrect');
                        // Highlight the correct answer
                        optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`).classList.add('correct');
                    }
                } else {
                    // User did not select an answer, fail and highlight correct answer
                    optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                }
            } else if (q.type === 'text') {
                const input = optionsGroup.querySelector('.text-input-answer');
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = q.answer.trim().toLowerCase();

                if (userAnswer === correctAnswer) {
                    isCorrect = true;
                    input.style.border = `2px solid var(--success-color)`;
                } else {
                    input.style.border = `2px solid var(--error-color)`;
                    // Note: No easy way to show correct text answer without disrupting the UI, just show error
                }
            }

            if (isCorrect) {
                score++;
            } else {
                allCorrect = false;
            }
        });

        const quizResultElement = document.getElementById('quizResult');
        const totalQuestions = quizData.length;

        if (allCorrect) {
            quizResultElement.innerHTML = `
                <div class="quiz-feedback correct">
                    <i class="fas fa-check-circle"></i> **Perfect Score!** You got ${score}/${totalQuestions} correct. Lesson unlocked!
                </div>
            `;
            // All correct! Mark lesson complete and show modal.
            markLessonComplete();
            document.getElementById('submitQuizBtn').style.display = 'none'; // Hide submit after passing
        } else {
            quizResultElement.innerHTML = `
                <div class="quiz-feedback incorrect">
                    <i class="fas fa-times-circle"></i> **Incorrect Answers.** Score: ${score}/${totalQuestions}. Please review the lesson and try again.
                </div>
            `;
            // Disable navigation controls if quiz failed
            quizPassed = false;
            updateNavigationControls();
        }
    });

    // --- END QUIZ LOGIC ---


    // Event Listeners
    document.getElementById('prevLessonBtn').addEventListener('click', () => {
        if (currentLesson === totalLessons + 1) {
            loadLesson(totalLessons); // Back from final page to last lesson
        } else if (currentLesson > 1) {
            loadLesson(currentLesson - 1);
        }
    });

    document.getElementById('nextLessonBtn').addEventListener('click', () => {
        if (currentLesson < totalLessons) {
            // This is only enabled if the lesson is completed/quiz is passed
            loadLesson(currentLesson + 1);
        } else if (currentLesson === totalLessons) {
            // Go to final page (Only enabled if progress is 100)
            const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
            if (enrolledCourse?.progress === 100 || enrolledCourse?.completedLessons?.includes(totalLessons)) {
                loadLesson(currentLesson + 1);
            }
        }
    });

    document.getElementById('continueBtn').addEventListener('click', () => {
        document.getElementById('completionModal').style.display = 'none';
        if (currentLesson < totalLessons) {
            loadLesson(currentLesson + 1);
        } else if (currentLesson === totalLessons) {
            loadLesson(currentLesson + 1); // Go to the final certificate page
        }
    });

    // Corrected Dashboard Redirect
    document.getElementById('backToDashboardBtn').addEventListener('click', () => {
        window.location.href = 'studyingatelvion.html';
    });

    async function markLessonComplete() {
        try {
            const enrolledCourseIndex = userData.enrolledCourses.findIndex(c => c.courseId === courseId);
            if (enrolledCourseIndex === -1) return;

            const enrolledCourse = userData.enrolledCourses[enrolledCourseIndex];

            // Check for double completion (to prevent point inflation)
            if (enrolledCourse.completedLessons?.includes(currentLesson)) {
                // Already completed, just update session state and show modal
                quizPassed = true;
                updateNavigationControls();
                document.getElementById('pointsEarned').textContent = '0 (Already earned)';
                document.getElementById('completionModal').style.display = 'flex';
                return;
            }

            // Add to completed lessons
            if (!enrolledCourse.completedLessons) {
                enrolledCourse.completedLessons = [];
            }
            enrolledCourse.completedLessons.push(currentLesson);

            // Update current lesson access: currentLesson + 1
            enrolledCourse.currentLesson = Math.max(enrolledCourse.currentLesson || 1, currentLesson + 1);

            // Calculate progress
            const completedCount = enrolledCourse.completedLessons.length;
            enrolledCourse.progress = Math.round((completedCount / totalLessons) * 100);

            // Update user data: GP/Points logic is here
            userData.enrolledCourses[enrolledCourseIndex] = enrolledCourse;
            userData.completedLessons = (userData.completedLessons || 0) + 1;
            userData.totalPoints = (userData.totalPoints || 0) + 10; // 10 points per lesson

            // Save to database
            await updateDoc(doc(db, 'users', currentUser.uid), {
                enrolledCourses: userData.enrolledCourses,
                completedLessons: userData.completedLessons,
                totalPoints: userData.totalPoints
            });

            // Update UI
            updateOverallProgress();
            renderLessonsList();

            // Mark Quiz as passed for this session
            quizPassed = true;
            updateNavigationControls();

            // Show completion modal
            document.getElementById('pointsEarned').textContent = '10';
            document.getElementById('completionModal').style.display = 'flex';

        } catch (error) {
            console.error('Error marking lesson complete:', error);
            alert('Error updating progress. Please try again.');
        }
    }

    // Initialize stars (outside of DOMContentLoaded to be safe with module imports)
    document.addEventListener('DOMContentLoaded', () => {
        const starsContainer = document.getElementById('stars-container');
        const numStars = 100;
        const minSize = 1;
        const maxSize = 3;
        for (let i = 0; i < numStars; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            const size = Math.random() * (maxSize - minSize) + minSize;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 4}s`;
            star.style.animationDuration = `${3 + Math.random() * 2}s`;
            starsContainer.appendChild(star);
        }
    });

</script>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
Â  window.dataLayer = window.dataLayer || [];
Â  function gtag(){dataLayer.push(arguments);}
Â  gtag('js', new Date()); 

Â  gtag('config', 'G-J1YTKP10ZX');
</script>
