<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10 Must Read Books That Will Change How You Think in 2025 | Elvion AI Blog</title>
    <meta name="description" content="A curated list of 10 profound, mind-bending books that challenge your assumptions about history, psychology, and humanity, written by Philip Smith.">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Orbitron:wght@600;700;800;900&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* --- DUAL THEME VARIABLES (Default: DARK MODE) --- */
        :root {
            /* Elvion AI Cyan/Blue Theme */
            --dark-navy: #00001a;
            --bg-color: #0d1117; 
            --text-color: #e6edf3;
            --heading-color: #ffffff;
            --cyan-glow: #00ffff;
            --light-blue-glow: #00aaff; 
            --link-color: var(--cyan-glow);
            --link-hover-color: var(--light-blue-glow);
            --border-color: #21262d;
            --card-bg: #161b22; 
            --button-bg: linear-gradient(45deg, var(--cyan-glow), var(--light-blue-glow));
            --button-text-color: #0d1117; /* Dark text on bright button */
            --button-hover-bg: linear-gradient(45deg, #00d4d4, #0077ff);
            --navbar-bg: rgba(13, 17, 23, 0.95);
            --footer-bg: #0a0e14;
            --highlight-color: rgba(0, 255, 255, 0.3); 
            --comment-bg: #0d1117;
            --shadow-glow: 0 0 10px rgba(0, 255, 255, 0.15);
            /* Dark Mode Headline Color */
            --headline-color: var(--light-blue-glow);
            /* Verified Badge Color */
            --verified-color: #1DA1F2; /* Standard Blue Checkmark */
            /* New Admin Glow Badge Colors */
            --admin-color: #FFD700; /* Gold */
            --admin-glow: rgba(255, 215, 0, 0.5);
            /* New Audio Player */
            --audio-widget-bg: rgba(22, 27, 34, 0.9);
        }

        /* LIGHT MODE VARIABLES */
        body.light-theme {
            --bg-color: #f7f7f7; /* Less whitish, slight off-white */
            --text-color: #333333;
            --heading-color: #111111;
            --link-color: #0056b3;
            --link-hover-color: #003d80;
            --border-color: #e0e0e0;
            --card-bg: #ffffff; /* Card background is still white */
            --button-bg: #0056b3;
            --button-text-color: #ffffff;
            --button-hover-bg: #003d80;
            --navbar-bg: rgba(255, 255, 255, 0.95);
            --footer-bg: #eeeeee;
            --highlight-color: #ffeb3b; /* A subtle yellow highlight */
            --comment-bg: #ffffff;
            --shadow-glow: none;
            /* Light Mode Headline Color */
            --headline-color: #111111; /* Black headline */
            /* Verified Badge Color */
            --verified-color: #1DA1F2;
            /* New Admin Glow Badge Colors */
            --admin-color: #CCAA00; /* Darker Gold */
            --admin-glow: none;
            /* New Audio Player */
            --audio-widget-bg: rgba(255, 255, 255, 0.9);
        }

        /* --- GLOBAL STYLES --- */
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding-top: 60px;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.8;
            font-size: 1.1rem;
            overflow-x: hidden;
            transition: background-color 0.3s, color 0.3s;
        }

        h1, h2, h3, h4 {
            font-family: 'Orbitron', sans-serif;
            color: var(--heading-color);
            margin-top: 0;
            line-height: 1.3;
            text-shadow: var(--shadow-glow);
        }
        
        a {
            color: var(--link-color);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        a:hover {
            color: var(--link-hover-color);
            text-decoration: underline;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }
        
        .post-container {
             max-width: 800px;
             margin: 0 auto;
             padding: 0 1rem;
        }

        /* --- Navbar Styles (Existing) --- */
        .navbar {
            position: fixed; top: 0; width: 100%; 
            background: var(--navbar-bg); 
            padding: 1rem 0; z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5); 
            border-bottom: 1px solid var(--border-color);
            backdrop-filter: blur(5px);
        }
        .navbar .container { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }
        .navbar-brand { font-family: 'Orbitron', sans-serif; font-size: 1.8rem; font-weight: 700; color: var(--heading-color); text-shadow: var(--shadow-glow); }
        .nav-links { display: flex; list-style: none; margin: 0; padding: 0; }
        .nav-links li { margin-left: 2rem; }
        .nav-links a { 
            color: var(--text-color); font-weight: 500; font-family: 'Inter', sans-serif; font-size: 1rem;
            text-transform: uppercase; letter-spacing: 0.5px; padding: 0.5rem 0; position: relative; 
        }
        .nav-links .active-link { color: var(--link-color); }
        .nav-links a::after { 
            content: ''; position: absolute; width: 0; height: 2px; bottom: 0; left: 0; 
            background: var(--link-color); transition: width 0.3s ease-in-out; 
        }
        .nav-links a:hover::after, .nav-links .active-link::after { width: 100%; }
        
        .hamburger { display: none; flex-direction: column; cursor: pointer; padding: 0.5rem; background: transparent; border: none; }
        .hamburger .bar { 
            width: 25px; height: 3px; background-color: var(--heading-color); margin: 4px 0; transition: 0.4s; box-shadow: none; 
        }
        .hamburger.active .bar:nth-child(2) { opacity: 0; }
        .hamburger.active .bar:nth-child(1) { transform: translateY(7px) rotate(45deg); }
        .hamburger.active .bar:nth-child(3) { transform: translateY(-7px) rotate(-45deg); }
        
        #theme-toggle {
            background: transparent;
            border: 1px solid var(--text-color);
            color: var(--text-color);
            padding: 0.5rem;
            border-radius: 50%;
            cursor: pointer;
            width: 35px;
            height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            margin-left: 1rem;
            font-size: 1.1rem;
        }
        #theme-toggle:hover {
            border-color: var(--link-color);
            color: var(--link-color);
            box-shadow: 0 0 5px var(--link-color);
        }
        .nav-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* --- Footer Styles (Existing) --- */
        .footer {
            background: var(--footer-bg); color: var(--text-color); padding: 4rem 0 2rem; font-size: 0.9rem;
            border-top: 1px solid var(--border-color); text-align: center; position: relative; margin-top: 4rem;
        }
        .footer .container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            text-align: left;
            max-width: 900px;
        }
        .footer .col h4 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }
        .footer ul {
            list-style: none;
            padding: 0;
        }
        .footer li {
            margin-bottom: 0.5rem;
        }
        .footer a {
            color: var(--text-color);
            font-size: 0.9rem;
        }
        .footer a:hover {
            color: var(--link-color);
            text-decoration: none;
        }
        .footer .brand-info {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--link-color);
        }
        .footer .legal-info { 
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
            color: #777; 
        }

        /* --- Single Post Styles --- */
        .post-main { padding-top: 3rem; padding-bottom: 3rem; position: relative; }
        .post-header { border-bottom: 1px solid var(--border-color); padding-bottom: 1.5rem; margin-bottom: 2rem; }
        .post-header .post-tag { 
            display: inline-block; padding: 0.4rem 1rem; background: var(--button-bg); 
            color: var(--button-text-color); font-weight: 700; font-size: 0.85rem; 
            border-radius: 20px; text-transform: uppercase; margin-bottom: 1rem;
            background-image: var(--button-bg); /* Apply gradient */
        }
        .post-meta {
            display: flex; flex-wrap: wrap; gap: 1.5rem; 
            color: rgba(224, 224, 224, 0.7); font-size: 0.95rem; margin-top: 1rem;
        }
        body.light-theme .post-meta { color: #666; }
        .post-meta span { display: flex; align-items: center; gap: 0.5rem; }
        .post-meta i { color: var(--link-color); }
        
        /* REVERTED: Article Image Styles */
        .post-thumbnail-container {
            width: 100%;
            height: 300px;
            overflow: hidden;
            border-radius: 8px;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-glow);
        }
        .post-thumbnail-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .article-content blockquote {
            border-left: 4px solid var(--link-color);
            color: var(--text-color);
            background: var(--card-bg);
            padding: 1.5rem;
            margin: 2rem 0;
            border-radius: 4px;
        }
        
        /* UPDATED: Headline colors */
        .article-content h2 { 
            font-size: 2rem; margin-top: 3rem; margin-bottom: 1rem;
            border-bottom: 2px solid var(--border-color); padding-bottom: 0.5rem;
            color: var(--headline-color);
        }
        .article-content h3 { color: var(--heading-color); font-size: 1.5rem; margin-top: 2rem; }
        .article-content ul, .article-content ol { padding-left: 1.5rem; margin-bottom: 1.5rem; }
        .article-content b { color: var(--cyan-glow); font-weight: 600; }
        body.light-theme .article-content b { color: var(--link-color); }
        
        /* TTS Word Highlighting Style */
        .article-content span.tts-highlight {
            background-color: var(--highlight-color);
            border-radius: 2px;
            padding: 2px 0;
            margin: 0;
            transition: background-color 0.05s;
        }
        body.light-theme .article-content span.tts-highlight {
             background-color: var(--highlight-color);
        }
        
        /* NEW: Button Style */
        .btn-primary {
            background: var(--button-bg); color: var(--button-text-color); border: none;
            padding: 0.8rem 1.5rem; border-radius: 25px; cursor: pointer; font-weight: 700;
            font-family: 'Orbitron', sans-serif; font-size: 1rem; transition: all 0.3s ease;
            text-transform: uppercase;
        }
        .btn-primary:hover { 
            background: var(--button-hover-bg); 
            box-shadow: var(--shadow-glow);
        }
        .btn-primary:disabled { opacity: 0.6; cursor: not-allowed; }


        /* --- NEW AUDIO WIDGET STYLES (Fixed Position, Glowing) --- */
        #audio-widget-container {
            position: fixed;
            bottom: -150px; /* Start off-screen */
            left: 50%;
            transform: translateX(-50%);
            width: min(90%, 500px);
            padding: 1rem;
            background: var(--audio-widget-bg);
            border: 2px solid var(--link-color);
            border-radius: 12px 12px 0 0;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
            z-index: 999;
            transition: bottom 0.5s ease-out;
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        #audio-widget-container.active {
            bottom: 0;
        }
        body.light-theme #audio-widget-container {
            box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.15); 
            border-color: var(--link-color);
        }

        .widget-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        #widget-play-pause-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-size: 1.1rem;
            box-shadow: 0 0 10px var(--cyan-glow);
            animation: pulse-widget 1.5s infinite alternate;
        }
        #widget-play-pause-btn:hover {
            box-shadow: 0 0 15px var(--light-blue-glow);
        }
        @keyframes pulse-widget {
            from { transform: scale(1); }
            to { transform: scale(1.03); }
        }

        .widget-progress-info {
            flex-grow: 1;
        }

        .widget-progress-container {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            cursor: pointer;
        }
        #widget-audio-progress-bar {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, var(--cyan-glow), var(--light-blue-glow));
            border-radius: 4px;
        }
        .widget-time-info {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #aaa;
            margin-top: 0.2rem;
        }
        
        #widget-voice-display {
            font-size: 0.9rem;
            color: var(--text-color);
            font-weight: 600;
        }

        /* Initial "Listen" button */
        #initial-listen-cta {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
        }

        #initial-listen-cta h3 {
            margin-top: 0;
            font-size: 1.5rem;
        }
        #initial-listen-cta select, #initial-listen-cta button {
            margin-top: 1rem;
        }
        
        /* Remove old audio player section */
        .audio-player { display: none !important; }

        /* Form Controls */
        .form-input {
            background: var(--bg-color); border: 1px solid var(--border-color); color: var(--text-color);
            display: block; width: 100%; padding: 0.8rem; margin-bottom: 1rem; border-radius: 4px; box-sizing: border-box;
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
        }
        .form-input:focus { 
            border-color: var(--link-color); 
            box-shadow: 0 0 0 2px rgba(0, 255, 255, 0.3); 
            outline: none;
        }
        textarea.form-input { min-height: 100px; resize: vertical; }

        /* --- COMMENT EDITOR TOOLBAR --- */
        .comment-editor-toolbar {
            display: flex;
            gap: 5px;
            margin-bottom: 0.5rem;
            padding: 5px;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            flex-wrap: wrap;
        }
        .comment-editor-toolbar button {
            background: none;
            border: none;
            color: var(--text-color);
            padding: 0.4rem 0.6rem;
            cursor: pointer;
            border-radius: 4px;
            transition: background 0.2s, color 0.2s;
            line-height: 1;
        }
        .comment-editor-toolbar button:hover {
            background: var(--card-bg);
            color: var(--link-color);
        }
        .comment-editor-toolbar button i {
            font-size: 1rem;
        }


        /* --- Comment Section Styles (Authentication & Likes/Replies) --- */
        .comments-wrapper { 
            margin-top: 4rem;
            padding-top: 2rem; 
            border-top: 1px solid var(--border-color); 
        }
        .comments-wrapper h2 { 
            font-size: 1.8rem;
            margin-bottom: 2rem;
            border-bottom: none;
        }
        
        /* New: Authentication Prompt */
        .auth-prompt {
            background: var(--card-bg);
            border: 1px solid var(--link-color);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 3rem;
            text-align: center;
        }
        .auth-prompt h3 {
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }
        .auth-prompt .guest-comment-link {
            display: block;
            margin-top: 1rem;
            font-size: 0.9rem;
        }

        .comment-form-container {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 3rem;
        }
        .comment-form-container h3 {
            margin-bottom: 1.5rem;
            font-size: 1.4rem;
        }

        .comment {
            background: var(--comment-bg); border: 1px solid var(--border-color);
            display: flex; gap: 1rem; padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        /* NEW: Reply Indentation */
        .comment.reply {
            margin-left: 50px; /* Indent replies */
            border-left: 4px solid var(--link-hover-color); /* Visual distinction */
            margin-top: -0.5rem; /* Reduce vertical spacing between parent and first reply */
            margin-bottom: 1rem;
        }
        
        /* NEW: Styling for the dynamic reply/edit form */
        .reply-form-container {
            margin-top: 1rem;
            padding: 1rem;
            border-top: 1px dashed var(--border-color);
            background: var(--bg-color); /* Use base color for subtle contrast */
            border-radius: 4px;
        }
        .reply-form-container .form-input {
            margin-bottom: 0.5rem;
        }
        
        .comment-avatar { 
            width: 45px; height: 45px; border-radius: 50%; background: var(--link-color); 
            display: flex; align-items: center; justify-content: center; font-size: 1.2rem;
            color: var(--button-text-color); font-weight: 700; flex-shrink: 0;
        }
        .comment-user { 
            font-weight: 600; color: var(--cyan-glow); font-size: 1rem; 
            display: inline-block; margin-bottom: 0.3rem;
        }
        body.light-theme .comment-user { color: var(--link-color); }
        
        /* Standard Verified Badge - Instagram Blue */
        .verified-badge { 
            background: var(--verified-color);
            color: white; 
            margin-left: 5px; 
            font-size: 0.65rem; 
            vertical-align: middle; 
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            line-height: 1;
            transform: translateY(-2px);
        }
        .verified-badge i { font-size: 0.75rem; }
        
        /* NEW: Admin Verified Badge (Glowing Gold/Cyan) */
        .admin-verified-badge {
            background: linear-gradient(45deg, var(--cyan-glow), var(--admin-color));
            color: var(--button-text-color); /* Dark text on bright badge */
            margin-left: 5px;
            font-size: 0.65rem;
            vertical-align: middle;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 17px; /* Slightly larger */
            height: 17px;
            border-radius: 50%;
            line-height: 1;
            transform: translateY(-2px);
            box-shadow: 0 0 5px var(--admin-glow), 0 0 10px var(--cyan-glow);
        }
        body.light-theme .admin-verified-badge {
             box-shadow: none; /* Turn off glow in light mode */
             background: var(--admin-color);
             color: var(--heading-color);
        }
        .admin-verified-badge i { font-size: 0.8rem; }
        
        .admin-badge {
            color: gold; margin-left: 5px; font-size: 0.8rem;
            vertical-align: middle;
        }
        .guest-badge {
            color: #999; margin-left: 5px; font-size: 0.8rem;
            vertical-align: middle;
        }
        .comment-meta {
            font-size: 0.85rem;
            color: #888;
            margin-top: 0.5rem;
        }
        .comment-actions {
            font-size: 0.9rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1rem;
            color: #777;
        }
        .comment-actions button {
            background: none; border: none; color: #777; cursor: pointer;
            transition: color 0.2s; font-family: 'Inter', sans-serif;
            font-size: 0.9rem;
        }
        .comment-actions button:hover {
            color: var(--link-color);
        }
        .comment-actions button:disabled {
            color: #555;
            cursor: not-allowed;
            opacity: 0.6;
        }
        .comment-actions i {
            margin-right: 5px;
        }
        .like-btn.liked {
            color: #E91E63;
        }
        
        .no-comments {
            text-align: center;
            padding: 3rem;
            color: #777;
        }
        
        /* Responsive adjustments (Existing) */
        @media (max-width: 992px) {
            .nav-links {
                display: none;
                flex-direction: column;
                width: 100%;
                background: var(--navbar-bg);
                position: absolute;
                top: 100%;
                left: 0;
                padding: 1rem 0;
                border-top: 1px solid var(--border-color);
            }
            .nav-links.active {
                display: flex;
            }
            .nav-links li {
                margin: 0.5rem 2rem;
            }
            .nav-links a::after { display: none; }
            .hamburger { display: flex; }
            .footer .container { grid-template-columns: repeat(2, 1fr); }
            .footer .col:nth-child(1), .footer .col:nth-child(2) { margin-bottom: 1.5rem; }
            
            #audio-widget-container {
                width: 100%;
                border-left: none;
                border-right: none;
                border-radius: 12px 12px 0 0;
            }
        }

        @media (max-width: 500px) {
            .footer .container { grid-template-columns: 1fr; text-align: center; }
            .footer .col { margin-bottom: 1rem; }
            .comment.reply {
                margin-left: 20px;
            }
        }
    </style>
</head>
<body>
    
    <header class="navbar">
        <div class="container">
            <a href="index.html" class="navbar-brand">Elvion AI</a>
            
            <div class="nav-controls">
                <nav class="nav-links">
                    <li><a href="https://elvionai.github.io/university.html">Digital University</a></li>
                    <li><a href="https://elvionai.github.io/blog.html" class="active-link">Back to Blog</a></li>
                    <li><a href="https://elvionai.github.io/about.html">About Us</a></li>
                </nav>
                <button id="theme-toggle" aria-label="Toggle theme">
                    <i class="fas fa-sun"></i> 
                </button>
                <button class="hamburger" aria-label="Toggle navigation">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>
            </div>
        </div>
    </header>

    <main class="post-main">
        <div class="post-container">

            <header class="post-header">
                <span class="post-tag">Literature</span>
                <h1>10 Must Read Books That Will Change How You Think in 2025</h1>
                <div class="post-meta">
                    <span><i class="fas fa-user-edit"></i> By Philip Smith 
                        <span class="verified-badge" title="Verified Author"><i class="fas fa-check"></i></span>
                    </span>
                    <span><i class="fas fa-calendar-alt"></i> Nov 8, 2025</span>
                    <span id="estimated-time"><i class="fas fa-clock"></i> Calculating read time...</span>
                </div>
            </header>
            
            <div class="post-thumbnail-container">
                <img src="https://i.postimg.cc/brDXVT7J/20251107-195215.jpg" alt="A stack of glowing, mind-changing books on a futuristic table.">
            </div>
            
            <section id="initial-listen-cta">
                <h3>ðŸ”Š Listen to this article</h3>
                <div style="display: flex; gap: 1rem; justify-content: center; align-items: center; max-width: 400px; margin: 0 auto;">
                    <select id="voice-select" class="form-input" style="margin-bottom: 0;">
                        <option value="" disabled selected>Select AI Voice...</option>
                        <option value="https://elvionai.github.io/audios/a7c15128-137b-45e2-aa32-896186d2.MP3" data-duration="648.0">Philadelphia (Female)</option>
                        <option value="https://elvionai.github.io/audios/d75ca648-15e8-43c3-bccb-c736928a.MP3" data-duration="655.0">Funny Daddy (Male)</option>
                    </select>
                    <select id="speed-select" class="form-input" style="margin-bottom: 0;">
                        <option value="1.0">Normal</option>
                        <option value="0.75">0.75x</option>
                        <option value="1.25">1.25x</option>
                        <option value="1.5">1.5x</option>
                    </select>
                </div>
            </section>
            
            <article class="article-content" id="article-content">
                <p>Look, I'm not going to promise that reading these books will make you instantly enlightened or give you a six-pack.</p>
                <p>But what I can tell you is this, these 10 books have a way of sneaking into your brain, setting up camp, and refusing to leave. They'll make you question things you thought you knew, challenge beliefs you didn't even realize you had, and maybe, shift the way you see the world.</p>
                <p>I've spent years collecting books that do more than just entertain. Books that grab you by the shoulders and shake you awake. Books that make you uncomfortable in the best possible way.</p>
                <p>So whether you're trying to become a better thinker, understand yourself more deeply, or just want something meatier than the latest viral TikTok trend, these are the books that will do it.</p>

                <h2>1. Sapiens: A brief history of humankind by Yuval Noah Harari</h2> 
                <p>If you haven't read this yet, where have you been? </p>
                <p>Harari takes you on a wild ride through the entire history of humanity, from when we were just another animal species to now, when we're contemplating AI and Mars colonies. The book explores how Homo sapiens conquered the world, and spoiler alert; it's not because we were the strongest or the smartest. It's because we learned to create and believe in shared myths. Religion, money, nations, they're all collective fictions that allow millions of strangers to cooperate.</p>
                <p>Reading sapiens is like putting on a pair of glasses that lets you see the matrix. You'll never look at money, religion, or politics the same way again.</p>

                <h2>2. Atomic habits by James clear</h2> 
                <p>I know, I know. Everyone and their grandma has recommended this book. But there's a reason for that. It actually works.</p>
                <p>Clear breaks down the science of habit formation in a way that's so simple, you'll wonder why you never thought of it yourself. The book's core message is that tiny changes compound into remarkable results. You don't need massive willpower or dramatic life overhauls. You just need to get 1% better every single day.</p>
                <p>Whether you want to write more, exercise regularly, or finally stop doomscrolling at 2 AMâ€”we're all guilty, this book gives you the blueprint. It's practical, it's actionable, and it doesn't feel like homework. If you only read one self-improvement book this year, make it this one.</p>

                <h2>3. The Power of now by Eckhart Tolle</h2> 
                <p>This book will either change your life or make you roll your eyes so hard you see your brain. There's no in-between.</p>
                <p>Tolle's central idea is deceptively simple, the present moment is all we ever have. The past is gone, the future hasn't happened, and yet we spend 99% of our mental energy dwelling on both. The result? Anxiety, depression, and a chronic sense that something's missing.</p>
                <p>It teaches you how to quiet the constant chatter in your head and actually experience life as it's happening. It's part philosophy, part meditation guide, and entirely mind-bending. Yes, it can get a little awkward. But if you can get past that, you might just find the peace you've been searching for.</p>

                <h2>4. Thinking, fast and slow by Daniel Kahneman</h2> 
                <p>Want to understand why you make terrible decisions? Read this book.</p>
                <p>Nobel Prize-winning psychologist Daniel Kahneman breaks down how our brains work using two systems. System 1, fast, intuitive, emotional. And System 2, slow, deliberate, logical. Most of the time, system one is running the show, which is great for survival but terrible for making rational choices.</p>
                <p>This book will teach you about cognitive biases you didn't even know you had. Why do you trust your gut even when it's wrong? Why do you overestimate your abilities? Why do you make the same mistakes over and over? Kahneman explains it all with decades of research. It's dense, it's challenging, but it's absolutely worth it. You'll never trust your brain the same way again.</p>

                <h2>5. 1984 by George Orwell</h2> 
                <p>If you read this before and thought it was just some boring dystopian novel, it's time for a re-read.</p>
                <p>In 2025, with surveillance cameras everywhere, social media tracking your every move, and governments rewriting history in real-time, 1984 hits different.</p>
                <p>Orwell's vision of a totalitarian society where Big brother watches everything, the government controls truth, and independent thought is a crime feels less like fiction and more like a documentary.</p>
                <p>The scariest part? Orwell wrote this in 1949. How did he know? The book forces you to ask uncomfortable questions about freedom, privacy, and how much control we're willing to give up for the illusion of security.</p>
                <p>Additionally, it makes me feel that creatives see the future. I mean, Michael Jackson's "We've already had enough" excellently aligns with the dilemmas different countries are facing. Give that song a listen and come back to this post.</p>

                <h2>6. Man's search for meaning by Viktor Frankl</h2> 
                <p>This book will break your heart and then put it back together.</p>
                <p>Viktor Frankl was a psychiatrist and holocaust survivor who spent years in Nazi concentration camps. In this book, he shares his experiences and the psychological insights he gained from the most horrific circumstances imaginable. His central thesis? Those who have a "why" to live can bear almost any "how."</p>
                <p>Frankl argues that meaning, not happiness or pleasure, is what makes life worth living. And you can find meaning even in suffering. It's a profound, humbling read that puts your own problems into stark perspective. If you're feeling lost, stuck, or like life doesn't make sense, this book might just save you.</p>

                <h2>7. The alchemist by Paulo Coelho</h2> 
                <p>This book is either your new life philosophy or overhyped nonsense, depending on who you ask.</p>
                <p>It's a simple story about a shepherd boy named Santiago who goes on a journey to find treasure and ends up discovering himself. The Alchemist is about following your dreams, listening to your heart, and trusting that the universe will conspire to help you achieve your "personal legend."</p>
                <p>Is it a little cheesy? Sure. Does it rely heavily on mysticism and fate? Absolutely. But there's something undeniably powerful about the book's message. The treasure you seek is often not where you think it is, and the journey matters more than the destination.</p>
                <p>It's short, beautifully written, and the kind of book that either speaks to your soul or makes you cringe. Only one way to find out.</p>

                <h2>8. Invisible Women by Caroline Criado Perez</h2> 
                <p>Prepare to get angry. Really, really angry.</p>
                <p>This book exposes the gender data gap, the fact that most of the world is designed by and for men because data about women simply doesn't exist or is ignored.</p>
                <p>From car crash test dummies to medical research to office temperature settings, women are an afterthought.</p>
                <p>Criado Perez meticulously documents how this oversight affects everything from healthcare. Women's heart attacks are often misdiagnosed to economics, unpaid care work is invisible in GDP, to urban planning public transport routes ignore women's travel patterns.</p>
                <p>It's infuriating, it's eye-opening, and it will change how you see the world. Even if you're not a woman, this book is an essential read.</p>

                <h2>9. How to be an antiracist by Ibram X. Kendi</h2> 
                <p>This book will make you uncomfortable. God.</p>
                <p>Kendi argues that it's not enough to simply "not be racist." You have to actively be antiracist, which means identifying and challenging racist policies and ideas, even the ones you didn't realize you held. The book is part memoir, part analysis, and entirely necessary.</p>
                <p>Kendi breaks down the difference between racist ideas and antiracist ideas, showing how even well-meaning people perpetuate systems of inequality.</p>
                <p>It's not about guilt or blame; it's about awareness and action. Whether you agree with everything Kendi says or not, this book will force you to examine your own beliefs and behaviors. And that's the point.</p>

                <h2>10. The body keeps the score by Bessel van der Kolk</h2> 
                <p>If you've ever wondered why you can't just "get over" trauma, this book has answers.</p>
                <p>Van der Kolk, a leading trauma researcher, explains how trauma literally lives in your body, not just your mind. It affects your nervous system, your emotions, your relationships, and your physical health. But here's the good news, healing is possible.</p>
                <p>The book explores various approaches to trauma treatment. Traditional therapy, yoga to EMDR. It's compassionate, thoroughly researched, and offers hope for anyone struggling with past wounds.</p>
                <p>Even if you don't think you've experienced "trauma," this book will deepen your understanding of how our brains and bodies respond to stress. It's heavy, but it's healing.</p>

                <h2>Why these books matter</h2>
                <p>Here's the thing about reading books that challenge you, they're not always fun.</p>
                <p>Sometimes they make you question everything. Sometimes they make you realize you've been wrong about something important. Sometimes they sit heavy in your chest for days after you finish them.</p>
                <p>But that discomfort? That's growth. That's your brain expanding. That's you becoming a more thoughtful, aware, and empathetic human being.</p>
                <p>These 10 books won't give you all the answers. But they'll teach you to ask better questions. They'll show you perspectives you never considered. They'll make you think deeper, feel more, and see the world with fresh eyes.</p>
                <p>So pick one. Hell, pick all ten. Read them slowly. Take notes. Argue with the author in the margins. Let them mess with your head.</p>
                <p>In this era, the best thing you can do is keep learning, keep questioning, and keep growing.</p>
                <p>Your brain will thank you. Even if it complains along the way. Happy reading!</p>
            </article>

            <div style="text-align: center; margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                <a href="https://elvionai.github.io/blog.html" class="btn-primary" role="button">
                    <i class="fas fa-book-reader"></i> Find Your Next Read
                </a>
            </div>

            <section class="comments-wrapper" id="comments">
                <h2>ðŸ’¬ Join the Conversation (<span id="comment-count">0</span> Comments)</h2>

                <div id="auth-prompt" class="auth-prompt">
                    <h3>Join the discussion!</h3>
                    <p>Sign in to post, like, and reply with a verified profile, or comment as a guest.</p>
                    <button id="google-sign-in-btn" class="btn-primary" style="background: #DB4437; background-image: none;">
                        <i class="fab fa-google"></i> Sign in with Google
                    </button>
                    <a href="#" id="guest-comment-link" class="guest-comment-link">Or, comment as a Guest User (No likes/replies)</a>
                    <p id="auth-status" style="margin-top: 1rem; font-size: 0.9rem;"></p>
                </div>
                
                <div class="comment-form-container" id="comment-form-container" style="display: none;">
                    <h3>Leave a Comment As <span id="current-user-name" style="color: var(--link-color);"></span></h3>
                    <form id="comment-form">
                        <div id="guest-name-input" style="display: none; margin-bottom: 1rem;">
                            <label for="guest-name-field" class="form-label">Your Name <span style="color: red;">*</span></label>
                            <input type="text" id="guest-name-field" class="form-input" placeholder="Enter a name to display" required>
                        </div>
                        
                        <div class="comment-editor-toolbar">
                            <button type="button" data-format="bold" aria-label="Bold"><i class="fas fa-bold"></i></button>
                            <button type="button" data-format="italic" aria-label="Italic"><i class="fas fa-italic"></i></button>
                            <button type="button" data-format="link" aria-label="Insert Link"><i class="fas fa-link"></i></button>
                            <button type="button" data-format="blockquote" aria-label="Insert Blockquote"><i class="fas fa-quote-left"></i></button>
                            <span style="margin-left: auto; font-size: 0.9rem; color: #777;">Formatting: **B**, _I_, >Q</span>
                        </div>
                        
                        <div>
                            <label for="comment-input-text" class="form-label">Share your thoughts <span style="color: red;">*</span></label>
                            <textarea id="comment-input-text" class="form-input" placeholder="What did you think? Use the toolbar above for formatting!" required></textarea>
                        </div>
                        <button type="submit" id="comment-button" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Post Comment
                        </button>
                    </form>
                </div>

                <div id="comment-list-container">
                    <div id="comment-list">
                        <p class="loading-message" style="text-align: center; color: #777;">Loading comments...</p>
                    </div>
                </div>

            </section>

        </div>
    </main>

    <div id="audio-widget-container">
        <div id="widget-voice-display">Ready to play.</div>
        <div class="widget-controls">
            <button id="widget-play-pause-btn" class="btn-primary" aria-label="Play audio">
                <i class="fas fa-play"></i>
            </button>
            <div class="widget-progress-info">
                <div class="widget-progress-container" id="widget-progress-container">
                    <div id="widget-audio-progress-bar"></div>
                </div>
                <div class="widget-time-info">
                    <span id="widget-current-time">0:00</span>
                    <span id="widget-duration">0:00</span>
                </div>
            </div>
            <button id="widget-close-btn" class="btn-primary" style="background: #dc3545; background-image: none; width: 45px; height: 45px; border-radius: 50%; padding: 0;" aria-label="Close audio player">
                <i class="fas fa-times"></i>
            </button>
        </div>
    </div>


    <footer class="footer">
        <div class="container">
            <div class="col">
                <span class="brand-info">Elvion AI</span>
                <p>Where Assistance Meets Excellence.</p>
            </div>
            <div class="col">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="https://elvionai.github.io/index.html#hero">Home</a></li>
                    <li><a href="https://elvionai.github.io/blog.html">Blog</a></li>
                    <li><a href="https://elvionai.github.io/university.html">University</a></li>
                </ul>
            </div>
            <div class="col">
                <h4>Company</h4>
                <ul>
                    <li><a href="https://elvionai.github.io/about.html">About Us</a></li>
                    <li><a href="mailto:contact@elvionai.com">Contact Us</a></li>
                </ul>
            </div>
            <div class="col">
                <h4>Legal</h4>
                <ul>
                    <li><a href="https://elvionai.github.io/privacy.html">Privacy Policy</a></li>
                    <li><a href="https://elvionai.github.io/terms.html">Terms of Service</a></li>
                </ul>
            </div>
            <div class="legal-info">
                &copy; <span id="current-year-footer"></span> Elvion AI. All rights reserved.
            </div>
        </div>
    </footer>

    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js"></script>
    
    <script>
        // --- THEME TOGGLE & NAV SCRIPT (Existing) ---
        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            const toggleButton = document.getElementById('theme-toggle');
            const hamburger = document.querySelector('.hamburger');
            const navLinks = document.querySelector('.nav-links');

            const savedTheme = localStorage.getItem('theme') || 'dark';

            function applyTheme(theme) {
                if (theme === 'light') {
                    body.classList.add('light-theme');
                    toggleButton.innerHTML = '<i class="fas fa-moon"></i>';
                } else {
                    body.classList.remove('light-theme');
                    toggleButton.innerHTML = '<i class="fas fa-sun"></i>';
                }
                localStorage.setItem('theme', theme);
            }

            applyTheme(savedTheme);

            toggleButton.addEventListener('click', () => {
                const currentTheme = body.classList.contains('light-theme') ? 'light' : 'dark';
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                applyTheme(newTheme);
            });

            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                navLinks.classList.toggle('active');
            });
            navLinks.querySelectorAll('a').forEach(link => {
                link.addEventListener('click', () => {
                    if (window.innerWidth <= 992) {
                        hamburger.classList.remove('active');
                        navLinks.classList.remove('active');
                    }
                });
            });

            document.getElementById('current-year-footer').textContent = new Date().getFullYear();
        });
    </script>
    
    <script>
        // --- WORD-FOR-WORD TEXT TO SPEECH SCRIPT (STABLE VERSION) ---
        document.addEventListener('DOMContentLoaded', () => {
            const voiceSelect = document.getElementById('voice-select');
            const speedSelect = document.getElementById('speed-select');
            const articleContent = document.getElementById('article-content');
            const estimatedTimeEl = document.getElementById('estimated-time');
            
            // Widget Elements
            const widgetContainer = document.getElementById('audio-widget-container');
            const widgetPlayPauseBtn = document.getElementById('widget-play-pause-btn');
            const widgetCloseBtn = document.getElementById('widget-close-btn');
            const widgetProgressBar = document.getElementById('widget-audio-progress-bar');
            const widgetProgressContainer = document.getElementById('widget-progress-container');
            const widgetCurrentTimeEl = document.getElementById('widget-current-time');
            const widgetDurationEl = document.getElementById('widget-duration');
            const widgetVoiceDisplay = document.getElementById('widget-voice-display');

            // Data
            const WPM = 200; 
            let ALL_WORD_SPANS = []; 
            let TOTAL_WORD_COUNT = 0;
            
            let audio = new Audio();
            let isPlaying = false;
            let currentWordIndex = -1;
            let currentTTSDuration = 0; 
            let wordTimings = []; 

            // --- 1. Content Processing: Dynamic Span Injection (CRITICAL FOR HIGHLIGHTING) ---
            
            function processNode(node) {
                if (node.nodeType === 3) { // Text node
                    const text = node.textContent;
                    if (text.trim().length > 0) {
                        // Regex to wrap non-whitespace sequences in span
                        return text.replace(/([^\s]+)/g, '<span class="word-content">$&</span>');
                    }
                    return text; // Return original if just whitespace
                } else if (node.nodeType === 1) { // Element node (e.g., <b>, <i>, <a>, <h2>, <li>)
                    // Recurse for elements, re-creating the structure and processing children
                    const clone = node.cloneNode(false); // Clone the element tag, but not its children
                    let newContent = '';
                    Array.from(node.childNodes).forEach(child => {
                        newContent += processNode(child);
                    });
                    clone.innerHTML = newContent; // Update the cloned element's content
                    return clone.outerHTML; // Return the full element HTML
                }
                return '';
            }

            function wrapWordsInSpans(element) {
                // Target all structural elements that contain readable text
                const elementsToScan = element.querySelectorAll('p, li, blockquote, h2, h3');
                
                elementsToScan.forEach(el => {
                    let newHtml = '';
                    Array.from(el.childNodes).forEach(node => {
                        newHtml += processNode(node);
                    });
                    el.innerHTML = newHtml;
                });
                
                // Final Recalculation after DOM manipulation
                ALL_WORD_SPANS = Array.from(articleContent.querySelectorAll('.word-content'));
                TOTAL_WORD_COUNT = ALL_WORD_SPANS.length;
                calculateReadTime();
            }

            function formatTime(seconds) {
                const min = Math.floor(seconds / 60);
                const sec = Math.floor(seconds % 60);
                return `${min}:${sec.toString().padStart(2, '0')}`;
            }
            
            function calculateReadTime() {
                const readTimeMinutes = Math.ceil(TOTAL_WORD_COUNT / WPM);
                estimatedTimeEl.innerHTML = `<i class="fas fa-clock"></i> ${readTimeMinutes} min read`;
            }
            
            function generateWordTimings(duration) {
                if (TOTAL_WORD_COUNT === 0 || duration === 0) return [];

                const averageWordTime = duration / TOTAL_WORD_COUNT;
                const timings = [];
                let currentTime = 0;

                for (let i = 0; i < TOTAL_WORD_COUNT; i++) {
                    const wordDuration = averageWordTime;
                    const endTime = currentTime + wordDuration;

                    timings.push({
                        start: currentTime,
                        end: endTime,
                        index: i
                    });
                    currentTime = endTime;
                }
                return timings;
            }
            
            // --- 2. Player Controls & Highlighting ---
            
            function removeHighlighting() {
                ALL_WORD_SPANS.forEach(span => span.classList.remove('tts-highlight'));
            }
            
            function updateWidgetDisplay() {
                 widgetContainer.classList.add('active');
                 const selectedOption = voiceSelect.options[voiceSelect.selectedIndex];
                 widgetVoiceDisplay.textContent = selectedOption.text;
            }

            function resetPlayer() {
                isPlaying = false;
                widgetPlayPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                widgetPlayPauseBtn.setAttribute('aria-label', 'Play audio');
                audio.pause();
                audio.currentTime = 0; 
                widgetProgressBar.style.width = '0%';
                widgetCurrentTimeEl.textContent = '0:00';
                removeHighlighting();
                currentWordIndex = -1;
            }
            
            function seekAudio(event) {
                if (!audio.src || isNaN(audio.duration) || audio.duration === 0) return;
                const rect = widgetProgressContainer.getBoundingClientRect();
                const clickX = event.clientX - rect.left;
                const width = rect.width;
                const seekTime = (clickX / width) * audio.duration;
                audio.currentTime = seekTime;
                
                highlightWordByTime(seekTime);
            }
            
            function highlightWordByTime(time) {
                if (wordTimings.length === 0) return;

                const targetWord = wordTimings.find(t => time >= t.start && time < t.end);
                
                let targetIndex = targetWord ? targetWord.index : -1;
                
                if (time >= currentTTSDuration) {
                    targetIndex = -1;
                }

                if (targetIndex !== currentWordIndex) {
                    removeHighlighting();
                    currentWordIndex = targetIndex;
                    
                    if (currentWordIndex >= 0 && currentWordIndex < ALL_WORD_SPANS.length) {
                        const wordSpan = ALL_WORD_SPANS[currentWordIndex];
                        wordSpan.classList.add('tts-highlight');
                        
                        const parentEl = wordSpan.closest('p, li, blockquote, h2, h3');
                        if (parentEl) {
                            const rect = parentEl.getBoundingClientRect();
                            const viewportHeight = window.innerHeight;
                            
                            if (rect.top < viewportHeight * 0.25 || rect.bottom > viewportHeight * 0.75) {
                                parentEl.scrollIntoView({ behavior: 'smooth', block: 'center' });
                            }
                        }
                    }
                }
            }
            
            function updateProgress() {
                if (isNaN(audio.duration) || audio.duration === 0) return;
                const progress = (audio.currentTime / audio.duration) * 100;
                widgetProgressBar.style.width = `${progress}%`;
                widgetCurrentTimeEl.textContent = formatTime(audio.currentTime);
                
                highlightWordByTime(audio.currentTime);
            }

            // --- 3. Event Listeners ---

            voiceSelect.addEventListener('change', () => {
                resetPlayer();
                
                const selectedOption = voiceSelect.options[voiceSelect.selectedIndex];
                const audioSrc = selectedOption.value;
                currentTTSDuration = parseFloat(selectedOption.dataset.duration || 0);

                if (audioSrc && currentTTSDuration > 0) {
                    audio.src = audioSrc;
                    wordTimings = generateWordTimings(currentTTSDuration);

                    widgetDurationEl.textContent = formatTime(currentTTSDuration);
                    updateWidgetDisplay(); 
                    audio.playbackRate = parseFloat(speedSelect.value);

                    widgetVoiceDisplay.textContent = `Ready: ${selectedOption.text}`;
                } else {
                    widgetContainer.classList.remove('active');
                }
            });
            
            speedSelect.addEventListener('change', () => {
                audio.playbackRate = parseFloat(speedSelect.value);
                if(isPlaying) {
                    widgetVoiceDisplay.textContent = `${voiceSelect.options[voiceSelect.selectedIndex].text} @ ${speedSelect.value}x speed...`;
                }
            });

            widgetPlayPauseBtn.addEventListener('click', () => {
                if (!audio.src) return;
                
                if (!isPlaying) {
                    isPlaying = true;
                    audio.play().catch(e => console.error("Audio play failed:", e));
                    widgetPlayPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                    widgetPlayPauseBtn.setAttribute('aria-label', 'Pause audio');
                    widgetVoiceDisplay.textContent = `${voiceSelect.options[voiceSelect.selectedIndex].text} @ ${audio.playbackRate}x speed...`;
                } else {
                    isPlaying = false;
                    audio.pause();
                    widgetPlayPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                    widgetPlayPauseBtn.setAttribute('aria-label', 'Play audio');
                    widgetVoiceDisplay.textContent = "Paused";
                }
            });
            
            widgetCloseBtn.addEventListener('click', () => {
                resetPlayer();
                widgetContainer.classList.remove('active');
                voiceSelect.selectedIndex = 0;
            });

            widgetProgressContainer.addEventListener('click', seekAudio);
            
            audio.addEventListener('loadedmetadata', () => {
                if (audio.duration && currentTTSDuration === 0) {
                    currentTTSDuration = audio.duration;
                    widgetDurationEl.textContent = formatTime(audio.duration);
                    wordTimings = generateWordTimings(currentTTSDuration);
                }
            });
            
            audio.addEventListener('timeupdate', updateProgress);
            
            audio.onended = () => {
                resetPlayer();
                widgetVoiceDisplay.textContent = "Finished reading.";
            };
            
            // Initial load: Process content first
            wrapWordsInSpans(articleContent);
        });
    </script>
    
    <script>
        // --- COMMENT EDITOR TOOLBAR LOGIC ---
        document.addEventListener('DOMContentLoaded', () => {
            // Expose formatting function globally for use by the generic toolbar listener
            window.applyFormatting = (textarea, format) => {
                const start = textarea.selectionStart;
                const end = textarea.selectionEnd;
                const value = textarea.value;
                const selectedText = value.substring(start, end);
                let formattedText = selectedText;
                let wrap = '';

                switch (format) {
                    case 'bold':
                        wrap = '**';
                        formattedText = wrap + selectedText + wrap;
                        break;
                    case 'italic':
                        wrap = '_';
                        formattedText = wrap + selectedText + wrap;
                        break;
                    case 'blockquote':
                        wrap = '>';
                        // Ensure blockquote starts on a new line and formats multiple lines
                        const prefix = (start > 0 && value[start - 1] !== '\n') ? '\n' : '';
                        formattedText = prefix + wrap + ' ' + selectedText.replace(/\n/g, '\n> ');
                        break;
                    case 'link':
                        const linkUrl = prompt("Enter URL:", "https://");
                        if (linkUrl) {
                            const linkText = selectedText || "link text";
                            formattedText = `[${linkText}](${linkUrl})`;
                        } else {
                            return;
                        }
                        break;
                }

                textarea.value = value.substring(0, start) + formattedText + value.substring(end);
                textarea.focus();
                
                // Cursor/Selection positioning logic
                if (wrap && selectedText === "") {
                    // Place cursor inside the new wrap markers for B/I/Q
                    textarea.selectionStart = start + wrap.length + (format === 'blockquote' ? 1 : 0);
                    textarea.selectionEnd = start + wrap.length + (format === 'blockquote' ? 1 : 0);
                } else if (wrap || format === 'link') {
                    // Select the newly formatted text
                    textarea.selectionStart = start;
                    textarea.selectionEnd = start + formattedText.length;
                }
            };
            
            document.querySelectorAll('.comment-editor-toolbar button').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const format = e.currentTarget.dataset.format;
                    const formContainer = e.currentTarget.closest('.comment-form-container') || e.currentTarget.closest('.reply-form-container');
                    
                    let textarea;
                    if (formContainer.id === 'comment-form-container') {
                         textarea = document.getElementById('comment-input-text');
                    } else if (formContainer) {
                         textarea = formContainer.querySelector('textarea');
                    }
                    
                    if (textarea && window.applyFormatting) {
                        window.applyFormatting(textarea, format);
                    }
                });
            });
        });
    </script>


    <script type="module">
        // --- FIREBASE/COMMENT SCRIPT ---
        
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
        import { getAuth, GoogleAuthProvider, signInWithPopup, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
        import { 
            getFirestore, collection, addDoc, query, where, 
            onSnapshot, doc, arrayUnion, arrayRemove, runTransaction, serverTimestamp, 
            setDoc, deleteDoc, getDoc 
        } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

        // --- 0. CONFIG & INITIALIZATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyAyROm0aBGjry6NUfhNM3e0qwPcCDoIqSk",
            authDomain: "elvionai.firebaseapp.com",
            projectId: "elvionai",
            storageBucket: "elvionai.firebasestorage.app",
            messagingSenderId: "161078300830",
            appId: "1:161078300830:web:f460df8591704eb0e96b8f"
        };
        
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const ARTICLE_ID = 'must-read-books-03'; // CORRECT ARTICLE ID
        
        const ADMIN_EMAIL = 'koladhino@gmail.com'; 

        // --- 1. DOM Elements (omitted for brevity, assume linked correctly) ---
        const commentForm = document.getElementById('comment-form');
        const commentTextInput = document.getElementById('comment-input-text');
        const commentList = document.getElementById('comment-list');
        const commentCountEl = document.getElementById('comment-count');
        const submitBtn = document.getElementById('comment-button');
        const authPrompt = document.getElementById('auth-prompt');
        const commentFormContainer = document.getElementById('comment-form-container');
        const googleSignInBtn = document.getElementById('google-sign-in-btn');
        const currentUserNameEl = document.getElementById('current-user-name');
        const guestCommentLink = document.getElementById('guest-comment-link');
        const guestNameInputDiv = document.getElementById('guest-name-input');
        const guestNameField = document.getElementById('guest-name-field');
        
        let currentUser = null;
        let isGuestMode = false;
        let currentReplyToId = null; 

        // --- 2. Authentication & Guest Logic (SetAuthState now checks Admin status) ---
        
        function setAuthState(user) {
            currentUser = user;
            
            document.querySelectorAll('.reply-form-container').forEach(el => el.remove());
            currentReplyToId = null; 

            if (user) {
                isGuestMode = false;
                authPrompt.style.display = 'none';
                commentFormContainer.style.display = 'block';
                currentUserNameEl.textContent = user.displayName || user.email;
                guestNameInputDiv.style.display = 'none';
                guestNameField.removeAttribute('required');
                guestNameField.value = ''; 
            } else {
                if (!isGuestMode) {
                    authPrompt.style.display = 'block';
                    commentFormContainer.style.display = 'none';
                    currentUserNameEl.textContent = 'Guest';
                    guestNameInputDiv.style.display = 'none';
                } else {
                    authPrompt.style.display = 'none';
                    commentFormContainer.style.display = 'block';
                    currentUserNameEl.textContent = 'Guest User';
                    guestNameInputDiv.style.display = 'block';
                    guestNameField.setAttribute('required', 'required');
                }
            }
            loadComments(); 
        }

        guestCommentLink.addEventListener('click', (e) => {
            e.preventDefault();
            isGuestMode = true;
            setAuthState(null); 
            guestNameField.focus();
        });

        googleSignInBtn.addEventListener('click', async () => {
            const provider = new GoogleAuthProvider();
            try {
                await signInWithPopup(auth, provider);
            } catch (error) {
                console.error("Google Sign-In Error:", error);
            }
        });
        
        onAuthStateChanged(auth, user => {
            setAuthState(user);
        });

        // --- 3. Comment Display & Actions (Updated for Admin Delete) ---
        
        function createCommentElement(comment) {
            const div = document.createElement('div');
            div.className = 'comment';

            if (comment.parentId) {
                div.classList.add('reply');
            }
            
            const userName = escapeHtml(comment.userName) || 'Anonymous';
            const initial = userName.charAt(0).toUpperCase();
            
            let timestampString;
            if (comment.timestamp && typeof comment.timestamp.toDate === 'function') {
                timestampString = new Date(comment.timestamp.toDate()).toLocaleString();
            } else if (comment.timestamp) {
                const date = comment.timestamp || new Date(); 
                timestampString = date instanceof Date ? date.toLocaleString() : 'Just now';
            } else {
                timestampString = 'Pending...';
            }
            
            let badge = '';
            const isAdmin = currentUser && currentUser.email === ADMIN_EMAIL;
            
            if (comment.userEmail === ADMIN_EMAIL) {
                 // NEW: Apply glowing admin badge
                 badge = '<span class="admin-verified-badge" title="Verified Admin"><i class="fas fa-crown"></i></span>';
            } else if (comment.userId && comment.userId !== 'guest') {
                // Standard Verified Badge
                badge = '<span class="verified-badge" title="Verified User"><i class="fas fa-check"></i></span>';
            } else {
                badge = '<span class="guest-badge" title="Guest User"><i class="fas fa-user-tag"></i> Guest</span>';
            }
            
            const isLiked = currentUser && !isGuestMode && comment.likes && comment.likes.includes(currentUser.uid);
            const likeCount = comment.likes ? comment.likes.length : 0;
            
            const canPerformAction = currentUser && !isGuestMode; 
            const actionDisabled = !canPerformAction; 
            
            // Can modify if they are the poster OR if the current user is an Admin
            const canModify = (currentUser && comment.userId === currentUser.uid) || isAdmin;
            const canDelete = canModify; // Admin can delete anyone's comment. User can delete their own.

            const processedText = formatCommentText(comment.text);
            
            div.innerHTML = `
                <div class="comment-avatar">${initial}</div>
                <div class="comment-content" style="flex-grow: 1;" data-comment-id="${comment.id}">
                    <span class="comment-user">${userName}</span>${badge}
                    ${comment.editedAt ? '<span class="guest-badge" style="margin-left: 5px;">(edited)</span>' : ''}
                    <p class="comment-text">${processedText}</p>
                    <div class="comment-meta">ðŸ• ${timestampString}</div>
                    <div class="comment-actions">
                        <button class="like-btn ${isLiked ? 'liked' : ''}" data-comment-id="${comment.id}" ${actionDisabled ? 'disabled' : ''}>
                            <i class="${isLiked ? 'fas' : 'far'} fa-heart"></i> 
                            <span>Like</span> (<span class="like-count">${likeCount}</span>)
                        </button>
                        <button class="reply-btn" data-comment-id="${comment.id}" ${actionDisabled ? 'disabled' : ''}>
                            <i class="fas fa-reply"></i> Reply
                        </button>
                        ${canModify ? `<button class="edit-btn" data-comment-id="${comment.id}"><i class="fas fa-edit"></i> Edit</button>` : ''}
                        ${canDelete ? `<button class="delete-btn" data-comment-id="${comment.id}" style="color: #dc3545;"><i class="fas fa-trash-alt"></i> Delete</button>` : ''}
                    </div>
                    
                    </div>
            `;
            
            // Add listeners for actions
            const likeBtn = div.querySelector('.like-btn');
            if (likeBtn && !actionDisabled) {
                likeBtn.addEventListener('click', () => toggleLike(comment.id, likeBtn));
            }
            
            const editBtn = div.querySelector('.edit-btn');
            if (editBtn) {
                editBtn.addEventListener('click', () => handleEditButtonClick(comment.id, comment.text));
            }
            
            const deleteBtn = div.querySelector('.delete-btn');
            if (deleteBtn) {
                deleteBtn.addEventListener('click', () => deleteComment(comment.id));
            }
            
            return div;
        }

        function renderComments(comments) {
            commentList.innerHTML = '';
            
            const topLevelComments = comments.filter(c => !c.parentId);
            const repliesByParentId = comments
                .filter(c => c.parentId)
                .reduce((acc, reply) => {
                    acc[reply.parentId] = acc[reply.parentId] || [];
                    acc[reply.parentId].push(reply);
                    return acc;
                }, {});

            topLevelComments.forEach(comment => {
                const topEl = createCommentElement(comment);
                commentList.appendChild(topEl);
                
                const replyBtn = topEl.querySelector('.reply-btn');
                if (replyBtn) {
                     replyBtn.addEventListener('click', (e) => handleReplyButtonClick(e));
                }

                const replies = repliesByParentId[comment.id] || [];
                replies.forEach(reply => {
                    const replyEl = createCommentElement(reply);
                    commentList.appendChild(replyEl); 
                    
                    const nestedReplyBtn = replyEl.querySelector('.reply-btn');
                    if (nestedReplyBtn) {
                        nestedReplyBtn.addEventListener('click', (e) => handleReplyButtonClick(e));
                    }
                });
            });

            if (comments.length === 0) {
                commentList.innerHTML = `
                    <div class="no-comments">
                        <i class="fas fa-comments" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem; display: block;"></i>
                        <p>No comments yet. Be the first to share your thoughts! ðŸŒŸ</p>
                    </div>
                `;
            }
        }


        function loadComments() {
             const q = query(collection(db, 'comments'), 
                             where('articleId', '==', ARTICLE_ID));

             commentList.innerHTML = `<p class="loading-message" style="text-align: center; color: #777;">Loading comments...</p>`;


             onSnapshot(q, (snapshot) => {
                    commentList.innerHTML = ''; 
                    
                    if (snapshot.empty) {
                        commentList.innerHTML = `
                            <div class="no-comments">
                                <i class="fas fa-comments" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem; display: block;"></i>
                                <p>No comments yet. Be the first to share your thoughts! ðŸŒŸ</p>
                            </div>
                        `;
                        commentCountEl.textContent = '0';
                        return;
                    }

                    commentCountEl.textContent = snapshot.size;
                    
                    const sortedDocs = snapshot.docs.sort((a, b) => {
                        const timeA = a.data().timestamp;
                        const timeB = b.data().timestamp;
                        
                        const dateA = timeA && timeA.toDate ? timeA.toDate() : new Date(0); 
                        const dateB = timeB && timeB.toDate ? timeB.toDate() : new Date(0);
                        
                        return dateB - dateA; // Sort descending (newest first)
                    });

                    const comments = sortedDocs.map(doc => ({ id: doc.id, ...doc.data() }));
                    renderComments(comments); 

                }, error => {
                    console.error("Error loading comments:", error);
                    commentList.innerHTML = `<p class="loading-message" style="color: red;">Failed to load comments. (Check Firestore Security Rules)</p>`;
                });
        }
        
        // --- 4. Comment Submission & Actions ---

        commentForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!currentUser && !isGuestMode) {
                console.warn('User must sign in or choose to comment as a Guest!');
                return;
            }

            const commentText = commentTextInput.value.trim();

            if (!commentText) {
                console.warn('Comment text is empty.');
                return;
            }

            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Posting...';

            let commentData = {};

            if (isGuestMode) {
                const guestName = guestNameField.value.trim();
                if (!guestName) {
                    submitBtn.disabled = false;
                    submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Post Comment';
                    return;
                }
                commentData = {
                    articleId: ARTICLE_ID,
                    userId: 'guest', 
                    userName: guestName,
                    userEmail: '', 
                    text: commentText,
                    timestamp: serverTimestamp(), 
                    likes: [] 
                };
            } else {
                commentData = {
                    articleId: ARTICLE_ID,
                    userId: currentUser.uid,
                    userName: currentUser.displayName || currentUser.email.split('@')[0],
                    userEmail: currentUser.email,
                    text: commentText,
                    timestamp: serverTimestamp(), 
                    likes: [] 
                };
            }

            try {
                await addDoc(collection(db, 'comments'), commentData);

                commentTextInput.value = '';
                guestNameField.value = ''; 

                if (isGuestMode) {
                    isGuestMode = false; 
                    setAuthState(auth.currentUser); 
                }

            } catch (error) {
                console.error('Error posting comment:', error);
            } finally {
                submitBtn.disabled = false;
                submitBtn.innerHTML = '<i class="fas fa-paper-plane"></i> Post Comment';
            }
        });

        async function toggleLike(commentId, button) {
             if (!currentUser || isGuestMode) return;
             
             const commentRef = doc(db, 'comments', commentId);
             const userId = currentUser.uid;
             
             try {
                 await runTransaction(db, async (transaction) => {
                     const docSnapshot = await transaction.get(commentRef);
                     if (!docSnapshot.exists()) {
                         throw "Comment does not exist!";
                     }
                     
                     const data = docSnapshot.data();
                     const likes = data.likes || [];
                     const isCurrentlyLiked = likes.includes(userId);
                     
                     if (isCurrentlyLiked) {
                         transaction.update(commentRef, {
                             likes: arrayRemove(userId)
                         });
                     } else {
                         transaction.update(commentRef, {
                             likes: arrayUnion(userId)
                         });
                     }
                 });
             } catch (error) {
                 console.error("Transaction failed:", error);
             }
        }
        
        // NEW: Handler for dynamically created reply forms submission
        async function handleReplySubmit(e) {
            e.preventDefault();
            if (!currentUser || isGuestMode) return;

            const form = e.target;
            const parentId = form.dataset.parentId;
            const textarea = form.querySelector('textarea');
            const replyText = textarea.value.trim();
            const submitButton = form.querySelector('.btn-primary');

            if (!replyText) return;

            submitButton.disabled = true;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Posting...';
            
            const replyData = {
                articleId: ARTICLE_ID,
                userId: currentUser.uid,
                userName: currentUser.displayName || currentUser.email.split('@')[0],
                userEmail: currentUser.email,
                text: replyText,
                timestamp: serverTimestamp(),
                likes: [],
                parentId: parentId 
            };

            try {
                await addDoc(collection(db, 'comments'), replyData);
            } catch (error) {
                console.error('Error posting reply:', error);
            } finally {
                form.closest('.reply-form-container').remove(); 
                currentReplyToId = null;
            }
        }
        
        // NEW: Function to create the dynamic reply form HTML
        function createReplyFormHtml(parentId) {
            const formContainer = document.createElement('div');
            formContainer.className = 'reply-form-container'; 
            formContainer.innerHTML = `
                <h4 style="font-size: 1.2rem; margin-top: 0; margin-bottom: 0.5rem; color: var(--heading-color);">
                    Replying to a comment as <span style="color: var(--link-color);">${currentUser.displayName || currentUser.email.split('@')[0]}</span>
                </h4>
                
                <div class="comment-editor-toolbar">
                    <button type="button" data-format="bold" aria-label="Bold"><i class="fas fa-bold"></i></button>
                    <button type="button" data-format="italic" aria-label="Italic"><i class="fas fa-italic"></i></button>
                    <button type="button" data-format="link" aria-label="Insert Link"><i class="fas fa-link"></i></button>
                    <button type="button" data-format="blockquote" aria-label="Insert Blockquote"><i class="fas fa-quote-left"></i></button>
                    <span style="margin-left: auto; font-size: 0.9rem; color: #777;">Formatting: **B**, _I_, >Q</span>
                </div>

                <form class="reply-form" data-parent-id="${parentId}">
                    <textarea class="form-input" placeholder="Your reply (Use the toolbar above for formatting!)" required></textarea>
                    <button type="submit" class="btn-primary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                        <i class="fas fa-paper-plane"></i> Post Reply
                    </button>
                    <button type="button" class="btn-cancel-reply btn-primary" style="background: #555; background-image: none; margin-left: 1rem; padding: 0.5rem 1rem; font-size: 0.9rem;">
                        Cancel
                    </button>
                </form>
            `;
            
            const form = formContainer.querySelector('.reply-form');
            const cancelBtn = formContainer.querySelector('.btn-cancel-reply');
            const textarea = formContainer.querySelector('textarea');

            form.addEventListener('submit', handleReplySubmit);
            cancelBtn.addEventListener('click', () => {
                formContainer.remove();
                currentReplyToId = null;
            });

            // Re-apply toolbar listener for the dynamically created form
            formContainer.querySelectorAll('.comment-editor-toolbar button').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const format = e.currentTarget.dataset.format;
                    // Use the existing global formatting logic 
                    if (window.applyFormatting) { 
                        window.applyFormatting(textarea, format);
                    }
                });
            });

            return formContainer;
        }
        
        // NEW: Handler for reply button click
        function handleReplyButtonClick(e) {
            e.preventDefault();
            if (!currentUser || isGuestMode) return; // Guard for unauthenticated users

            const replyBtn = e.currentTarget;
            const parentId = replyBtn.dataset.commentId;

            document.querySelectorAll('.reply-form-container').forEach(el => el.remove());
            
            if (currentReplyToId === parentId) {
                currentReplyToId = null;
                return;
            }

            const formEl = createReplyFormHtml(parentId);
            const commentContentDiv = replyBtn.closest('.comment-content');
            
            if (commentContentDiv) {
                commentContentDiv.appendChild(formEl);
                formEl.querySelector('textarea').focus();
                currentReplyToId = parentId;
            }
        }
        
        // NEW: Function to handle edit button click (shows a new form)
        function handleEditButtonClick(commentId, originalText) {
            document.querySelectorAll('.reply-form-container').forEach(el => el.remove());
            currentReplyToId = null; 

            const commentEl = document.querySelector(`.comment-content[data-comment-id="${commentId}"]`);
            if (!commentEl) return;
            
            const editContainer = document.createElement('div');
            editContainer.className = 'reply-form-container'; 
            editContainer.innerHTML = `
                <h4 style="font-size: 1.2rem; margin-top: 0; margin-bottom: 0.5rem; color: var(--heading-color);">
                    Editing Comment
                </h4>
                <div class="comment-editor-toolbar">
                    <button type="button" data-format="bold" aria-label="Bold"><i class="fas fa-bold"></i></button>
                    <button type="button" data-format="italic" aria-label="Italic"><i class="fas fa-italic"></i></button>
                    <button type="button" data-format="link" aria-label="Insert Link"><i class="fas fa-link"></i></button>
                    <button type="button" data-format="blockquote" aria-label="Insert Blockquote"><i class="fas fa-quote-left"></i></button>
                    <span style="margin-left: auto; font-size: 0.9rem; color: #777;">Formatting: **B**, _I_, >Q</span>
                </div>
                <form class="edit-form" data-parent-id="${commentId}">
                    <textarea class="form-input" required>${originalText}</textarea>
                    <button type="submit" class="btn-primary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">
                        <i class="fas fa-save"></i> Save Changes
                    </button>
                    <button type="button" class="btn-cancel-reply btn-primary" style="background: #555; background-image: none; margin-left: 1rem; padding: 0.5rem 1rem; font-size: 0.9rem;">
                        Cancel
                    </button>
                </form>
            `;
            
            commentEl.appendChild(editContainer);
            const textarea = editContainer.querySelector('textarea');
            textarea.focus();

            editContainer.querySelector('.edit-form').addEventListener('submit', async (e) => {
                e.preventDefault();
                const newText = textarea.value.trim();
                const submitButton = e.target.querySelector('.btn-primary');
                submitButton.disabled = true;
                submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
                await updateComment(commentId, newText);
                editContainer.remove();
            });

            editContainer.querySelector('.btn-cancel-reply').addEventListener('click', () => {
                editContainer.remove();
            });
            
            // Re-apply toolbar listener for the dynamically created form
            editContainer.querySelectorAll('.comment-editor-toolbar button').forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    const format = e.currentTarget.dataset.format;
                    // Use the existing global formatting logic 
                    if (window.applyFormatting) { 
                        window.applyFormatting(textarea, format);
                    }
                });
            });
        }
        
        // NEW: Firestore Update function (for editing)
        async function updateComment(commentId, newText) {
            if (!currentUser) return;
            const commentRef = doc(db, 'comments', commentId);
            
            try {
                await setDoc(commentRef, {
                    text: newText,
                    editedAt: serverTimestamp() 
                }, { merge: true });
            } catch (error) {
                console.error("Error updating comment:", error);
            }
        }

        // NEW: Firestore Delete function (FIXED with getDoc)
        async function deleteComment(commentId) {
            if (!currentUser) {
                 alert("You must be signed in to delete comments.");
                 return;
            }

            const commentRef = doc(db, 'comments', commentId);
            
            try {
                // 1. Check for authorization before proceeding
                const docSnapshot = await getDoc(commentRef); 
                if (!docSnapshot.exists()) {
                    alert("Comment not found.");
                    return;
                }
                
                const commentData = docSnapshot.data();
                const isCommentOwner = currentUser.uid === commentData.userId;
                const isAdmin = currentUser.email === ADMIN_EMAIL;
                
                if (!isCommentOwner && !isAdmin) {
                    alert("You are not authorized to delete this comment.");
                    return;
                }
            } catch (error) {
                 console.error("Error checking delete permissions:", error);
                 alert("Failed to verify user permissions.");
                 return;
            }
            
            if (!confirm("Are you sure you want to delete this comment? This action cannot be undone.")) return;
            
            try {
                // 2. Perform the deletion
                await deleteDoc(commentRef);
            } catch (error) {
                console.error("Error deleting comment:", error);
                alert("Failed to delete comment. Please check your Firestore security rules (if deletion is denied).");
            }
        }


        // --- 5. Utility Functions ---
        
        function escapeHtml(text) {
            if (typeof text !== 'string') return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // UPDATED: Added Blockquote (>) formatting
        function formatCommentText(text) {
            let safeText = escapeHtml(text);
            
            // 1. Format blockquotes: lines starting with >
            safeText = safeText.replace(/(^|\n)(>\s*[^\n]*)+/g, (match) => {
                const lines = match.trim().split('\n').map(line => {
                    // Remove '>' and trim leading space
                    return line.replace(/^[>\s]+/, ''); 
                });
                // Join lines with <br> and wrap in blockquote
                return `<blockquote>${lines.join('<br>')}</blockquote>`;
            });
            
            // 2. Format bold: **text**
            safeText = safeText.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
            // 3. Format italics: _text_
            safeText = safeText.replace(/_(.*?)_/g, '<i>$1</i>');
            // 4. Format links: [text](url)
            safeText = safeText.replace(/\[([^\]]+)\]\((https?:\/\/[^\s\)]+)\)/g, '<a href="$2" target="_blank" rel="noopener noreferrer">$1</a>');
            // 5. Format standalone links (fallback)
            safeText = safeText.replace(/(https?:\/\/[^\s]+)/g, (match) => {
                 if (safeText.includes(`](${match})`)) return match;
                 return `<a href="${match}" target="_blank" rel="noopener noreferrer">${match}</a>`;
            });
            
            // 6. Format remaining line breaks (now only applies outside blockquotes)
            safeText = safeText.replace(/\n/g, '<br>');
            
            return safeText;
        }

        // --- 6. Initialization (Handled by onAuthStateChanged) ---
    </script>
</body>
</html>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
Â  window.dataLayer = window.dataLayer || [];
Â  function gtag(){dataLayer.push(arguments);}
Â  gtag('js', new Date()); 

Â  gtag('config', 'G-J1YTKP10ZX');
</script>
