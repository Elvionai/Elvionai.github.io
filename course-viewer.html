<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Course Viewer | Elvion University</title>
  <meta name="description" content="Learn with interactive courses at Elvion University">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --dark-navy: #00001a;
      --black-bg: #000000;
      --cyan-glow: #00ffff;
      --light-blue-glow: #00aaff;
      --text-color: #e0e0e0;
      --heading-color: #ffffff;
      --gradient-start: #0a1128;
      --gradient-end: #121a30;
      --card-bg: rgba(18, 26, 48, 0.85);
      --border-glow: 0 0 10px var(--cyan-glow), 0 0 20px var(--light-blue-glow);
      --hover-glow: 0 0 15px var(--cyan-glow), 0 0 30px var(--light-blue-glow);
      --button-bg: linear-gradient(45deg, var(--cyan-glow), var(--light-blue-glow));
      --button-text-color: var(--black-bg);
      --star-color: rgba(255, 255, 255, 0.7);
      --sidebar-width: 300px;
      --success-color: #4ade80;
      --warning-color: #fbbf24;
      --error-color: #f87171;
      --primary-color: var(--cyan-glow);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--black-bg);
      color: var(--text-color);
      line-height: 1.7;
      overflow-x: hidden;
      position: relative;
      min-height: 100vh;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Orbitron', sans-serif;
      color: var(--heading-color);
      margin-top: 0;
    }

    /* Stars Animation */
    #stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .star {
      position: absolute;
      background-color: var(--star-color);
      border-radius: 50%;
      opacity: 0;
      animation: twinkle 4s infinite ease-in-out;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0; transform: scale(0.5); }
      50% { opacity: 1; transform: scale(1); }
    }

    /* Main Layout */
    .course-viewer-container {
      display: flex;
      min-height: 100vh;
      position: relative;
      z-index: 1;
    }

    /* Course Sidebar */
    .course-sidebar {
      width: var(--sidebar-width);
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(0, 255, 255, 0.2);
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .course-sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--cyan-glow);
      text-decoration: none;
      font-weight: 600;
      padding: 0.8rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      margin-bottom: 1rem;
    }

    .back-btn:hover {
      background: rgba(0, 255, 255, 0.1);
    }

    .course-info {
      text-align: center;
    }

    .course-icon-large {
      font-size: 3rem;
      color: var(--cyan-glow);
      text-shadow: var(--border-glow);
      margin-bottom: 1rem;
    }

    .course-title {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--heading-color);
    }

    .course-subtitle {
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 1rem;
    }

    .overall-progress {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .progress-label {
      font-size: 0.85rem;
      color: var(--text-color);
      margin-bottom: 0.5rem;
    }

    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--button-bg);
      border-radius: 10px;
      transition: width 0.8s ease;
      box-shadow: 0 0 10px var(--cyan-glow);
    }

    .progress-text {
      font-size: 0.85rem;
      color: var(--cyan-glow);
      font-weight: 600;
    }

    /* Lessons List */
    .lessons-list {
      padding: 1rem 0;
    }

    .lessons-header {
      padding: 0 1.5rem 1rem 1.5rem;
      font-size: 1.1rem;
      color: var(--heading-color);
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .lesson-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .lesson-item:hover {
      background: rgba(0, 255, 255, 0.05);
    }

    .lesson-item.active {
      background: rgba(0, 255, 255, 0.1);
      border-left-color: var(--cyan-glow);
    }

    .lesson-item.completed {
      opacity: 0.8;
    }

    .lesson-status {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      flex-shrink: 0;
    }

    .lesson-status.completed {
      background: var(--success-color);
      color: var(--black-bg);
    }

    .lesson-status.current {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .lesson-status.locked {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-color);
    }

    .lesson-details {
      flex: 1;
    }

    .lesson-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--heading-color);
      margin-bottom: 0.3rem;
    }

    .lesson-duration {
      font-size: 0.8rem;
      color: var(--text-color);
      opacity: 0.7;
    }

    /* Mobile Menu Toggle */
    .mobile-menu-toggle {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 101;
      background: var(--card-bg);
      border: 1px solid var(--cyan-glow);
      border-radius: 8px;
      padding: 0.5rem 0.8rem;
      color: var(--cyan-glow);
      cursor: pointer;
      box-shadow: var(--border-glow);
    }

    /* Content Area */
    .content-area {
      flex: 1;
      margin-left: var(--sidebar-width);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .content-header {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
      padding: 1.5rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .lesson-info h1 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .lesson-meta {
      display: flex;
      gap: 1.5rem;
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .lesson-meta span {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .content-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .action-btn {
      padding: 0.8rem 1.5rem;
      background: var(--button-bg);
      color: var(--button-text-color);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .action-btn:hover {
      box-shadow: var(--border-glow);
      transform: scale(1.05);
    }

    .action-btn.secondary {
      background: transparent;
      border: 2px solid var(--cyan-glow);
      color: var(--cyan-glow);
    }

    .action-btn.secondary:hover {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .action-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 2rem;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    }

    .content-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
      max-width: 900px; /* Fitting to page constraint */
      margin-left: auto;
      margin-right: auto;
    }

    .lesson-content {
      line-height: 1.8;
      font-size: 1.1rem;
    }

    .lesson-content h2 {
      color: var(--cyan-glow);
      margin: 2rem 0 1rem 0;
      font-size: 1.4rem;
    }

    .lesson-content h3 {
      color: var(--heading-color);
      margin: 1.5rem 0 0.8rem 0;
      font-size: 1.2rem;
    }

    .lesson-content p {
      margin-bottom: 1.2rem;
    }

    .lesson-content ul, .lesson-content ol {
      margin: 1rem 0 1rem 2rem;
    }

    .lesson-content li {
      margin-bottom: 0.5rem;
    }
    
    /* Code block styling for practical examples */
    .lesson-content code {
      background: rgba(0, 255, 255, 0.1);
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      color: var(--cyan-glow);
      font-family: 'Courier New', monospace;
    }

    .lesson-content pre {
      background: rgba(0, 0, 0, 0.5);
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid var(--cyan-glow);
      overflow-x: auto;
      margin: 1.5rem 0;
      box-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
      position: relative;
    }

    .lesson-content pre code {
      background: none;
      padding: 0;
      color: var(--text-color);
      display: block;
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* Interactive Code/Markdown Area Simulation */
    .interactive-code-area {
        background: #1e1e2d;
        border: 2px solid var(--primary-color);
        border-radius: 8px;
        padding: 1rem;
        margin: 1.5rem 0;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }
    .interactive-code-area textarea {
        width: 100%;
        min-height: 150px;
        background: transparent;
        color: var(--success-color);
        border: none;
        resize: vertical;
        padding: 0.5rem;
        font-family: 'Courier New', monospace;
        font-size: 1rem;
        outline: none;
    }
    .interactive-code-area .output {
        border-top: 1px dashed rgba(255, 255, 255, 0.2);
        padding-top: 0.5rem;
        color: var(--warning-color);
        font-size: 0.9rem;
        min-height: 30px;
        margin-top: 0.5rem;
    }
    .interactive-code-area .area-header {
        font-size: 0.8rem;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }


    /* Video Player Placeholder */
    .media-player {
      width: 100%;
      height: 400px;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 2rem;
      border: 1px solid rgba(0, 255, 255, 0.2);
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .media-placeholder {
      text-align: center;
      color: var(--text-color);
    }

    .media-placeholder i {
      font-size: 4rem;
      color: var(--cyan-glow);
      margin-bottom: 1rem;
      display: block;
    }

    /* Navigation Controls */
    .lesson-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2rem;
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(0, 255, 255, 0.1);
    }

    .nav-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .lesson-indicator {
      background: rgba(0, 255, 255, 0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .nav-buttons {
      display: flex;
      gap: 1rem;
    }

    /* Quiz/Assessment Styles */
    .quiz-container {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .quiz-question {
      font-size: 1.2rem;
      color: var(--heading-color);
      margin-bottom: 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
      padding-bottom: 1rem;
    }

    .quiz-options {
      display: grid;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .quiz-option {
      padding: 1rem 1.5rem;
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(0, 255, 255, 0.2);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease, transform 0.1s ease; /* Added transform for animation */
      color: var(--text-color);
      position: relative;
    }

    .quiz-option:hover {
      border-color: var(--cyan-glow);
      background: rgba(0, 255, 255, 0.05);
      transform: translateY(-2px); /* Slight hover animation */
    }

    .quiz-option.selected {
      border-color: var(--cyan-glow);
      background: rgba(0, 255, 255, 0.1);
      color: var(--cyan-glow);
    }
    
    /* Correct/Incorrect state styling with simple animation */
    .quiz-option.correct {
      border-color: var(--success-color) !important;
      background: rgba(74, 222, 128, 0.1) !important;
      color: var(--success-color) !important;
      animation: flash-correct 0.3s ease-in-out;
    }

    .quiz-option.incorrect {
      border-color: var(--error-color) !important;
      background: rgba(248, 113, 113, 0.1) !important;
      color: var(--error-color) !important;
      animation: shake 0.3s;
    }
    
    .quiz-option.correct::after {
      content: ' (Correct)';
      color: var(--success-color);
      font-weight: bold;
      margin-left: 10px;
    }
    .quiz-option.incorrect::after {
      content: ' (Incorrect)';
      color: var(--error-color);
      font-weight: bold;
      margin-left: 10px;
    }
    
    @keyframes flash-correct {
        0% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        20%, 60% { transform: translateX(-5px); }
        40%, 80% { transform: translateX(5px); }
    }


    .quiz-feedback {
      padding: 1rem;
      border-radius: 8px;
      margin-top: 1rem;
      display: none;
    }

    .quiz-feedback.correct {
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
      color: var(--success-color);
      display: block;
    }

    .quiz-feedback.incorrect {
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.3);
      color: var(--error-color);
      display: block;
    }
    
    /* Completion Modal Adjustments */
    .completion-modal .completion-icon {
        font-size: 4rem;
        color: var(--success-color);
        text-shadow: 0 0 10px var(--success-color);
        margin-bottom: 1rem;
        animation: pulse 1s infinite alternate;
    }
    
    .completion-modal .points-earned {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--cyan-glow);
        margin: 1.5rem 0;
        padding: 0.5rem 1rem;
        background: rgba(0, 255, 255, 0.1);
        border-radius: 8px;
        display: inline-block;
        border: 1px solid var(--cyan-glow);
    }
    
    @keyframes pulse {
        from { transform: scale(1); opacity: 0.8; }
        to { transform: scale(1.05); opacity: 1; }
    }


    /* Certificate Form & Final Page Styles */
    .final-page-content {
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }
    .certificate-form-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 3rem;
      box-shadow: var(--hover-glow);
      border: 1px solid var(--primary-color);
      text-align: left;
      margin-top: 2rem;
    }
    .certificate-form-card h2 {
      color: var(--success-color);
      text-shadow: 0 0 10px var(--success-color);
      margin-bottom: 1.5rem;
    }
    .certificate-form-card label {
      display: block;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-color);
    }
    .certificate-form-card input[type="text"],
    .certificate-form-card input[type="email"] {
      width: 100%;
      padding: 0.8rem;
      border: 2px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.3);
      color: var(--text-color);
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    .certificate-form-card input:focus {
      border-color: var(--cyan-glow);
      box-shadow: 0 0 5px var(--cyan-glow);
      outline: none;
    }
    .certificate-form-card .submit-btn {
      width: 100%;
      margin-top: 2rem;
    }

    /* Comment Section Styles */
    .comment-section {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 1.5rem;
        margin-top: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .comment-section textarea {
        width: 100%;
        min-height: 100px;
        padding: 1rem;
        border-radius: 8px;
        border: 2px solid rgba(0, 255, 255, 0.3);
        background: rgba(0, 0, 0, 0.5);
        color: var(--text-color);
        font-size: 1rem;
        resize: vertical;
        outline: none;
        transition: border-color 0.3s ease;
    }
    .comment-section textarea:focus {
        border-color: var(--cyan-glow);
        box-shadow: 0 0 5px var(--cyan-glow);
    }
    .comment-section .comment-btn {
        margin-top: 1rem;
        padding: 0.6rem 1.2rem;
        font-weight: 500;
        float: right;
    }

    /* Completion Modal */
    .completion-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .completion-content {
      background: var(--card-bg);
      padding: 3rem;
      border-radius: 15px;
      text-align: center;
      max-width: 500px;
      box-shadow: var(--hover-glow);
      border: 1px solid rgba(0, 255, 255, 0.3);
    }
    
    /* Loading State */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 50vh;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(0, 255, 255, 0.1);
      border-top-color: var(--cyan-glow);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      margin-top: 1rem;
      color: var(--text-color);
      font-size: 1.1rem;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .course-sidebar {
        transform: translateX(-100%);
      }

      .course-sidebar.active {
        transform: translateX(0);
      }

      .content-area {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .main-content {
        padding: 1rem;
        padding-top: 4rem;
      }

      .content-header {
        padding: 1rem;
        flex-direction: column;
        align-items: flex-start;
      }

      .content-actions {
        width: 100%;
        justify-content: stretch;
      }

      .action-btn {
        flex: 1;
        justify-content: center;
      }

      .lesson-navigation {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
      }

      .nav-buttons {
        width: 100%;
        justify-content: stretch;
      }

      .nav-buttons .action-btn {
        flex: 1;
      }
    }

    @media (max-width: 768px) {
      .media-player {
        height: 250px;
      }

      .content-card {
        padding: 1.5rem;
      }

      .completion-content {
        margin: 1rem;
        padding: 2rem;
      }

      .quiz-option {
        padding: 0.8rem 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="stars-container"></div>

  <button class="mobile-menu-toggle" id="mobileMenuToggle">
    <i class="fas fa-bars"></i>
  </button>

  <div class="course-viewer-container">
    <aside class="course-sidebar" id="courseSidebar">
      <div class="course-sidebar-header">
        <a href="studyingatelvion.html" class="back-btn">
          <i class="fas fa-arrow-left"></i>
          Back to Dashboard
        </a>
        
        <div class="course-info">
          <i id="courseIconLarge" class="course-icon-large"></i>
          <h2 id="courseTitle" class="course-title">Loading...</h2>
          <p id="courseSubtitle" class="course-subtitle">Please wait...</p>
          
          <div class="overall-progress">
            <div class="progress-label">Overall Progress</div>
            <div class="progress-bar-container">
              <div id="overallProgressBar" class="progress-bar-fill" style="width: 0%"></div>
            </div>
            <div class="progress-text"><span id="overallProgressText">0% Complete</span></div>
            <div class="progress-text" style="margin-top: 0.5rem;"><i class="fas fa-trophy"></i> Total Points: <span id="totalPointsEarnedSidebar">0</span></div>
          </div>
        </div>
      </div>

      <div class="lessons-list">
        <div class="lessons-header">Course Lessons</div>
        <div id="lessonsContainer">
          </div>
      </div>
    </aside>

    <main class="content-area">
      <div class="loading-container" id="loadingContainer">
        <div class="loading-spinner"></div>
        <p class="loading-text">Loading course content...</p>
      </div>

      <header class="content-header" id="contentHeader" style="display: none;">
        <div class="lesson-info">
          <h1 id="lessonTitle">Lesson Title</h1>
          <div class="lesson-meta">
            <span><i class="fas fa-clock"></i> <span id="lessonDuration">45 min</span></span>
            <span><i class="fas fa-book"></i> Lesson <span id="currentLessonNumber">1</span> of <span id="totalLessons">8</span></span>
            <span><i class="fas fa-star"></i> <span id="lessonPoints">10</span> Points</span>
          </div>
        </div>
        <div class="content-actions">
          <button id="markCompleteBtn" class="action-btn" style="display: none;">
            <i class="fas fa-check"></i>
            Mark Complete
          </button>
        </div>
      </header>

      <section class="main-content" id="mainContent" style="display: none;">
        
        <div id="finalCoursePage" style="display: none;" class="final-page-content">
            <h1 style="color: var(--success-color); text-shadow: var(--hover-glow);">Course Completed!</h1>
            <p class="lead" style="margin-bottom: 2rem;">
                Congratulations! You have completed all lessons and earned your GP! The final step is to request your certificate.
            </p>
            
            <div class="overall-progress" style="margin-bottom: 3rem; background: var(--black-bg); border: 2px solid var(--success-color);">
                <div class="progress-label" style="font-size: 1.1rem; color: var(--success-color);">Your Final Course Grade Point (GP)</div>
                <div class="progress-text" style="font-size: 2rem; color: var(--success-color); font-weight: 800;"><span id="finalTotalPoints">0</span> Points</div>
                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.8;">(Based on 10 points per successfully completed lesson quiz)</p>
            </div>

            <div class="certificate-form-card">
                <h2>Certificate & Project Submission</h2>
                <p style="margin-bottom: 1.5rem; color: var(--warning-color);">
                    To receive your certificate, please fill in your details below. For courses with a project (e.g., Computer Science, Software Engineering, Visual Arts), please **email your Final Project** (as outlined in the last lesson) to: <strong style="color: var(--cyan-glow);">elvionailabs@gmail.com</strong>.
                </p>
                <form id="certificateForm" action="https://formspree.io/f/mldrbpwo" method="post">
                    <input type="hidden" name="_subject" id="formSubject">
                    <input type="hidden" name="Course Completed" id="completedCourseName">
                    <input type="hidden" name="Total Points Earned" id="formTotalPoints">
                    
                    <label for="fullName">Full Name (for Certificate):</label>
                    <input type="text" id="fullName" name="Full Name" required>

                    <label for="email">Email Address (for delivery):</label>
                    <input type="email" id="email" name="Email" required>

                    <label for="studentId">Elvion Student ID (Optional):</label>
                    <input type="text" id="studentId" name="Student ID">

                    <button type="submit" class="action-btn submit-btn">
                        <i class="fas fa-certificate"></i> Request Certificate
                    </button>
                </form>

                <div class="comment-section">
                    <h4>Feedback & Questions</h4>
                    <form>
                        <textarea placeholder="Share your experience, ask a question, or send a thank you note to Elvion!"></textarea>
                        <button type="submit" class="action-btn comment-btn secondary" style="background: var(--dark-navy); color: var(--cyan-glow);">Submit Feedback</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="media-player" id="mediaPlayer">
          <div class="media-placeholder">
            <i class="fas fa-play-circle"></i>
            <p id="mediaPlaceholderText">Video/Media content coming soon</p>
            <p style="font-size: 0.9rem; opacity: 0.7;">For now, please read the lesson content below</p>
          </div>
        </div>

        <div class="content-card">
          <div id="lessonContent" class="lesson-content">
            </div>
        </div>

        <div id="quizContainer" class="quiz-container" style="display: none;">
          <h3 style="margin-bottom: 1.5rem; color: var(--warning-color);"><i class="fas fa-clipboard-check"></i> Mandatory Quiz: Pass to Proceed</h3>
          <p style="margin-bottom: 2rem; border-bottom: 1px solid rgba(0, 255, 255, 0.1); padding-bottom: 1rem;">
            You must correctly answer all questions below before the 'Next' lesson button is enabled.
          </p>
          <div id="quizQuestions">
            </div>
          <button id="submitQuizBtn" class="action-btn" style="width: 100%; margin-top: 2rem;">
            <i class="fas fa-paper-plane"></i> Submit Answers
          </button>
          <div id="quizResult" style="margin-top: 1rem;"></div>
        </div>
      </section>

      <nav class="lesson-navigation" id="lessonNavigation" style="display: none;">
        <div class="nav-info">
          <div class="lesson-indicator">
            Lesson <span id="navCurrentLesson">1</span> of <span id="navTotalLessons">8</span>
          </div>
          <span><i class="fas fa-trophy"></i> GP: <span id="totalPointsEarnedNav">0</span> Points</span>
        </div>
        <div class="nav-buttons">
          <button id="prevLessonBtn" class="action-btn secondary">
            <i class="fas fa-chevron-left"></i>
            Previous
          </button>
          <button id="nextLessonBtn" class="action-btn">
            Next
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </nav>
    </main>
  </div>

  <div id="completionModal" class="completion-modal">
    <div class="completion-content">
      <i class="fas fa-trophy completion-icon"></i>
      <h2 class="completion-title">Lesson Complete!</h2>
      <p class="completion-message">
        Congratulations! You've successfully completed the quiz and this lesson.
      </p>
      <div class="points-earned">
        <i class="fas fa-star"></i>
        You earned <span id="pointsEarned">10</span> points!
      </div>
      <div style="display: flex; gap: 1rem;">
        <button id="continueBtn" class="action-btn" style="flex: 1;">
          Continue Learning
        </button>
        <button id="backToDashboardBtn" class="action-btn secondary" style="flex: 1;">
          Back to Dashboard
        </button>
      </div>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import {
      getFirestore,
      doc,
      getDoc,
      updateDoc
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAyROm0aBGjry6NUfhNM3e0qwPcCDoIqSk",
      authDomain: "elvionai.firebaseapp.com",
      projectId: "elvionai",
      storageBucket: "elvionai.firebasestorage.app",
      messagingSenderId: "161078300830",
      appId: "1:161078300830:web:f460df8591704eb0e96b8f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // --- FALLBACK/DEFAULT LESSON & QUIZ FOR NEW COURSES ---
    const defaultLessonContent = `
        <h2>Welcome to Your Course!</h2>
        <p>This is the first lesson of your course. Here you will learn the foundational concepts.</p>
        <p>This course is designed to provide you with a comprehensive, pre-university foundation in your chosen field. Our learning methodology focuses on practical knowledge and critical thinking.</p>
        
        <h3>Elvion University Philosophy</h3>
        <p>Elvion University is dedicated to **providing free, quality pre-degree knowledge and certificates** to empower future students globally. Your commitment to completing this course is your most valuable credential.</p>
        
        <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-color: var(--warning-color);">
            <div class="area-header" style="color: var(--warning-color);"><span>Course Focus</span></div>
            <p>Please remember to focus on the core concepts of this subject. You will be tested on the content to ensure you grasp the fundamentals before moving to the next lesson.</p>
        </div>
    `;

    const defaultLesson = { 
      id: 1, 
      title: 'Course Introduction', 
      duration: '40 min', 
      content: defaultLessonContent,
      quiz: [
        { type: 'mcq', question: 'What is the main purpose of Elvion University?', options: ['Awarding accredited degrees', 'Providing free pre-degree knowledge and certificates', 'Replacing traditional universities', 'Offering high-cost private education'], answer: 'Providing free pre-degree knowledge and certificates' },
        { type: 'mcq', question: 'How is student progress measured in this course viewer?', options: ['Monthly Exams', 'Lesson by lesson mandatory quizzes', 'Instructor approval only', 'Number of videos watched'], answer: 'Lesson by lesson mandatory quizzes' },
      ]
    };
    
    // Helper to generate default lessons for other courses
    const generateDefaultLessons = (count, coursePrefix, isProject) => {
        return Array(count).fill(0).map((_, i) => {
            let lessonTitle = `Lesson ${i+1}: Introduction to ${coursePrefix} Concepts`;
            let content = defaultLessonContent.replace(/Welcome!|This is the first lesson/g, `Welcome to ${coursePrefix}!`).replace(/Introduction/g, lessonTitle);
            
            if (i === 0) {
                // Keep the original quiz for the first lesson of a new course
                return {
                    ...defaultLesson,
                    id: i + 1,
                    title: `${coursePrefix} ${lessonTitle}`,
                    content: content,
                };
            }
            
            if (i === count - 1) {
                lessonTitle = isProject ? `Lesson ${i+1}: Final Project / Capstone` : `Lesson ${i+1}: Conclusion & Next Steps`;
                content = `<h2>${lessonTitle}</h2>
                    <p>Congratulations on reaching the final lesson of the ${coursePrefix} course!</p>
                    <p>This course's final requirement is a **Project Submission** (if \`isProject\` is true) or a final reflection. Follow the certificate steps on the next page.</p>
                    ${isProject ? `<p style="color: var(--cyan-glow);">**Project Submission Required:** Please check the last lesson for specific instructions and remember to **email your project to elvionailabs@gmail.com**.</p>` : ''}
                `;
                
                // Final lesson quiz should be specific if it's a project
                const finalQuiz = isProject ? [
                    { type: 'mcq', question: `For the ${coursePrefix} course, what is the final deliverable requirement?`, options: ['A final written exam', 'A Project/Capstone Submission', 'A face-to-face interview', 'A group presentation'], answer: 'A Project/Capstone Submission' },
                    { type: 'text', question: 'What is the email address to which you must submit your project for certificate review? (Enter exactly)', answer: 'elvionailabs@gmail.com' },
                ] : [
                    { type: 'mcq', question: `How many lessons did you complete in the ${coursePrefix} course?`, options: ['1', '5', '8', count.toString()], answer: count.toString() },
                    { type: 'mcq', question: 'What is the next suggested step after completing this course?', options: ['Retake the first lesson', 'Explore another Elvion course or request your certificate', 'Close the browser', 'Nothing'], answer: 'Explore another Elvion course or request your certificate' },
                ];
                
                return {
                    id: i + 1,
                    title: `${coursePrefix} ${lessonTitle}`,
                    duration: `${40 + Math.floor(Math.random() * 20)} min`, // Varied duration
                    content: content,
                    quiz: finalQuiz,
                };
            }
            
            // Simplified, universal quiz for placeholder lessons after the first one
            const simpleQuiz = [
                { type: 'mcq', question: `How many lessons are in the ${coursePrefix} course? (Hint: The answer is in the course metadata)`, options: ['1', '5', '8', count.toString()], answer: count.toString() },
                { type: 'mcq', question: `What is the most important skill for a ${coursePrefix} professional?`, options: ['Memorization', 'Critical Thinking & Problem Solving', 'Speed Reading', 'Ignoring details'], answer: 'Critical Thinking & Problem Solving' },
            ];

            return {
                id: i + 1,
                title: `${coursePrefix} ${lessonTitle}`,
                duration: `${40 + Math.floor(Math.random() * 20)} min`, // Varied duration
                content: content,
                quiz: simpleQuiz,
            };
        });
    };
    
    // --- UPDATED AND EXPANDED COURSE DATABASE (Incorporating all your courses) ---
    const cs101Lessons = [
    { 
        id: 1, 
        title: 'The Role of Computer Science in Society', 
        duration: '45 min', 
        content: `
            <h2>Computer Science: Shaping Our Modern World</h2>
            <p>Computer Science is far more than programming. It is the systematic study of computation, information processing, and the design of computer systems. From the smartphone in your pocket to the algorithms that recommend your next video, computer science influences nearly every aspect of modern life.</p>
            
            <h3>What is Computer Science?</h3>
            <p>Computer Science encompasses several interconnected domains:</p>
            <ul>
                <li><strong>Theoretical Computer Science:</strong> The mathematical foundations, including algorithms, computational complexity, and formal languages.</li>
                <li><strong>Applied Computer Science:</strong> Software engineering, databases, artificial intelligence, and human-computer interaction.</li>
                <li><strong>Computer Systems:</strong> Operating systems, networks, computer architecture, and embedded systems.</li>
                <li><strong>Information Systems:</strong> Data management, information security, and business applications.</li>
            </ul>

            <h3>The Global Impact of Computing</h3>
            <p>Computing has transformed society in profound ways. Healthcare systems use machine learning to diagnose diseases earlier and more accurately. Financial institutions rely on complex algorithms for fraud detection and risk management. Educators use adaptive learning platforms to personalize instruction for millions of students worldwide.</p>
            
            <p>Consider the COVID-19 pandemic response: computational models predicted disease spread, bioinformatics accelerated vaccine development, and distributed systems enabled remote work and learning for billions of people.</p>

            <h3>Career Pathways in Computer Science</h3>
            <p>The field offers diverse career opportunities:</p>
            <ul>
                <li>Software Developer/Engineer</li>
                <li>Data Scientist and Machine Learning Engineer</li>
                <li>Cybersecurity Analyst</li>
                <li>Cloud Solutions Architect</li>
                <li>UX/UI Designer</li>
                <li>DevOps Engineer</li>
                <li>Research Scientist</li>
            </ul>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid #00d9ff;">
                <div class="area-header" style="color: #00d9ff;"><span>Your Learning Journey</span></div>
                <p>Throughout this course, you will build practical skills while understanding the theoretical foundations that make modern computing possible. Each lesson will challenge you to create, analyze, and apply your knowledge.</p>
            </div>

            <h3>Activity: Reflection and Research</h3>
            <p>Write a 250-word essay describing a technology you use daily that relies heavily on computer science. Explain how it works at a basic level and cite at least two credible sources.</p>
            <p><strong>Submission:</strong> Post your essay to the discussion forum or submit via the assignment portal.</p>

            <h3>Further Reading</h3>
            <ul>
                <li>ACM Computing Careers Guide: <code>acm.org/education/curricula-recommendations</code></li>
                <li>Computer Science Unplugged: <code>csunplugged.org</code></li>
                <li>CS50's Introduction to Computer Science (Harvard): <code>cs50.harvard.edu</code></li>
            </ul>
        `,
        quiz: [
            { 
                type: 'mcq', 
                question: 'Which domain of computer science focuses on the mathematical foundations and algorithmic complexity?', 
                options: ['Applied Computer Science', 'Theoretical Computer Science', 'Computer Systems', 'Information Systems'], 
                answer: 'Theoretical Computer Science' 
            },
            { 
                type: 'mcq', 
                question: 'During the COVID-19 pandemic, computer science contributed in multiple ways. Which of the following was NOT mentioned as a key contribution?', 
                options: ['Computational disease spread models', 'Bioinformatics for vaccine development', 'Distributed systems for remote work', 'Physical robot delivery systems'], 
                answer: 'Physical robot delivery systems' 
            },
            { 
                type: 'mcq', 
                question: 'What is the primary difference between software engineering and research in computer science?', 
                options: ['Software engineering focuses on practical implementation while research explores theoretical foundations', 'They are exactly the same', 'Research only deals with hardware', 'Software engineering does not require programming'], 
                answer: 'Software engineering focuses on practical implementation while research explores theoretical foundations' 
            },
            { 
                type: 'text', 
                question: 'Name one specific way computer science has impacted healthcare in recent years.', 
                answer: 'machine learning for diagnosis' 
            }
        ]
    },
    { 
        id: 2, 
        title: 'Computational Thinking and Algorithms', 
        duration: '60 min', 
        content: `
            <h2>The Foundation: How Computers Solve Problems</h2>
            <p>Before writing a single line of code, successful programmers learn to think computationally. Computational thinking is the process of formulating problems and their solutions in ways that can be executed by computers or humans following precise instructions.</p>

            <h3>The Four Pillars of Computational Thinking</h3>
            <p><strong>1. Decomposition:</strong> Breaking complex problems into smaller, manageable sub-problems.</p>
            <p><strong>2. Pattern Recognition:</strong> Identifying similarities and patterns to make predictions and simplify problem-solving.</p>
            <p><strong>3. Abstraction:</strong> Focusing on essential information while ignoring irrelevant details.</p>
            <p><strong>4. Algorithm Design:</strong> Creating step-by-step instructions to solve the problem.</p>

            <h3>What is an Algorithm?</h3>
            <p>An algorithm is a finite sequence of well-defined instructions to solve a specific problem or perform a computation. Every computer program, from a simple calculator to a sophisticated AI system, is built on algorithms.</p>
            
            <p><strong>Properties of Good Algorithms:</strong></p>
            <ul>
                <li><strong>Clear and Unambiguous:</strong> Each step must be precisely defined.</li>
                <li><strong>Input and Output:</strong> Algorithms should have zero or more inputs and at least one output.</li>
                <li><strong>Finiteness:</strong> The algorithm must terminate after a finite number of steps.</li>
                <li><strong>Effectiveness:</strong> Each operation must be basic enough to be carried out.</li>
            </ul>

            <h3>Example: Making Tea (An Algorithm)</h3>
            <pre><code>Algorithm: Make_Tea
Input: Tea bag, cup, hot water, sugar (optional)
Output: Cup of prepared tea

Steps:
1. Fill kettle with water
2. Heat water until boiling (approximately 100°C)
3. Place tea bag in cup
4. Pour hot water into cup
5. Wait 3-5 minutes for steeping
6. Remove tea bag
7. If sugar desired, add and stir
8. Return prepared tea</code></pre>

            <h3>Sorting Algorithms: A Classic Example</h3>
            <p>Sorting is one of the most fundamental operations in computer science. Let us examine Bubble Sort, a simple but instructive algorithm.</p>

            <pre><code># Bubble Sort Algorithm in Python
def bubble_sort(arr):
    n = len(arr)
    
    # Traverse through all array elements
    for i in range(n):
        # Track if any swap occurred
        swapped = False
        
        # Last i elements are already sorted
        for j in range(0, n - i - 1):
            # Swap if element found is greater than next
            if arr[j] > arr[j + 1]:
                arr[j], arr[j + 1] = arr[j + 1], arr[j]
                swapped = True
        
        # If no swaps occurred, array is sorted
        if not swapped:
            break
    
    return arr

# Example usage
numbers = [64, 34, 25, 12, 22, 11, 90]
sorted_numbers = bubble_sort(numbers)
print("Sorted array:", sorted_numbers)
# Output: Sorted array: [11, 12, 22, 25, 34, 64, 90]</code></pre>

            <p><strong>Time Complexity:</strong> Bubble Sort has a time complexity of O(n²) in the worst case, making it inefficient for large datasets. However, it is excellent for educational purposes.</p>

            <h3>Flowcharts and Pseudocode</h3>
            <p>Before implementing algorithms in code, computer scientists use flowcharts and pseudocode to plan and communicate their logic.</p>
            
            <p><strong>Pseudocode Example: Finding Maximum Value</strong></p>
            <pre><code>Algorithm: Find_Maximum
Input: Array of numbers arr[]
Output: Maximum value in array

BEGIN
    max = arr[0]
    FOR each element in arr:
        IF element > max THEN
            max = element
        END IF
    END FOR
    RETURN max
END</code></pre>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid #ffaa00;">
                <div class="area-header" style="color: #ffaa00;"><span>Practice Challenge</span></div>
                <p>Think about your morning routine. Write it as an algorithm using pseudocode, including at least one conditional statement (IF-THEN) and one loop (FOR or WHILE).</p>
            </div>

            <h3>Hands-On Activity</h3>
            <p><strong>Task 1:</strong> Create a flowchart for making breakfast (use tools like Lucidchart, draw.io, or paper).</p>
            <p><strong>Task 2:</strong> Implement the Bubble Sort algorithm in Python using an online IDE like Replit or Google Colab. Test it with the array [5, 2, 9, 1, 7, 6].</p>
            <p><strong>Submission:</strong> Share your flowchart image and code link.</p>

            <h3>Resources</h3>
            <ul>
                <li>Khan Academy: Introduction to Algorithms - <code>khanacademy.org/computing/computer-science/algorithms</code></li>
                <li>Visualizing Algorithms - <code>visualgo.net</code></li>
                <li>Python Tutor (Code Visualization) - <code>pythontutor.com</code></li>
            </ul>
        `,
        quiz: [
            { 
                type: 'mcq', 
                question: 'Which pillar of computational thinking involves breaking a complex problem into smaller, manageable parts?', 
                options: ['Abstraction', 'Pattern Recognition', 'Decomposition', 'Algorithm Design'], 
                answer: 'Decomposition' 
            },
            { 
                type: 'mcq', 
                question: 'What is the worst-case time complexity of the Bubble Sort algorithm?', 
                options: ['O(n)', 'O(n log n)', 'O(n²)', 'O(1)'], 
                answer: 'O(n²)' 
            },
            { 
                type: 'mcq', 
                question: 'In the tea-making algorithm, what would happen if step 2 (heating water) was removed?', 
                options: ['The algorithm would work faster', 'The tea would not brew properly with cold water', 'Nothing would change', 'The algorithm would produce better tea'], 
                answer: 'The tea would not brew properly with cold water' 
            },
            { 
                type: 'text', 
                question: 'What does it mean for an algorithm to have the property of "finiteness"?', 
                answer: 'terminate after finite steps' 
            },
            { 
                type: 'mcq', 
                question: 'Pseudocode is used primarily for:', 
                options: ['Executing programs directly', 'Planning and communicating algorithm logic before coding', 'Designing user interfaces', 'Database management'], 
                answer: 'Planning and communicating algorithm logic before coding' 
            }
        ]
    },
    { 
        id: 3, 
        title: 'Introduction to Programming with Python', 
        duration: '75 min', 
        content: `
            <h2>Writing Your First Programs</h2>
            <p>Programming is the art and science of instructing computers to perform tasks. Python, created by Guido van Rossum in 1991, has become one of the most popular programming languages due to its readability, versatility, and extensive ecosystem of libraries.</p>

            <h3>Why Python?</h3>
            <p>Python is used by tech giants like Google, Netflix, NASA, and Instagram. It excels in web development, data science, artificial intelligence, automation, and scientific computing. Its syntax emphasizes readability, making it an excellent first language for learners.</p>

            <h3>Variables and Data Types</h3>
            <p>Variables are named containers that store data. Python is dynamically typed, meaning you do not need to declare a variable's type explicitly.</p>

            <pre><code># String: Text data enclosed in quotes
name = "Elvion University"
course = 'Computer Science'

# Integer: Whole numbers
students_enrolled = 1500
lessons_completed = 42

# Float: Decimal numbers
gpa = 3.85
completion_rate = 87.5

# Boolean: True or False values
is_enrolled = True
has_certificate = False

# Printing variables
print(f"Welcome to {name}!")
print(f"You have completed {lessons_completed} lessons.")
print(f"Enrollment status: {is_enrolled}")</code></pre>

            <p><strong>Output:</strong></p>
            <pre><code>Welcome to Elvion University!
You have completed 42 lessons.
Enrollment status: True</code></pre>

            <h3>User Input and Output</h3>
            <p>Interactive programs accept user input and produce meaningful output.</p>

            <pre><code># Getting user input
user_name = input("Enter your name: ")
user_age = input("Enter your age: ")

# Converting string input to integer
age_int = int(user_age)
age_in_five_years = age_int + 5

# Formatted output
print(f"Hello, {user_name}!")
print(f"In five years, you will be {age_in_five_years} years old.")</code></pre>

            <h3>Control Structures: Making Decisions</h3>
            <p>Programs need to make decisions based on conditions. The if-elif-else statement allows conditional execution.</p>

            <pre><code># Grade calculator
score = int(input("Enter your quiz score (0-100): "))

if score >= 90:
    grade = "A"
    print(f"Excellent work! Your grade is {grade}.")
elif score >= 80:
    grade = "B"
    print(f"Great job! Your grade is {grade}.")
elif score >= 70:
    grade = "C"
    print(f"Good effort! Your grade is {grade}.")
elif score >= 60:
    grade = "D"
    print(f"You passed with a {grade}. Keep improving!")
else:
    grade = "F"
    print(f"Unfortunately, you did not pass. Your grade is {grade}.")</code></pre>

            <h3>Loops: Repeating Actions</h3>
            <p><strong>For Loop:</strong> Iterates over a sequence (like a range of numbers or a list).</p>

            <pre><code># Print numbers 1 through 5
for i in range(1, 6):
    print(f"Number: {i}")

# Output:
# Number: 1
# Number: 2
# Number: 3
# Number: 4
# Number: 5</code></pre>

            <p><strong>While Loop:</strong> Repeats as long as a condition is true.</p>

            <pre><code># Countdown timer
countdown = 5
while countdown > 0:
    print(f"Countdown: {countdown}")
    countdown -= 1
print("Blast off!")</code></pre>

            <h3>Functions: Reusable Code Blocks</h3>
            <p>Functions allow you to write code once and reuse it multiple times, promoting modularity and reducing redundancy.</p>

            <pre><code>def calculate_area(length, width):
    """Calculate the area of a rectangle."""
    area = length * width
    return area

def greet_user(name, course="Computer Science"):
    """Greet a user with their name and course."""
    message = f"Welcome, {name}! You are enrolled in {course}."
    return message

# Using the functions
rectangle_area = calculate_area(10, 5)
print(f"The area is: {rectangle_area}")

greeting = greet_user("Alice")
print(greeting)

# Output:
# The area is: 50
# Welcome, Alice! You are enrolled in Computer Science.</code></pre>

            <h3>Debugging: Finding and Fixing Errors</h3>
            <p>Errors are a natural part of programming. Python provides clear error messages to help you identify problems.</p>

            <pre><code># Common error: NameError (using undefined variable)
print(undefined_variable)  # NameError: name 'undefined_variable' is not defined

# Common error: TypeError (wrong data type)
result = "10" + 5  # TypeError: can only concatenate str (not "int") to str

# Fix: Convert types appropriately
result = int("10") + 5  # result = 15</code></pre>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid #00ff88;">
                <div class="area-header" style="color: #00ff88;"><span>Coding Challenge</span></div>
                <p>Create a program that asks for a user's name and age, then calculates and displays their age in 5, 10, and 20 years. Use functions to organize your code.</p>
            </div>

            <h3>Hands-On Activity</h3>
            <p><strong>Task 1:</strong> Sign up for a free account on Replit.com or Google Colab.</p>
            <p><strong>Task 2:</strong> Write a Python program that:</p>
            <ul>
                <li>Asks the user for their name and favorite number</li>
                <li>Calculates the square and cube of their favorite number</li>
                <li>Prints a personalized message with the results</li>
            </ul>
            <p><strong>Task 3:</strong> Write a function called <code>is_even</code> that takes a number and returns True if it is even, False otherwise. Test it with at least 3 different numbers.</p>
            <p><strong>Submission:</strong> Share your Replit or Colab link.</p>

            <h3>Resources</h3>
            <ul>
                <li>Python Official Documentation - <code>docs.python.org/3/</code></li>
                <li>Automate the Boring Stuff with Python (Free Book) - <code>automatetheboringstuff.com</code></li>
                <li>W3Schools Python Tutorial - <code>w3schools.com/python/</code></li>
                <li>Real Python Tutorials - <code>realpython.com</code></li>
            </ul>
        `,
        quiz: [
            { 
                type: 'mcq', 
                question: 'Which data type would you use to store the value "Hello, World!"?', 
                options: ['Integer', 'Float', 'String', 'Boolean'], 
                answer: 'String' 
            },
            { 
                type: 'mcq', 
                question: 'What will be the output of: print(10 // 3)', 
                options: ['3.33', '3', '3.0', 'Error'], 
                answer: '3' 
            },
            { 
                type: 'mcq', 
                question: 'Which loop is best when you know exactly how many times you want to repeat an action?', 
                options: ['while loop', 'for loop', 'if loop', 'function loop'], 
                answer: 'for loop' 
            },
            { 
                type: 'text', 
                question: 'What Python function is used to accept user input from the keyboard?', 
                answer: 'input' 
            },
            { 
                type: 'mcq', 
                question: 'What is the purpose of a function in Python?', 
                options: ['To make code run faster', 'To create reusable blocks of code', 'To display graphics', 'To connect to databases'], 
                answer: 'To create reusable blocks of code' 
            },
            { 
                type: 'mcq', 
                question: 'In the grade calculator example, what grade would a score of 75 receive?', 
                options: ['A', 'B', 'C', 'D'], 
                answer: 'C' 
            }
        ]
    },
    { 
        id: 4, 
        title: 'Data Structures: Lists, Dictionaries, and Beyond', 
        duration: '70 min', 
        content: `
            <h2>Organizing Data Efficiently</h2>
            <p>Data structures are specialized formats for organizing, processing, and storing data. Choosing the right data structure dramatically impacts the performance and clarity of your programs.</p>

            <h3>Lists: Ordered Collections</h3>
            <p>Lists in Python are versatile, ordered collections that can hold items of different types. They are mutable, meaning their contents can be changed after creation.</p>

            <pre><code># Creating and manipulating lists
fruits = ["apple", "banana", "orange", "grape"]

# Accessing elements by index (starting at 0)
first_fruit = fruits[0]  # "apple"
last_fruit = fruits[-1]  # "grape"

# Adding elements
fruits.append("mango")  # Add to end
fruits.insert(1, "kiwi")  # Insert at position 1

# Removing elements
fruits.remove("banana")  # Remove by value
popped_fruit = fruits.pop()  # Remove and return last item

# List operations
print(f"Number of fruits: {len(fruits)}")
print(f"Is 'apple' in the list? {'apple' in fruits}")

# Iterating through a list
for fruit in fruits:
    print(f"I like {fruit}!")</code></pre>

            <h3>List Comprehensions: Elegant Data Transformation</h3>
            <p>List comprehensions provide a concise way to create lists based on existing lists.</p>

            <pre><code># Traditional approach
squares = []
for i in range(1, 11):
    squares.append(i ** 2)

# List comprehension (more Pythonic)
squares = [i ** 2 for i in range(1, 11)]
# Result: [1, 4, 9, 16, 25, 36, 49, 64, 81, 100]

# With conditional filtering
even_squares = [i ** 2 for i in range(1, 11) if i % 2 == 0]
# Result: [4, 16, 36, 64, 100]</code></pre>

            <h3>Dictionaries: Key-Value Pairs</h3>
            <p>Dictionaries store data in key-value pairs, providing fast lookups. They are ideal for representing structured data like database records or configuration settings.</p>

            <pre><code># Creating a dictionary
student = {
    "name": "John Doe",
    "age": 20,
    "major": "Computer Science",
    "gpa": 3.7,
    "courses": ["CS101", "MATH201", "ENG102"]
}

# Accessing values
print(f"Student name: {student['name']}")
print(f"GPA: {student['gpa']}")

# Adding or modifying entries
student["email"] = "john.doe@elvion.edu"
student["age"] = 21

# Safe access with .get() method
phone = student.get("phone", "Not provided")
print(f"Phone: {phone}")

# Iterating through dictionaries
for key, value in student.items():
    print(f"{key}: {value}")</code></pre>

            <h3>Practical Example: Contact Book Application</h3>
            <pre><code>contacts = {}

def add_contact(name, phone, email):
    """Add a new contact to the contact book."""
    contacts[name] = {
        "phone": phone,
        "email": email
    }
    print(f"Contact {name} added successfully!")

def search_contact(name):
    """Search for a contact by name."""
    if name in contacts:
        contact = contacts[name]
        print(f"Name: {name}")
        print(f"Phone: {contact['phone']}")
        print(f"Email: {contact['email']}")
    else:
        print(f"Contact {name} not found.")

def display_all_contacts():
    """Display all contacts."""
    if not contacts:
        print("No contacts available.")
    else:
        for name, info in contacts.items():
            print(f"{name} - Phone: {info['phone']}, Email: {info['email']}")

# Using the contact book
add_contact("Alice Johnson", "+1-555-1234", "alice@email.com")
add_contact("Bob Smith", "+1-555-5678", "bob@email.com")
search_contact("Alice Johnson")
display_all_contacts()</code></pre>

            <h3>Tuples: Immutable Sequences</h3>
            <p>Tuples are similar to lists but immutable (cannot be changed after creation). They are useful for data that should not be modified.</p>

            <pre><code># Creating a tuple
coordinates = (10.5, 20.3)
rgb_color = (255, 128, 0)

# Unpacking tuples
x, y = coordinates
print(f"X: {x}, Y: {y}")

# Tuples as dictionary keys (lists cannot be used as keys)
locations = {
    (40.7128, -74.0060): "New York",
    (51.5074, -0.1278): "London"
}</code></pre>

            <h3>Sets: Unique Collections</h3>
            <p>Sets are unordered collections of unique elements, perfect for removing duplicates and performing set operations.</p>

            <pre><code># Creating a set
unique_numbers = {1, 2, 3, 4, 4, 5}
print(unique_numbers)  # Output: {1, 2, 3, 4, 5}

# Set operations
set_a = {1, 2, 3, 4}
set_b = {3, 4, 5, 6}

union = set_a | set_b  # {1, 2, 3, 4, 5, 6}
intersection = set_a & set_b  # {3, 4}
difference = set_a - set_b  # {1, 2}</code></pre>

            <h3>Stacks and Queues: Specialized Structures</h3>
            <p><strong>Stack (LIFO - Last In, First Out):</strong> Like a stack of plates.</p>
            <pre><code># Stack using a list
stack = []
stack.append("Page 1")  # Push
stack.append("Page 2")
stack.append("Page 3")
current_page = stack.pop()  # Pop returns "Page 3"</code></pre>

            <p><strong>Queue (FIFO - First In, First Out):</strong> Like a line at a store.</p>
            <pre><code>from collections import deque

queue = deque()
queue.append("Customer 1")  # Enqueue
queue.append("Customer 2")
queue.append("Customer 3")
served = queue.popleft()  # Dequeue returns "Customer 1"</code></pre>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid #ff6b6b;">
                <div class="area-header" style="color: #ff6b6b;"><span>Design Challenge</span></div>
                <p>Design a simple task manager using lists and dictionaries. Each task should have a title, description, priority level, and completion status.</p>
            </div>

            <h3>Hands-On Activity</h3>
            <p><strong>Project: Build a Student Grade Tracker</strong></p>
            <p>Create a program that:</p>
            <ul>
                <li>Stores student records using dictionaries</li>
                <li>Allows adding students and their grades</li>
                <li>Calculates and displays the average grade for each student</li>
                <li>Finds and displays the student with the highest average</li>
            </ul>
            <p><strong>Submission:</strong> Push your code to GitHub and share the repository link.</p>

            <h3>Resources</h3>
            <ul>
                <li>Python Data Structures Documentation - <code>docs.python.org/3/tutorial/datastructures.html</code></li>
                <li>Open Data Structures (Free Book) - <code>opendatastructures.org</code></li>
                <li>Real Python: Python Data Structures - <code>realpython.com/python-data-structures/</code></li>
            </ul>
        `,
        quiz: [
            { 
                type: 'mcq', 
                question: 'Which data structure would be most appropriate for storing unique student ID numbers?', 
                options: ['List', 'Dictionary', 'Set', 'Tuple'], 
                answer: 'Set' 
            },
            { 
                type: 'mcq', 
                question: 'How do you access the value associated with the key "name" in a dictionary called student?', 
                options: ['student.name', 'student[name]', 'student["name"]', 'student(name)'], 
                answer: 'student["name"]' 
            },
            { 
                type: 'mcq', 
                question: 'What is the main characteristic of a Stack data structure?', 
                options: ['First In, First Out (FIFO)', 'Last In, First Out (LIFO)', 'Random Access', 'Sorted Order'], 
                answer: 'Last In, First Out (LIFO)' 
            },
            { 
                type: 'text', 
                question: 'What method is used to add an element to the end of a Python list?', 
                answer: 'append' 
            },
            { 
                type: 'mcq', 
                question: 'Which data structure is immutable in Python?', 
                options: ['List', 'Dictionary', 'Set', 'Tuple'], 
                answer: 'Tuple' 
            },
            { 
                type: 'mcq', 
                question: 'In the contact book example, what data structure is used to store multiple contacts?', 
                options: ['List of lists', 'Dictionary of dictionaries', 'Set of tuples', 'Array'], 
                answer: 'Dictionary of dictionaries' 
            }
        ]
    },
    { 
        id: 5, 
        title: 'Object-Oriented Programming Fundamentals', 
        duration: '80 min', 
        content: `
            <h2>Programming with Objects</h2>
            <p>Object-Oriented Programming (OOP) is a paradigm that organizes software design around objects rather than functions and logic. OOP makes code more modular, reusable, and easier to maintain.</p>

            <h3>Classes and Objects: The Foundation</h3>
            <p>A <strong>class</strong> is a blueprint for creating objects. An <strong>object</strong> is an instance of a class. Think of a class as a cookie cutter and objects as the cookies.</p>

            <pre><code>class Dog:
    """A simple class to represent a dog."""
    
    def __init__(self, name, breed, age):
        """Initialize dog attributes."""
        self.name = name
        self.breed = breed
        self.age = age
    
    def bark(self):
        """Simulate a dog barking."""
        return f"{self.name} says Woof!"
    
    def get_info(self):
        """Return formatted information about the dog."""
        return f"{self.name} is a {self.age}-year-old {self.breed}."

# Creating objects (instances)
dog1 = Dog("Buddy", "Golden Retriever", 3)
dog2 = Dog("Max", "German Shepherd", 5)

# Using object methods
print(dog1.bark())  # Output: Buddy says Woof!
print(dog2.get_info())  # Output: Max is a 5-year-old German Shepherd.</code></pre>

            <h3>The Four Pillars of OOP</h3>
            
            <h4>1. Encapsulation</h4>
            <p>Encapsulation bundles data (attributes) and methods that operate on that data within a single unit (class), hiding internal details from the outside world.</p>

            <pre><code>class BankAccount:
    """Demonstrates encapsulation with private attributes."""
    
    def __init__(self, account_number, initial_balance):
        self.account_number = account_number
        self.__balance = initial_balance  # Private attribute (by convention)
    
    def deposit(self, amount):
        """Deposit money into the account."""
        if amount > 0:
            self.__balance += amount
            return f"Deposited ${amount}. New balance: ${self.__balance}"
        return "Invalid deposit amount."
    
    def withdraw(self, amount):
        """Withdraw money from the account."""
        if 0 < amount <= self.__balance:
            self.__balance -= amount
            return f"Withdrew ${amount}. New balance: ${self.__balance}"
        return "Insufficient funds or invalid amount."
    
    def get_balance(self):
        """Safely access the balance."""
        return self.__balance

# Using the BankAccount class
account = BankAccount("ACC001", 1000)
print(account.deposit(500))  # Deposited $500. New balance: $1500
print(account.withdraw(200))  # Withdrew $200. New balance: $1300
print(f"Current balance: ${account.get_balance()}")  # Current balance: $1300

# Direct access to __balance is discouraged
# print(account.__balance)  # AttributeError</code></pre>

            <h4>2. Inheritance</h4>
            <p>Inheritance allows a class to inherit attributes and methods from another class, promoting code reuse.</p>

            <pre><code>class Vehicle:
    """Base class for all vehicles."""
    
    def __init__(self, brand, model, year):
        self.brand = brand
        self.model = model
        self.year = year
    
    def get_info(self):
        return f"{self.year} {self.brand} {self.model}"
    
    def start_engine(self):
        return "Engine started."

class Car(Vehicle):
    """Car class inherits from Vehicle."""
    
    def __init__(self, brand, model, year, num_doors):
        super().__init__(brand, model, year)  # Call parent constructor
        self.num_doors = num_doors
    
    def honk(self):
        return "Beep beep!"

class Motorcycle(Vehicle):
    """Motorcycle class inherits from Vehicle."""
    
    def __init__(self, brand, model, year, engine_cc):
        super().__init__(brand, model, year)
        self.engine_cc = engine_cc
    
    def wheelie(self):
        return "Performing a wheelie!"

# Creating instances
my_car = Car("Toyota", "Camry", 2023, 4)
my_bike = Motorcycle("Harley Davidson", "Street 750", 2022, 750)

print(my_car.get_info())  # 2023 Toyota Camry
print(my_car.honk())  # Beep beep!
print(my_bike.get_info())  # 2022 Harley Davidson Street 750
print(my_bike.wheelie())  # Performing a wheelie!</code></pre>

            <h4>3. Polymorphism</h4>
            <p>Polymorphism allows objects of different classes to be treated as objects of a common parent class. Methods can be overridden to provide specific implementations.</p>

            <pre><code>class Animal:
    """Base class for animals."""
    
    def speak(self):
        pass  # Abstract method to be overridden

class Cat(Animal):
    def speak(self):
        return "Meow!"

class Cow(Animal):
    def speak(self):
        return "Moo!"

class Duck(Animal):
    def speak(self):
        return "Quack!"

# Polymorphism in action
animals = [Cat(), Cow(), Duck()]

for animal in animals:
    print(animal.speak())

# Output:
# Meow!
# Moo!
# Quack!</code></pre>

            <h4>4. Abstraction</h4>
            <p>Abstraction hides complex implementation details and shows only essential features of an object.</p>

            <pre><code>from abc import ABC, abstractmethod

class Shape(ABC):
    """Abstract base class for shapes."""
    
    @abstractmethod
    def area(self):
        """Calculate area (must be implemented by subclasses)."""
        pass
    
    @abstractmethod
    def perimeter(self):
        """Calculate perimeter (must be implemented by subclasses)."""
        pass

class Rectangle(Shape):
    def __init__(self, width, height):
        self.width = width
        self.height = height
    
    def area(self):
        return self.width * self.height
    
    def perimeter(self):
        return 2 * (self.width + self.height)

class Circle(Shape):
    def __init__(self, radius):
        self.radius = radius
    
    def area(self):
        return 3.14159 * self.radius ** 2
    
    def perimeter(self):
        return 2 * 3.14159 * self.radius

# Using the shapes
rect = Rectangle(10, 5)
circle = Circle(7)

print(f"Rectangle area: {rect.area()}")  # 50
print(f"Circle area: {circle.area():.2f}")  # 153.94</code></pre>

            <h3>Real-World Example: Library Management System</h3>
            <pre><code>class Book:
    """Represents a book in the library."""
    
    def __init__(self, title, author, isbn):
        self.title = title
        self.author = author
        self.isbn = isbn
        self.is_available = True
    
    def __str__(self):
        status = "Available" if self.is_available else "Checked out"
        return f"{self.title} by {self.author} - {status}"

class Member:
    """Represents a library member."""
    
    def __init__(self, name, member_id):
        self.name = name
        self.member_id = member_id
        self.borrowed_books = []
    
    def borrow_book(self, book):
        if book.is_available:
            book.is_available = False
            self.borrowed_books.append(book)
            return f"{self.name} borrowed '{book.title}'"
        return f"'{book.title}' is not available."
    
    def return_book(self, book):
        if book in self.borrowed_books:
            book.is_available = True
            self.borrowed_books.remove(book)
            return f"{self.name} returned '{book.title}'"
        return f"{self.name} did not borrow '{book.title}'"

# Using the library system
book1 = Book("Python Crash Course", "Eric Matthes", "978-1593279288")
member1 = Member("Alice Johnson", "M001")

print(member1.borrow_book(book1))  # Alice Johnson borrowed 'Python Crash Course'
print(book1)  # Python Crash Course by Eric Matthes - Checked out
print(member1.return_book(book1))  # Alice Johnson returned 'Python Crash Course'
print(book1)  # Python Crash Course by Eric Matthes - Available</code></pre>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid #9b59b6;">
                <div class="area-header" style="color: #9b59b6;"><span>OOP Design Challenge</span></div>
                <p>Design a university system with Student, Course, and Instructor classes. Students can enroll in courses, and instructors can teach multiple courses.</p>
            </div>

            <h3>Hands-On Activity</h3>
            <p><strong>Project: Build a Simple Banking System</strong></p>
            <p>Create a program with the following features:</p>
            <ul>
                <li>Create a Customer class and an Account class</li>
                <li>Implement deposit, withdrawal, and transfer methods</li>
                <li>Use inheritance to create SavingsAccount and CheckingAccount subclasses</li>
                <li>Add validation to prevent overdrafts</li>
            </ul>
            <p><strong>Submission:</strong> Push your code to GitHub with a README explaining your design choices.</p>

            <h3>Resources</h3>
            <ul>
                <li>Real Python: OOP in Python 3 - <code>realpython.com/python3-object-oriented-programming/</code></li>
                <li>Python OOP Tutorial (Corey Schafer) - <code>youtube.com/watch?v=ZDa-Z5JzLYM</code></li>
                <li>Design Patterns in Python - <code>refactoring.guru/design-patterns/python</code></li>
            </ul>
        `,
        quiz: [
            { 
                type: 'mcq', 
                question: 'What is the purpose of the __init__ method in a Python class?', 
                options: ['To delete an object', 'To initialize object attributes', 'To inherit from parent classes', 'To make methods private'], 
                answer: 'To initialize object attributes' 
            },
            { 
                type: 'mcq', 
                question: 'Which pillar of OOP is demonstrated when a Car class inherits from a Vehicle class?', 
                options: ['Encapsulation', 'Inheritance', 'Polymorphism', 'Abstraction'], 
                answer: 'Inheritance' 
            },
            { 
                type: 'mcq', 
                question: 'What does polymorphism allow in object-oriented programming?', 
                options: ['Hiding implementation details', 'Objects of different classes to be treated similarly', 'Creating multiple objects', 'Preventing inheritance'], 
                answer: 'Objects of different classes to be treated similarly' 
            },
            { 
                type: 'text', 
                question: 'What keyword is used to inherit from a parent class in Python?', 
                answer: 'super' 
            },
            { 
                type: 'mcq', 
                question: 'In the BankAccount example, why is __balance prefixed with double underscores?', 
                options: ['To make it public', 'To indicate it is a private attribute', 'To inherit it', 'To override it'], 
                answer: 'To indicate it is a private attribute' 
            },
            { 
                type: 'mcq', 
                question: 'What is the relationship between a class and an object?', 
                options: ['They are the same thing', 'A class is a blueprint, an object is an instance', 'An object is a blueprint, a class is an instance', 'Classes cannot create objects'], 
                answer: 'A class is a blueprint, an object is an instance' 
            }
        ]
    },
    { 
        id: 6, 
        title: 'Database Systems and SQL', 
        duration: '75 min', 
        content: `
            <h2>Managing Data at Scale</h2>
            <p>Databases are organized collections of structured data, typically stored electronically. They are fundamental to modern applications, from social media platforms to banking systems.</p>

            <h3>Relational Databases</h3>
            <p>Relational databases organize data into tables (relations) with rows (records) and columns (attributes). They use Structured Query Language (SQL) for data management and querying.</p>

            <h3>Database Design Principles</h3>
            <p><strong>Entities and Relationships:</strong> Model real-world objects and their connections.</p>
            <p><strong>Primary Keys:</strong> Unique identifiers for each record in a table.</p>
            <p><strong>Foreign Keys:</strong> Links between tables that establish relationships.</p>

            <h3>Creating Tables with SQL</h3>
            <pre><code>-- Create a Students table
CREATE TABLE Students (
    student_id INTEGER PRIMARY KEY,
    first_name VARCHAR(50) NOT NULL,
    last_name VARCHAR(50) NOT NULL,
    email VARCHAR(100) UNIQUE,
    date_of_birth DATE,
    enrollment_date DATE DEFAULT CURRENT_DATE
);

-- Create a Courses table
CREATE TABLE Courses (
    course_id INTEGER PRIMARY KEY,
    course_name VARCHAR(100) NOT NULL,
    credits INTEGER,
    department VARCHAR(50)
);

-- Create an Enrollments table (many-to-many relationship)
CREATE TABLE Enrollments (
    enrollment_id INTEGER PRIMARY KEY,
    student_id INTEGER,
    course_id INTEGER,
    grade VARCHAR(2),
    semester VARCHAR(20),
    FOREIGN KEY (student_id) REFERENCES Students(student_id),
    FOREIGN KEY (course_id) REFERENCES Courses(course_id)
);</code></pre>

            <h3>CRUD Operations: The Foundation</h3>
            
            <h4>Create (INSERT)</h4>
            <pre><code>-- Insert a single record
INSERT INTO Students (student_id, first_name, last_name, email, date_of_birth)
VALUES (1, 'John', 'Doe', 'john.doe@elvion.edu', '2003-05-15');

-- Insert multiple records
INSERT INTO Courses (course_id, course_name, credits, department)
VALUES 
    (101, 'Computer Science', 4, 'CS'),
    (102, 'Data Structures', 4, 'CS'),
    (103, 'Database Systems', 3, 'CS');</code></pre>

            <h4>Read (SELECT)</h4>
            <pre><code>-- Select all students
SELECT * FROM Students;

-- Select specific columns
SELECT first_name, last_name, email FROM Students;

-- Filter results with WHERE
SELECT * FROM Students WHERE enrollment_date > '2024-01-01';

-- Sort results
SELECT * FROM Courses ORDER BY credits DESC;

-- Join tables
SELECT 
    Students.first_name, 
    Students.last_name, 
    Courses.course_name,
    Enrollments.grade
FROM Enrollments
JOIN Students ON Enrollments.student_id = Students.student_id
JOIN Courses ON Enrollments.course_id = Courses.course_id
WHERE Students.student_id = 1;</code></pre>

            <h4>Update (UPDATE)</h4>
            <pre><code>-- Update a student's email
UPDATE Students
SET email = 'john.new@elvion.edu'
WHERE student_id = 1;

-- Update multiple fields
UPDATE Enrollments
SET grade = 'A', semester = 'Fall 2025'
WHERE enrollment_id = 1;</code></pre>

            <h4>Delete (DELETE)</h4>
            <pre><code>-- Delete a specific record
DELETE FROM Enrollments WHERE enrollment_id = 1;

-- Delete with condition
DELETE FROM Students WHERE enrollment_date < '2020-01-01';</code></pre>

            <h3>Advanced Queries</h3>
            
            <h4>Aggregation Functions</h4>
            <pre><code>-- Count number of students
SELECT COUNT(*) AS total_students FROM Students;

-- Average credits of courses
SELECT AVG(credits) AS avg_credits FROM Courses;

-- Group by department
SELECT department, COUNT(*) AS course_count
FROM Courses
GROUP BY department;

-- Find students with GPA above 3.5
SELECT 
    Students.first_name,
    Students.last_name,
    AVG(
        CASE 
            WHEN Enrollments.grade = 'A' THEN 4.0
            WHEN Enrollments.grade = 'B' THEN 3.0
            WHEN Enrollments.grade = 'C' THEN 2.0
            ELSE 1.0
        END
    ) AS gpa
FROM Students
JOIN Enrollments ON Students.student_id = Enrollments.student_id
GROUP BY Students.student_id
HAVING gpa > 3.5;</code></pre>

            <h4>Subqueries</h4>
            <pre><code>-- Find students enrolled in Computer Science
SELECT first_name, last_name
FROM Students
WHERE student_id IN (
    SELECT student_id 
    FROM Enrollments 
    WHERE course_id = (
        SELECT course_id 
        FROM Courses 
        WHERE course_name = 'Computer Science'
    )
);</code></pre>

            <h3>Working with SQLite in Python</h3>
            <pre><code>import sqlite3

# Connect to database (creates file if it doesn't exist)
conn = sqlite3.connect('elvion_university.db')
cursor = conn.cursor()

# Create table
cursor.execute('''
    CREATE TABLE IF NOT EXISTS students (
        id INTEGER PRIMARY KEY AUTOINCREMENT,
        name TEXT NOT NULL,
        email TEXT UNIQUE,
        gpa REAL
    )
''')

# Insert data
cursor.execute('''
    INSERT INTO students (name, email, gpa) 
    VALUES (?, ?, ?)
''', ('Alice Johnson', 'alice@elvion.edu', 3.8))

# Query data
cursor.execute('SELECT * FROM students WHERE gpa >= 3.5')
high_achievers = cursor.fetchall()

for student in high_achievers:
    print(f"ID: {student[0]}, Name: {student[1]}, GPA: {student[3]}")

# Commit changes and close connection
conn.commit()
conn.close()</code></pre>

            <h3>Database Normalization</h3>
            <p>Normalization organizes data to reduce redundancy and improve integrity.</p>
            <ul>
                <li><strong>First Normal Form (1NF):</strong> Eliminate repeating groups; each cell contains atomic values.</li>
                <li><strong>Second Normal Form (2NF):</strong> Achieve 1NF and remove partial dependencies.</li>
                <li><strong>Third Normal Form (3NF):</strong> Achieve 2NF and remove transitive dependencies.</li>
            </ul>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid #3498db;">
                <div class="area-header" style="color: #3498db;"><span>Database Design Challenge</span></div>
                <p>Design a database schema for an online bookstore. Include tables for Books, Authors, Customers, and Orders. Define appropriate relationships and constraints.</p>
            </div>

            <h3>Hands-On Activity</h3>
            <p><strong>Project: Student Management System</strong></p>
            <p>Create a Python program that:</p>
            <ul>
                <li>Uses SQLite to create a student database</li>
                <li>Implements functions to add, search, update, and delete student records</li>
                <li>Calculates and displays statistics (average GPA, total students, etc.)</li>
                <li>Provides a simple text-based menu interface</li>
            </ul>
            <p><strong>Submission:</strong> Push your code and the database file to GitHub.</p>

            <h3>Resources</h3>
            <ul>
                <li>SQLite Tutorial - <code>sqlitetutorial.net</code></li>
                <li>SQL Bolt (Interactive Tutorial) - <code>sqlbolt.com</code></li>
                <li>W3Schools SQL Tutorial - <code>w3schools.com/sql/</code></li>
                <li>Database Design for Beginners - <code>databasestar.com/database-design/</code></li>
            </ul>
        `,
        quiz: [
            { 
                type: 'mcq', 
                question: 'Which SQL command is used to retrieve data from a database?', 
                options: ['INSERT', 'UPDATE', 'SELECT', 'DELETE'], 
                answer: 'SELECT' 
            },
            { 
                type: 'mcq', 
                question: 'What is the purpose of a PRIMARY KEY in a database table?', 
                options: ['To create relationships between tables', 'To uniquely identify each record', 'To sort data', 'To encrypt data'], 
                answer: 'To uniquely identify each record' 
            },
            { 
                type: 'mcq', 
                question: 'Which SQL clause is used to filter results based on a condition?', 
                options: ['ORDER BY', 'GROUP BY', 'WHERE', 'HAVING'], 
                answer: 'WHERE' 
            },
            { 
                type: 'text', 
                question: 'What does CRUD stand for in database operations?', 
                answer: 'create read update delete' 
            },
            { 
                type: 'mcq', 
                question: 'A FOREIGN KEY is used to:', 
                options: ['Encrypt sensitive data', 'Establish relationships between tables', 'Speed up queries', 'Create backups'], 
                answer: 'Establish relationships between tables' 
            },
            { 
                type: 'mcq', 
                question: 'Which normalization form eliminates repeating groups?', 
                options: ['First Normal Form (1NF)', 'Second Normal Form (2NF)', 'Third Normal Form (3NF)', 'Fourth Normal Form (4NF)'], 
                answer: 'First Normal Form (1NF)' 
            }
        ]
    },
    { 
    id: 7, 
    title: 'Computer Networks and Internet Fundamentals', 
    duration: '70 min', 
    content: `
        <h2>Understanding Connected Systems</h2>
        <p>Computer networks enable communication and resource sharing between devices. From local home networks to the global Internet, networking principles underpin all modern digital communication.</p>

        <h3>The OSI Model: Seven Layers of Networking</h3>
        <p>The Open Systems Interconnection (OSI) model provides a conceptual framework for understanding network communication.</p>

        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
            <tr style="background: rgba(0, 217, 255, 0.2);">
                <th>Layer</th>
                <th>Name</th>
                <th>Function</th>
            </tr>
            <tr>
                <td>7</td>
                <td>Application</td>
                <td>User interfaces, HTTP, FTP, email</td>
            </tr>
            <tr>
                <td>6</td>
                <td>Presentation</td>
                <td>Data translation, encryption, compression</td>
            </tr>
            <tr>
                <td>5</td>
                <td>Session</td>
                <td>Manages connections and sessions</td>
            </tr>
            <tr>
                <td>4</td>
                <td>Transport</td>
                <td>Reliable data delivery (TCP/UDP), error correction, flow control</td>
            </tr>
            <tr>
                <td>3</td>
                <td>Network</td>
                <td>Routing, addressing (IP addresses)</td>
            </tr>
            <tr>
                <td>2</td>
                <td>Data Link</td>
                <td>Physical addressing (MAC), error detection on the link</td>
            </tr>
            <tr>
                <td>1</td>
                <td>Physical</td>
                <td>Physical medium (cables, radio waves, optical fibers)</td>
            </tr>
        </table>

        <h3>IP Addresses and Protocols</h3>
        <ul>
            <li><strong>IP Address:</strong> Unique identifier for a device on a network (e.g., 192.168.1.10)</li>
            <li><strong>Protocols:</strong> Agreed standards for data exchange. Examples: HTTP (web), SMTP (email), DNS (domain name lookup), TCP/UDP (transport layer)</li>
        </ul>

        <h3>Understanding Routing</h3>
        <p>Routers direct network traffic from source to destination. Traceroute tools let you observe the path packets take across the Internet.</p>
        <pre><code># Run this in your system terminal
traceroute www.google.com  // (macOS/Linux)
tracert www.google.com     // (Windows)
        </code></pre>

        <h3>Hands-On Activity</h3>
        <p>
            <strong>Project:</strong> 
            <ul>
                <li>Use 'ping' or 'traceroute' on your own device to test connectivity to a favorite website.</li>
                <li>Draw a simple diagram that explains how a web browser requests a page from a server using the OSI model layers.</li>
            </ul>
            <p><strong>Submission:</strong> Upload screenshots of your ping/traceroute results and a photo or file of your OSI diagram.</p>
        </p>

        <h3>Further Resources</h3>
        <ul>
            <li>How the Internet Works (Khan Academy): <code>khanacademy.org/computing/computer-science/internet-intro</code></li>
            <li>Wireshark (Packet Analysis Tool): <code>wireshark.org</code></li>
        </ul>
    `,
    quiz: [
        { 
            type: 'mcq', 
            question: 'Which OSI layer handles routing of data packets?', 
            options: ['Transport', 'Session', 'Network', 'Application'], 
            answer: 'Network' 
        },
        { 
            type: 'mcq', 
            question: 'What protocol is commonly used to translate domain names into IP addresses?', 
            options: ['IP', 'TCP', 'DNS', 'FTP'], 
            answer: 'DNS' 
        },
        { 
            type: 'text', 
            question: 'Give an example of an IP address.', 
            answer: '192.168.1.1' 
        },
        { 
            type: 'mcq', 
            question: 'Which protocol is connection-oriented and guarantees delivery of packets?', 
            options: ['UDP', 'TCP', 'IP', 'HTTP'], 
            answer: 'TCP' 
        }
    ]
},
{
    id: 8, 
    title: 'Capstone Project and Portfolio',
    duration: '120 min',
    content: `
        <h2>Capstone: Applying Your Knowledge</h2>
        <p>This culminating project demonstrates your understanding of core computer science concepts by synthesizing skills from previous lessons.</p>

        <h3>Project Guidelines</h3>
        <ul>
            <li>Choose a problem that matters to you (e.g., contact manager, simple game, data analysis, or personal website).</li>
            <li>Design, structure, and document the project using principles from algorithms, data structures, OOP, and databases.</li>
            <li>Implement the project in Python (or another taught language), using GitHub for version control.</li>
        </ul>

        <h3>Minimum Requirements</h3>
        <ul>
            <li>Code must be well-structured and commented.</li>
            <li>Data stored using appropriate structures and/or simple database integration (SQLite).</li>
            <li>Include a README explaining setup, features, and technologies used.</li>
            <li>Push your code and documentation to GitHub. Share your project link in the assignment portal.</li>
        </ul>

        <h3>Peer Review</h3>
        <ul>
            <li>Provide constructive feedback on at least one classmate's project, focusing on code organization, usability, and documentation.</li>
        </ul>

        <h3>Further Exploration</h3>
        <ul>
            <li>Explore open source projects in your areas of interest.</li>
            <li>Consider expanding your project with a web interface (using Flask or Django).</li>
        </ul>

        <h3>Resources</h3>
        <ul>
            <li>Awesome Python Applications: <code>awesome-python.com</code></li>
            <li>GitHub Student Developer Pack: <code>education.github.com/pack</code></li>
        </ul>
    `,
    quiz: [
        { 
            type: 'text', 
            question: 'What is the GitHub link to your completed project?', 
            answer: '' 
        },
        { 
            type: 'mcq', 
            question: 'Which key principle ensures code is organized and easy to maintain?', 
            options: ['Randomness', 'Modularity', 'Monolithic', 'Redundancy'], 
            answer: 'Modularity' 
        },
        { 
            type: 'text', 
            question: 'Briefly describe one challenge you faced in your capstone project and how you addressed it.', 
            answer: '' 
        }
    ]
},
{
    id: 8,
    title: 'Final Year Project & Certificate Submission',
    duration: '120 min',
    content: `
        <h2>Final Year Project: Showcase Your Knowledge</h2>
        <p>
            Your final year project is your opportunity to demonstrate how much you have learned in this course. Rather than another "test," this is a hands-on project that brings together your knowledge of algorithms, data structures, databases, networks, and programming best practices.
        </p>

        <h3>Project Objective</h3>
        <p>
            You will design and build a small but complete software solution. Pick a problem that interests you—this could be a personal productivity tool, a basic messaging app, a mini game, or any application that fits within your skills and resources.
        </p>

        <h3>Required Components</h3>
        <ul>
            <li><strong>Algorithms & Data Structures:</strong> Use at least one data structure (list, dictionary, set, class) and an explicit algorithm in your solution.</li>
            <li><strong>Programming:</strong> Write the main logic in Python. Your code must be well-commented and organized using functions and/or classes.</li>
            <li><strong>Database (Optional for Advanced):</strong> Integrate an SQLite database for user data, messages, or scores if your app needs persistent storage.</li>
            <li><strong>Networking (Optional):</strong> Include basic networking, such as sending data between users/machines, for those interested and able.</li>
            <li><strong>Documentation:</strong> Write a README explaining your project's objective, core features, technologies used, and a personal reflection on your learning and development process.</li>
        </ul>

        <h3>Submission Instructions</h3>
        <ol>
            <li>Push your full project (code and accompanying files) to a public GitHub repository. If you are new to GitHub, follow the guide at <code>guides.github.com/activities/hello-world/</code>.</li>
            <li>Make sure your README.md includes your name, the project overview, instructions to run the code, and your short personal reflection (at least 200 words).</li>
            <li>Take at least one screenshot showing your program in action.</li>
            <li>Send your <strong>GitHub repository link</strong> and the screenshot to <code>elvionailabs@gmail.com</code> with the subject: "CS101 Final Project Submission – Your Name".</li>
        </ol>

        <h3>Peer and Self Review</h3>
        <ul>
            <li>Review at least one other project by a peer. Submit a short paragraph of feedback highlighting what impressed you and any suggestions for improvement.</li>
            <li>Use the self-assessment checklist provided to reflect on your project’s strengths and areas for growth.</li>
        </ul>

        <h3>Next Steps: Certificate</h3>
        <p>
            After project review, fill out the final certificate request form (linked on the next page). Successful completion and project approval will earn you your Computer Science pre-degree certificate.
        </p>

        <h3>References & Project Inspiration</h3>
        <ul>
            <li><a href="https://github.com/karan/Projects">Karan's Project List</a> – hundreds of beginner-friendly project ideas</li>
            <li><a href="https://realpython.com">Real Python Tutorials</a> – for advanced feature support</li>
            <li><a href="https://education.github.com/pack">GitHub Student Pack</a> – free developer tools</li>
            <li><a href="https://awesome-python.com/">Awesome Python</a> – libraries and applications</li>
        </ul>
    `,
    quiz: [
        {
            type: 'mcq',
            question: 'Which of these steps is NOT part of the final year project submission?',
            options: [
                'Write and submit a short README file',
                'Include at least one relevant algorithm or data structure',
                'Deploy the project to a global audience',
                'Send your GitHub repo link and screenshot to the specified email'
            ],
            answer: 'Deploy the project to a global audience'
        },
        {
            type: 'text',
            question: "What is the email address for submitting your final project for certificate review?",
            answer: "elvionailabs@gmail.com"
        },
        {
            type: 'mcq',
            question: "Should your code include comments and a reflection section in your README?",
            options: [
                'Yes, always for clarity and assessment',
                'No, just submit the code',
                'Only if you work with a team',
                'Only if it is required by a peer'
            ],
            answer: 'Yes, always for clarity and assessment'
        },
        {
            type: 'text',
            question: 'Paste your public GitHub repository link for the final year project here.',
            answer: ''
         ]
      }
];
                
    // --- NEW SOFTWARE ENGINEERING COURSE CONTENT ---
    const swe101Lessons = [
    {
        id: 1,
        title: 'L1: Software Engineering Discipline & Mindset',
        duration: '50 min',
        content: `
            <h2>What is Software Engineering? (SWE)</h2>
            <p>Software Engineering is the systematic, disciplined, quantifiable approach to the development, operation, and maintenance of software. It's not just coding; it's about building complex systems reliably, on time, and within budget, treating software development as an engineering discipline.</p>

            <h3>Why Engineering?</h3>
            <p>Unlike simple programming (where one person writes code for a small task), Software Engineering deals with:</p>
            <ul>
                <li><strong>Scale:</strong> Projects involving hundreds of developers and millions of lines of code.</li>
                <li><strong>Reliability:</strong> The software must work correctly, especially in critical applications (e.g., medical, aviation).</li>
                <li><strong>Maintainability:</strong> The ability for future teams to update and fix the software efficiently.</li>
            </ul>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--warning-color);">
                <div class="area-header" style="color: var(--warning-color);"><span>The SWE Mindset</span></div>
                <p>The core mindset of an engineer is: **Plan, Test, Document, and Optimize**. A software engineer spends far more time designing and verifying than writing the initial code.</p>
            </div>
            
            <h3>Activity: The Bridge Analogy</h3>
            <p>Consider a bridge builder (Civil Engineer) vs. someone nailing two boards together (Hobbyist). The bridge requires extensive planning, stress testing, material science, and regulatory compliance. Software development for a bank's security system is like building a bridge; an engineer is required.</p>
            
            <h3>Further Reading</h3>
            <ul>
                <li>IEEE/ISO Standard for Software Engineering: <code>iso.org/standard/24640.html</code></li>
                <li>"The Mythical Man-Month" by Frederick Brooks (On software project management).</li>
            </ul>
        `,
        quiz: [
            { type: 'mcq', question: 'Software Engineering is defined as a systematic, disciplined, quantifiable approach to:', options: ['Only coding tasks', 'The development, operation, and maintenance of software', 'Only bug fixing', 'Writing short scripts'], answer: 'The development, operation, and maintenance of software' },
            { type: 'mcq', question: 'Which characteristic is a major concern for Software Engineering but less so for simple programming?', options: ['Writing variable names', 'Choosing a text editor', 'Dealing with project scale and maintainability', 'Debugging basic loops'], answer: 'Dealing with project scale and maintainability' },
        ],
    },
    {
        id: 2,
        title: 'L2: SDLC and Methodologies (Agile vs. Waterfall)',
        duration: '60 min',
        content: `
            <h2>The Software Development Lifecycle (SDLC)</h2>
            <p>The SDLC is a process followed by a software project within a software organization. It outlines a detailed plan for how to develop, maintain, replace, or alter software systems. The common phases are: Planning, Requirements Analysis, Design, Implementation (Coding), Testing, Deployment, and Maintenance.</p>

            <h3>Waterfall Methodology</h3>
            <p>The Waterfall model is a sequential design process, where progress flows steadily downwards like a waterfall. Each phase must be completed and signed off before the next phase can begin.</p>
            <ul>
                <li>**Pros:** Simple to understand, easy to manage due to rigid phases, good for small projects with clearly defined, unchanging requirements.</li>
                <li>**Cons:** High risk for complex projects; no working software until late in the cycle; difficult to respond to changing requirements.</li>
            </ul>

            <h3>Agile Methodology</h3>
            <p>Agile is an iterative, incremental approach. It focuses on delivering value quickly and responding to change. It is guided by the **Agile Manifesto** principles: individuals and interactions over processes and tools, working software over comprehensive documentation, customer collaboration over contract negotiation, and responding to change over following a plan.</p>
            <ul>
                <li>**Key Concepts:** **Sprints** (short, time-boxed iterations, typically 2-4 weeks), **Daily Standups**, **Product Backlogs**.</li>
                <li>**Pros:** High customer satisfaction, early and continuous delivery of working software, highly adaptable to changes.</li>
                <li>**Cons:** Requires intense customer involvement, can be hard to measure progress for complex projects without clear documentation.</li>
            </ul>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--primary-color);">
                <div class="area-header" style="color: var(--primary-color);"><span>Real-World SDLC</span></div>
                <p>Most modern tech companies use variations of Agile (like Scrum or Kanban) because product requirements in the tech industry change constantly. Waterfall is generally reserved for government contracts or embedded systems where requirements are fixed from the start.</p>
            </div>
        `,
        quiz: [
            { type: 'mcq', question: 'Which SDLC methodology requires that each phase be completed and signed off before the next phase begins?', options: ['Agile', 'Scrum', 'Kanban', 'Waterfall'], answer: 'Waterfall' },
            { type: 'mcq', question: 'The Agile methodology prioritizes "working software" over what, according to the manifesto?', options: ['Individuals and interactions', 'Comprehensive documentation', 'Responding to change', 'Customer collaboration'], answer: 'Comprehensive documentation' },
        ],
    },
    {
        id: 3,
        title: 'L3: Requirements and Design Documentation',
        duration: '45 min',
        content: `
            <h2>The Importance of Documentation</h2>
            <p>In software engineering, documentation is the blueprint for development. It ensures everyone—from the customer to the developer—is aligned on what needs to be built and how it will function. Two critical types of documents are requirements and design.</p>

            <h3>Requirements Documentation (SRS)</h3>
            <p>The **Software Requirements Specification (SRS)** documents the functional and non-functional requirements of the system. This answers: **"What will the system do?"**</p>
            <ul>
                <li>**Functional Requirements:** Define the features and services the system provides (e.g., "The system shall allow users to log in with a valid username and password").</li>
                <li>**Non-functional Requirements:** Define the qualities of the system (e.g., **Performance:** "The system shall load the dashboard in under 2 seconds." **Security:** "All user data must be encrypted.").</li>
            </ul>

            <h3>Design Documentation</h3>
            <p>The Design Document details the high-level architecture and low-level component design. This answers: **"How will the system be built?"**</p>
            <ul>
                <li>**UML Diagrams:** **Unified Modeling Language** diagrams (like Class Diagrams or Use Case Diagrams) are used to visually model the system's structure and behavior.</li>
                <li>**Use Cases:** Describes how a user interacts with the system to achieve a specific goal (e.g., "User logs in" or "User creates a new order").</li>
            </ul>

            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span>The Engineer's Motto</span></div>
                <p>A poorly written requirement leads to poorly written code. A Software Engineer's first job is not to code, but to **ensure the requirements are complete, consistent, and unambiguous.**</p>
            </div>
        `,
        quiz: [
            { type: 'mcq', question: 'Which requirement specifies the qualities of a system, such as speed or security?', options: ['Functional Requirement', 'Business Requirement', 'Non-functional Requirement', 'User Story'], answer: 'Non-functional Requirement' },
            { type: 'mcq', question: 'The Software Requirements Specification (SRS) primarily answers which question?', options: ['How long will it take to build?', 'What will the system do?', 'What coding language is best?', 'How much will it cost?'], answer: 'What will the system do?' },
        ],
    },
    {
        id: 4,
        title: 'L4: Introduction to Design Patterns',
        duration: '75 min',
        content: `
            <h2>Solving Common Problems with Design Patterns</h2>
            <p>In software engineering, a **Design Pattern** is a reusable solution to a commonly occurring problem within a given context in software design. They are not finished designs that can be plugged straight into your code; they are templates or blueprints for how to solve a problem.</p>

            <h3>The Three Categories</h3>
            <p>Patterns are usually categorized into three groups:</p>
            <ol>
                <li>**Creational Patterns:** Concerned with the way objects are created (e.g., Factory, Singleton).</li>
                <li>**Structural Patterns:** Concerned with composing classes and objects (e.g., Adapter, Decorator).</li>
                <li>**Behavioral Patterns:** Concerned with communication between objects (e.g., Observer, Strategy).</li>
            </ol>

            <h3>Pattern Deep Dive: The Singleton Pattern (Creational)</h3>
            <p>The Singleton Pattern ensures a class has only **one instance** and provides a global point of access to it. This is useful for things like a single database connection pool or a global configuration manager.</p>
            <pre><code>// Example Concept: Singleton
class ConfigurationManager {
    private static instance: ConfigurationManager;
    private constructor() { /* Load settings */ }
    
    public static getInstance(): ConfigurationManager {
        if (!ConfigurationManager.instance) {
            ConfigurationManager.instance = new ConfigurationManager();
        }
        return ConfigurationManager.instance;
    }
}</code></pre>

            <h3>Pattern Deep Dive: The Factory Pattern (Creational)</h3>
            <p>The Factory Pattern provides an interface for creating objects in a superclass, but allows subclasses to alter the type of objects that will be created. This decouples the object creation logic from the client code.</p>
            <p style="color: var(--cyan-glow);">**Benefit:** Using design patterns leads to code that is more robust, reusable, and easier to maintain because it follows well-established engineering best practices.</p>
        `,
        quiz: [
            { type: 'mcq', question: 'A Design Pattern is best described as:', options: ['A finished, plug-and-play piece of code', 'A template for solving a common problem in a specific context', 'A legal contract for software design', 'A programming language feature'], answer: 'A template for solving a common problem in a specific context' },
            { type: 'mcq', question: 'Which creational pattern ensures a class has only one instance and provides a global access point?', options: ['Observer', 'Factory', 'Decorator', 'Singleton'], answer: 'Singleton' },
        ],
    },
    {
        id: 5,
        title: 'L5: Final Project: Architecting a System',
        duration: '90 min',
        content: `
            <h2>Course Capstone: The Architectural Design Document</h2>
            <p>Congratulations on completing the core lessons! Your final requirement is to apply the principles of Requirements Analysis, SDLC, and Design to create a professional **Architectural Design Document** for a new software system.</p>

            <h3>Project Brief: The "Elvion Academy Planner"</h3>
            <p>Design a system that allows Elvion University students to track their course progress, manage due dates, and visualize their overall Grade Point (GP) progress across all courses.</p>

            <h3>Required Sections for Submission</h3>
            <p>Your Design Document (PDF or Markdown file) must include the following sections (2000-word minimum total):</p>
            <ol>
                <li>**Overview & Goals:** (500 words) What is the system? What problem does it solve? Define the target user.</li>
                <li>**Requirements (SRS):** (500 words) Detail at least 5 **Functional** and 5 **Non-functional** requirements (e.g., Performance, Security, Usability).</li>
                <li>**SDLC Justification:** (300 words) Which methodology (Agile or Waterfall) would you choose for this project and why?</li>
                <li>**Architectural Design:** (700 words)
                    <ul>
                        <li>Propose a high-level architecture (e.g., 3-Tier, Microservices).</li>
                        <li>Identify two key components (e.g., Database, Authentication Service).</li>
                        <li>**Design Pattern Application:** Specify one Creational and one Structural/Behavioral design pattern you would use in a component and justify its use.</li>
                    </ul>
                </li>
            </ol>
            
            <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--success-color);">
                <div class="area-header" style="color: var(--success-color);"><span>Submission Instructions</span></div>
                <p>This is a non-code project. Your final submission is the written document. Save your document as: <strong>SWE101_YourName_DesignDoc.pdf</strong>.</p>
                <p style="color: var(--error-color); font-weight: bold;">**ACTION:** Email your final document to: <code>elvionailabs@gmail.com</code></p>
            </div>
            <p>Once you pass the final quiz below, click "Final Exam/Certificate" in the navigation bar to proceed with certificate request.</p>
        `,
        quiz: [
            { type: 'mcq', question: 'For the SWE101 course, what is the final deliverable requirement?', options: ['A full, working code application', 'An Architectural Design Document', 'A face-to-face interview', 'A group presentation'], answer: 'An Architectural Design Document' },
            { type: 'text', question: 'What is the email address to which you must submit your project for certificate review? (Enter exactly)', answer: 'elvionailabs@gmail.com' },
        ],
    }
];

    
    // Assembling all courses
    const allCourses = [
      { id: 'cs101', title: 'Computer Science', description: 'Fundamentals of computing, programming, and algorithms', icon: 'fas fa-laptop-code', totalLessons: 8, estimatedHours: 120, mediaType: 'video', lessons: cs101Lessons },
      // NEW SOFTWARE ENGINEERING COURSE
      { id: 'swe101', title: 'Software Engineering', description: 'Design, develop, and maintain large-scale software systems.', icon: 'fas fa-cogs', totalLessons: 5, estimatedHours: 80, mediaType: 'video', lessons: swe101Lessons },
      // OTHER COURSES WITH GENERATED PLACEHOLDERS
      { id: 'law101', title: 'Law (LLB)', description: 'Comprehensive study of legal principles and practice.', icon: 'fas fa-balance-scale', totalLessons: 6, estimatedHours: 90, mediaType: 'video', lessons: generateDefaultLessons(6, 'LAW', false) },
      { id: 'eng101', title: 'English & Literary Studies', description: 'Study of English language, literature, and critical analysis.', icon: 'fas fa-pen-nib', totalLessons: 4, estimatedHours: 60, mediaType: 'audio', lessons: generateDefaultLessons(4, 'ENG', false) },
      { id: 'his101', title: 'History & Strategic Studies', description: 'World history, Nigerian history, and strategic studies.', icon: 'fas fa-globe-africa', totalLessons: 5, estimatedHours: 75, mediaType: 'audio', lessons: generateDefaultLessons(5, 'HIS', false) },
      { id: 'bus101', title: 'Business Administration', description: 'Principles of management, marketing, finance, and entrepreneurship.', icon: 'fas fa-chart-line', totalLessons: 7, estimatedHours: 100, mediaType: 'audio', lessons: generateDefaultLessons(7, 'BUS', true) },
      { id: 'mass101', title: 'Mass Communication', description: 'Journalism, public relations, broadcasting, and digital media communication.', icon: 'fas fa-bullhorn', totalLessons: 6, estimatedHours: 90, mediaType: 'audio', lessons: generateDefaultLessons(6, 'MASS', false) },
      { id: 'math101', title: 'Mathematics Education', description: 'Methods and strategies for teaching mathematics.', icon: 'fas fa-calculator', totalLessons: 5, estimatedHours: 70, mediaType: 'audio', lessons: generateDefaultLessons(5, 'MATED', false) },
      { id: 'aed101', title: 'Adult Education', description: 'Teaching and learning strategies for adult learners.', icon: 'fas fa-chalkboard-teacher', totalLessons: 4, estimatedHours: 60, mediaType: 'audio', lessons: generateDefaultLessons(4, 'ADULT', false) },
      { 
          id: 'visart101', 
          title: 'Visual Arts & Digital Media', 
          description: 'A study of animation, painting, graphic design, and digital art.', 
          icon: 'fas fa-palette', 
          totalLessons: 6, 
          estimatedHours: 95, 
          mediaType: 'video', 
          lessons: generateDefaultLessons(6, 'VA', true) 
      },
    ];

    let currentUser = null;
    let userData = null;
    let currentCourse = null;
    let currentLesson = 1;
    let totalLessons = 0;
    let quizPassed = false; // New state to track if quiz is passed for navigation

    // URL Parameters
    const urlParams = new URLSearchParams(window.location.search);
    const courseId = urlParams.get('courseId');
    const lessonParam = urlParams.get('lesson');

    // ... (DOM Content Loaded and Star Animation code remains the same)

    // Mobile Menu Toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const courseSidebar = document.getElementById('courseSidebar');

    mobileMenuToggle.addEventListener('click', () => {
      courseSidebar.classList.toggle('active');
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 992) {
        if (!courseSidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
          courseSidebar.classList.remove('active');
        }
      }
    });

    // Auth State Management
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        currentUser = user;
        await loadUserData();
        await initializeCourseViewer();
      } else {
        // Redirect to enrollment page if not logged in
        window.location.href = 'enroll.html'; 
      }
    });

    async function loadUserData() {
      try {
        const userDocRef = doc(db, 'users', currentUser.uid);
        const userDoc = await getDoc(userDocRef);
        
        if (userDoc.exists()) {
          userData = userDoc.data();
          // Ensure totalPoints exists for new users
          if (userData.totalPoints === undefined) {
              userData.totalPoints = 0;
              await updateDoc(userDocRef, { totalPoints: 0 });
          }
        } else {
          // Redirect to dashboard (or enrollment flow) if user data is missing
          window.location.href = 'studyingatelvion.html'; 
        }
      } catch (error) {
        console.error('Error loading user data:', error);
        alert('Error loading user data. Please try again.');
      }
    }

    async function initializeCourseViewer() {
      if (!courseId) {
        alert('No course specified');
        window.location.href = 'studyingatelvion.html';
        return;
      }

      currentCourse = findCourseById(courseId);
      if (!currentCourse) {
        alert('Course not found');
        window.location.href = 'studyingatelvion.html';
        return;
      }

      totalLessons = currentCourse.totalLessons;
      currentLesson = parseInt(lessonParam) || 1;

      // Check if user is enrolled
      const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
      if (!enrolledCourse) {
        alert('You are not enrolled in this course');
        window.location.href = 'studyingatelvion.html';
        return;
      }

      setupCourseInterface();
      renderLessonsList();
      loadLesson(currentLesson);
      
      document.getElementById('loadingContainer').style.display = 'none';
      document.getElementById('contentHeader').style.display = 'flex';
      document.getElementById('mainContent').style.display = 'block';
      document.getElementById('lessonNavigation').style.display = 'flex';
    }

    function findCourseById(courseId) {
      return allCourses.find(c => c.id === courseId);
    }

    function setupCourseInterface() {
      document.getElementById('courseIconLarge').className = `course-icon-large ${currentCourse.icon}`;
      document.getElementById('courseTitle').textContent = currentCourse.title;
      document.getElementById('courseSubtitle').textContent = currentCourse.description;
      
      // Populate Certificate Form details
      document.getElementById('formSubject').value = `Certificate Request: ${currentCourse.title}`;
      document.getElementById('completedCourseName').value = currentCourse.title;

      updateOverallProgress();
    }

    function updateOverallProgress() {
      const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
      const progress = enrolledCourse?.progress || 0;
      const completedLessons = enrolledCourse?.completedLessons?.length || 0;
      
      document.getElementById('overallProgressBar').style.width = `${progress}%`;
      document.getElementById('overallProgressText').textContent = `${progress}% Complete (${completedLessons}/${totalLessons} lessons)`;
      
      // Update Total Points for GP (sidebar and nav)
      document.getElementById('totalPointsEarnedSidebar').textContent = userData.totalPoints || 0;
      document.getElementById('totalPointsEarnedNav').textContent = userData.totalPoints || 0;
      document.getElementById('formTotalPoints').value = userData.totalPoints || 0;
      document.getElementById('finalTotalPoints').textContent = userData.totalPoints || 0;
    }

    function renderLessonsList() {
      const container = document.getElementById('lessonsContainer');
      const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
      const completedLessons = enrolledCourse?.completedLessons || [];
      
      container.innerHTML = '';
      
      currentCourse.lessons.forEach((lesson) => {
        const lessonNumber = lesson.id;
        const isCompleted = completedLessons.includes(lessonNumber);
        const isCurrent = lessonNumber === currentLesson;
        const isAccessible = lessonNumber <= (enrolledCourse?.currentLesson || 1);
        
        const lessonItem = document.createElement('div');
        lessonItem.className = `lesson-item ${isCurrent ? 'active' : ''} ${isCompleted ? 'completed' : ''}`;
        
        let statusIcon, statusClass;
        if (isCompleted) {
          statusIcon = '<i class="fas fa-check"></i>';
          statusClass = 'completed';
        } else if (isCurrent) {
          statusIcon = lessonNumber;
          statusClass = 'current';
        } else if (isAccessible) {
          statusIcon = lessonNumber;
          statusClass = ''; // Accessible but not current/completed
        } else {
          statusIcon = '<i class="fas fa-lock"></i>';
          statusClass = 'locked';
        }
        
        lessonItem.innerHTML = `
          <div class="lesson-status ${statusClass}">${statusIcon}</div>
          <div class="lesson-details">
            <div class="lesson-title">${lesson.title}</div>
            <div class="lesson-duration">${lesson.duration}</div>
          </div>
        `;
        
        if (isAccessible) {
          lessonItem.style.cursor = 'pointer';
          lessonItem.addEventListener('click', () => {
            if (lessonNumber !== currentLesson) {
              loadLesson(lessonNumber);
              courseSidebar.classList.remove('active'); // Close on mobile navigation
            }
          });
        } else {
          lessonItem.style.opacity = '0.5';
          lessonItem.style.cursor = 'not-allowed';
        }
        
        container.appendChild(lessonItem);
      });
      
      // Add the final certificate page link
      if (enrolledCourse?.progress === 100) {
          const finalItem = document.createElement('div');
          finalItem.className = `lesson-item ${currentLesson === totalLessons + 1 ? 'active' : ''}`;
          finalItem.style.borderLeftColor = 'var(--success-color)';
          finalItem.innerHTML = `
            <div class="lesson-status completed" style="background: var(--success-color);"><i class="fas fa-certificate"></i></div>
            <div class="lesson-details">
                <div class="lesson-title" style="color: var(--success-color); font-weight: 700;">Final Exam/Certificate</div>
                <div class="lesson-duration">Your Course GP is Ready</div>
            </div>
          `;
          finalItem.style.cursor = 'pointer';
          finalItem.addEventListener('click', () => {
             loadLesson(totalLessons + 1);
             courseSidebar.classList.remove('active'); // Close on mobile navigation
          });
          container.appendChild(finalItem);
      }
    }

    function loadLesson(lessonNumber) {
      currentLesson = lessonNumber;
      quizPassed = false; // Reset quiz state for the new lesson
      
      // Update URL without reloading
      const newUrl = new URL(window.location);
      newUrl.searchParams.set('lesson', lessonNumber);
      window.history.pushState({}, '', newUrl);
      
      // Hide all main content elements first
      document.getElementById('finalCoursePage').style.display = 'none';
      document.getElementById('contentHeader').style.display = 'flex';
      document.getElementById('lessonNavigation').style.display = 'flex';
      const contentCard = document.querySelector('.content-card');
      const quizContainer = document.getElementById('quizContainer');
      const mediaPlayer = document.getElementById('mediaPlayer');
      
      contentCard.style.display = 'block';
      mediaPlayer.style.display = 'flex';
      
      if (currentLesson === totalLessons + 1) {
          // Final Page Logic
          document.getElementById('contentHeader').style.display = 'none';
          document.getElementById('lessonNavigation').style.display = 'none';
          document.getElementById('finalCoursePage').style.display = 'block';
          contentCard.style.display = 'none';
          quizContainer.style.display = 'none';
          mediaPlayer.style.display = 'none';
          
          updateOverallProgress(); // Refresh GP
      } else {
          // Lesson Page Logic
          const lesson = currentCourse.lessons.find(l => l.id === lessonNumber);
          if (!lesson) return;

          // Update header
          document.getElementById('lessonTitle').textContent = lesson.title;
          document.getElementById('lessonDuration').textContent = lesson.duration;
          document.getElementById('currentLessonNumber').textContent = lessonNumber;
          document.getElementById('totalLessons').textContent = totalLessons;
          document.getElementById('lessonPoints').textContent = '10'; 
          document.getElementById('markCompleteBtn').style.display = 'none'; 
          
          // Update navigation
          document.getElementById('navCurrentLesson').textContent = lessonNumber;
          document.getElementById('navTotalLessons').textContent = totalLessons;
          
          // Update content
          document.getElementById('lessonContent').innerHTML = lesson.content;

          // Update media player
          const mediaPlaceholderText = document.getElementById('mediaPlaceholderText');
          if (currentCourse.mediaType === 'audio') {
            mediaPlayer.innerHTML = `
                <audio controls style="width:100%; height: auto; outline:none; border-radius:10px; box-shadow:0 0 8px var(--cyan-glow);">
                    <source src="university/generic_audio.mp3" type="audio/mpeg">
                    Your browser does not support the audio element.
                </audio>
            `;
            mediaPlaceholderText.textContent = 'Audio content for this lesson is available above.';
          } else { 
            mediaPlayer.innerHTML = `
              <div class="media-placeholder">
                <i class="fas fa-play-circle"></i>
                <p id="mediaPlaceholderText">Video content coming soon</p>
                <p style="font-size: 0.9rem; opacity: 0.7;">For now, please read the lesson content below</p>
              </div>
            `;
            mediaPlaceholderText.textContent = 'Video content coming soon';
          }
          
          // Render Quiz
          const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
          const isCompleted = enrolledCourse?.completedLessons?.includes(currentLesson);
          
          if (lesson.quiz) {
            quizContainer.style.display = 'block';
            renderQuiz(lesson.quiz, isCompleted);
          } else {
            quizContainer.style.display = 'none';
          }
      }
      
      // Update navigation buttons and state
      updateNavigationControls();
      
      // Update sidebar
      renderLessonsList();
      
      // Scroll to top
      window.scrollTo(0, 0);
    }

    function updateNavigationControls() {
      const prevBtn = document.getElementById('prevLessonBtn');
      const nextBtn = document.getElementById('nextLessonBtn');
      const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
      const isCompleted = enrolledCourse?.completedLessons?.includes(currentLesson);
      const isCourseFullyCompleted = enrolledCourse?.progress === 100;

      // Previous Button Logic
      prevBtn.disabled = currentLesson <= 1;
      
      // Next Button Logic
      if (currentLesson === totalLessons) {
          nextBtn.textContent = 'Final Exam/Certificate';
          // Enable only if all lessons are completed (progress 100%)
          nextBtn.disabled = !isCourseFullyCompleted && !isCompleted; // Use isCompleted as a fallback if progress hasn't updated immediately
      } else if (currentLesson === totalLessons + 1) {
          // On Final Page, next is always disabled
          nextBtn.textContent = 'Course Completed';
          nextBtn.disabled = true;
      } else if (isCompleted || quizPassed) {
          nextBtn.textContent = 'Next Lesson';
          nextBtn.disabled = false;
      } else {
          nextBtn.textContent = 'Pass Quiz to Unlock';
          nextBtn.disabled = true;
      }
    }
    
    // --- QUIZ LOGIC (Updated to include animation/feedback) ---

    function renderQuiz(quizData, isLessonCompleted) {
        const quizQuestionsContainer = document.getElementById('quizQuestions');
        quizQuestionsContainer.innerHTML = '';
        document.getElementById('quizResult').innerHTML = ''; // Clear result area
        
        // Hide submit button if lesson is already completed
        const submitBtn = document.getElementById('submitQuizBtn');
        submitBtn.style.display = isLessonCompleted ? 'none' : 'block';

        quizData.forEach((q, index) => {
            const questionElement = document.createElement('div');
            questionElement.className = 'quiz-question-wrapper';
            questionElement.style.marginBottom = '2rem'; // Separating questions

            questionElement.innerHTML = `
                <div class="quiz-question">Question ${index + 1}: ${q.question}</div>
                <div class="quiz-options" data-question-index="${index}">
                    ${q.type === 'mcq' ? q.options.map(option => `
                        <div class="quiz-option" data-answer="${option}" ${isLessonCompleted ? 'style="cursor: default;"' : ''}>${option}</div>
                    `).join('') : ''}
                    ${q.type === 'text' ? `
                        <input type="text" class="text-input-answer" placeholder="Type your answer here..." style="width: 100%; padding: 1rem; border-radius: 8px; border: 2px solid rgba(0, 255, 255, 0.3); background: rgba(0, 0, 0, 0.5); color: var(--text-color); font-size: 1rem;" ${isLessonCompleted ? 'disabled' : ''}>
                    ` : ''}
                </div>
            `;
            quizQuestionsContainer.appendChild(questionElement);
        });

        // Add event listeners for MCQ selection only if not completed
        if (!isLessonCompleted) {
            quizQuestionsContainer.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function() {
                    const optionsGroup = this.closest('.quiz-options');
                    // Deselect all others in the group
                    optionsGroup.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
                    // Select the clicked one
                    this.classList.add('selected');
                });
            });
        } else {
             // If completed, visually mark the correct answer on load
            quizData.forEach((q, index) => {
                if (q.type === 'mcq') {
                    const optionsGroup = document.querySelector(`.quiz-options[data-question-index="${index}"]`);
                    // Mark the correct answer
                    optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                } else if (q.type === 'text') {
                     const input = document.querySelector(`.quiz-options[data-question-index="${index}"] .text-input-answer`);
                     input.value = q.answer;
                     input.style.border = `2px solid var(--success-color)`;
                }
            });
             document.getElementById('quizResult').innerHTML = `<div class="quiz-feedback correct"><i class="fas fa-check-circle"></i> **Lesson Already Completed!** You may move to the next lesson.</div>`;
             quizPassed = true;
             updateNavigationControls();
        }
    }

    document.getElementById('submitQuizBtn').addEventListener('click', () => {
        const lesson = currentCourse.lessons.find(l => l.id === currentLesson);
        const quizData = lesson.quiz;
        let allCorrect = true;
        let score = 0;
        
        // Reset and evaluate
        quizData.forEach((q, index) => {
            const optionsGroup = document.querySelector(`.quiz-options[data-question-index="${index}"]`);
            let isCorrect = false;

            if (q.type === 'mcq') {
                const selectedOption = optionsGroup.querySelector('.quiz-option.selected');
                
                // Clear all previous result classes and animation classes first
                optionsGroup.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('correct', 'incorrect'));

                if (selectedOption) {
                    if (selectedOption.dataset.answer === q.answer) {
                        isCorrect = true;
                        selectedOption.classList.add('correct');
                    } else {
                        selectedOption.classList.add('incorrect');
                        // Highlight the correct answer
                        optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`).classList.add('correct');
                    }
                } else {
                    // User did not select an answer, fail and highlight correct answer
                    optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                }
            } else if (q.type === 'text') {
                const input = optionsGroup.querySelector('.text-input-answer');
                const userAnswer = input.value.trim().toLowerCase();
                const correctAnswer = q.answer.trim().toLowerCase();
                
                if (userAnswer === correctAnswer) {
                    isCorrect = true;
                    input.style.border = `2px solid var(--success-color)`;
                } else {
                    input.style.border = `2px solid var(--error-color)`;
                    // Note: No easy way to show correct text answer without disrupting the UI, just show error
                }
            }

            if (isCorrect) {
                score++;
            } else {
                allCorrect = false;
            }
        });

        const quizResultElement = document.getElementById('quizResult');
        const totalQuestions = quizData.length;
        
        if (allCorrect) {
            quizResultElement.innerHTML = `
                <div class="quiz-feedback correct">
                    <i class="fas fa-check-circle"></i> **Perfect Score!** You got ${score}/${totalQuestions} correct. Lesson unlocked!
                </div>
            `;
            // All correct! Mark lesson complete and show modal.
            markLessonComplete();
            document.getElementById('submitQuizBtn').style.display = 'none'; // Hide submit after passing
        } else {
            quizResultElement.innerHTML = `
                <div class="quiz-feedback incorrect">
                    <i class="fas fa-times-circle"></i> **Incorrect Answers.** Score: ${score}/${totalQuestions}. Please review the lesson and try again.
                </div>
            `;
            // Disable navigation controls if quiz failed
            quizPassed = false;
            updateNavigationControls();
        }
    });

    // --- END QUIZ LOGIC ---


    // Event Listeners
    document.getElementById('prevLessonBtn').addEventListener('click', () => {
      if (currentLesson === totalLessons + 1) {
          loadLesson(totalLessons); // Back from final page to last lesson
      } else if (currentLesson > 1) {
        loadLesson(currentLesson - 1);
      }
    });

    document.getElementById('nextLessonBtn').addEventListener('click', () => {
      if (currentLesson < totalLessons) {
        // This is only enabled if the lesson is completed/quiz is passed
        loadLesson(currentLesson + 1);
      } else if (currentLesson === totalLessons) {
          // Go to final page (Only enabled if progress is 100)
          const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
          if (enrolledCourse?.progress === 100 || enrolledCourse?.completedLessons?.includes(totalLessons)) {
              loadLesson(currentLesson + 1);
          }
      }
    });

    document.getElementById('continueBtn').addEventListener('click', () => {
      document.getElementById('completionModal').style.display = 'none';
      if (currentLesson < totalLessons) {
        loadLesson(currentLesson + 1);
      } else if (currentLesson === totalLessons) {
          loadLesson(currentLesson + 1); // Go to the final certificate page
      }
    });

    // Corrected Dashboard Redirect
    document.getElementById('backToDashboardBtn').addEventListener('click', () => {
      window.location.href = 'studyingatelvion.html';
    });

    async function markLessonComplete() {
      try {
        const enrolledCourseIndex = userData.enrolledCourses.findIndex(c => c.courseId === courseId);
        if (enrolledCourseIndex === -1) return;
        
        const enrolledCourse = userData.enrolledCourses[enrolledCourseIndex];
        
        // Check for double completion (to prevent point inflation)
        if (enrolledCourse.completedLessons?.includes(currentLesson)) {
            // Already completed, just update session state and show modal
            quizPassed = true; 
            updateNavigationControls();
            document.getElementById('pointsEarned').textContent = '0 (Already earned)';
            document.getElementById('completionModal').style.display = 'flex';
            return;
        }

        // Add to completed lessons
        if (!enrolledCourse.completedLessons) {
            enrolledCourse.completedLessons = [];
        }
        enrolledCourse.completedLessons.push(currentLesson);
        
        // Update current lesson access: currentLesson + 1
        enrolledCourse.currentLesson = Math.max(enrolledCourse.currentLesson || 1, currentLesson + 1);
        
        // Calculate progress
        const completedCount = enrolledCourse.completedLessons.length;
        enrolledCourse.progress = Math.round((completedCount / totalLessons) * 100);
        
        // Update user data: GP/Points logic is here
        userData.enrolledCourses[enrolledCourseIndex] = enrolledCourse;
        userData.completedLessons = (userData.completedLessons || 0) + 1;
        userData.totalPoints = (userData.totalPoints || 0) + 10; // 10 points per lesson
        
        // Save to database
        await updateDoc(doc(db, 'users', currentUser.uid), {
          enrolledCourses: userData.enrolledCourses,
          completedLessons: userData.completedLessons,
          totalPoints: userData.totalPoints
        });
        
        // Update UI
        updateOverallProgress();
        renderLessonsList();
        
        // Mark Quiz as passed for this session
        quizPassed = true; 
        updateNavigationControls();
        
        // Show completion modal
        document.getElementById('pointsEarned').textContent = '10';
        document.getElementById('completionModal').style.display = 'flex';
        
      } catch (error) {
        console.error('Error marking lesson complete:', error);
        alert('Error updating progress. Please try again.');
      }
    }

    // Initialize stars (outside of DOMContentLoaded to be safe with module imports)
    document.addEventListener('DOMContentLoaded', () => {
        const starsContainer = document.getElementById('stars-container');
        const numStars = 100;
        const minSize = 1;
        const maxSize = 3;
        for (let i = 0; i < numStars; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            const size = Math.random() * (maxSize - minSize) + minSize;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 4}s`;
            star.style.animationDuration = `${3 + Math.random() * 2}s`;
            starsContainer.appendChild(star);
        }
    });

  </script>
</body>
  </html>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date()); 

  gtag('config', 'G-J1YTKP10ZX');
</script>
