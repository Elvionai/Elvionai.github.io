<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Dashboard | Elvion University</title>
  <meta name="description" content="Your personalized learning dashboard at Elvion University">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --dark-navy: #00001a;
      --black-bg: #000000;
      --cyan-glow: #00ffff;
      --light-blue-glow: #00aaff;
      --text-color: #e0e0e0;
      --heading-color: #ffffff;
      --gradient-start: #0a1128;
      --gradient-end: #121a30;
      --card-bg: rgba(18, 26, 48, 0.85);
      --border-glow: 0 0 10px var(--cyan-glow), 0 0 20px var(--light-blue-glow);
      --hover-glow: 0 0 15px var(--cyan-glow), 0 0 30px var(--light-blue-glow);
      --button-bg: linear-gradient(45deg, var(--cyan-glow), var(--light-blue-glow));
      --button-text-color: var(--black-bg);
      --star-color: rgba(255, 255, 255, 0.7);
      --sidebar-width: 260px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--black-bg);
      color: var(--text-color);
      line-height: 1.7;
      overflow-x: hidden;
      position: relative;
      min-height: 100vh;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Orbitron', sans-serif;
      color: var(--heading-color);
      margin-top: 0;
    }

    #stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .star {
      position: absolute;
      background-color: var(--star-color);
      border-radius: 50%;
      opacity: 0;
      animation: twinkle 4s infinite ease-in-out;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0; transform: scale(0.5); }
      50% { opacity: 1; transform: scale(1); }
    }

    .dashboard-container {
      display: flex;
      min-height: 100vh;
      position: relative;
      z-index: 1;
    }

    /* Sidebar Navigation */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(0, 255, 255, 0.2);
      padding: 2rem 0;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .sidebar-header {
      padding: 0 1.5rem 2rem 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .sidebar-logo {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      margin-bottom: 1.5rem;
      cursor: pointer;
    }

    .sidebar-logo img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      box-shadow: 0 0 10px var(--cyan-glow);
    }

    .sidebar-logo-text {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--heading-color);
      text-shadow: var(--border-glow);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 0.8rem;
    }

    .user-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--cyan-glow), var(--light-blue-glow));
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 1.2rem;
      color: var(--black-bg);
      box-shadow: var(--border-glow);
      cursor: pointer;
    }

    .user-avatar img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      object-fit: cover;
    }

    .user-details {
      flex: 1;
    }

    .user-name {
      font-weight: 600;
      color: var(--heading-color);
      font-size: 0.95rem;
    }

    .user-level {
      font-size: 0.8rem;
      color: var(--cyan-glow);
    }

    .nav-menu {
      list-style: none;
      padding: 1.5rem 0;
    }

    .nav-item {
      margin-bottom: 0.3rem;
    }

    .nav-link {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 0.9rem 1.5rem;
      color: var(--text-color);
      text-decoration: none;
      transition: all 0.3s ease;
      position: relative;
      cursor: pointer;
    }

    .nav-link:hover,
    .nav-link.active {
      background: rgba(0, 255, 255, 0.1);
      color: var(--cyan-glow);
    }

    .nav-link.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--button-bg);
      box-shadow: var(--border-glow);
    }

    .nav-link i {
      width: 20px;
      text-align: center;
      font-size: 1.1rem;
    }

    .sidebar-footer {
      padding: 1.5rem;
      border-top: 1px solid rgba(0, 255, 255, 0.1);
      margin-top: auto;
    }

    .logout-btn {
      width: 100%;
      padding: 0.8rem;
      background: rgba(255, 0, 0, 0.1);
      border: 1px solid rgba(255, 0, 0, 0.3);
      color: #ff4444;
      border-radius: 8px;
      cursor: pointer;
      font-family: 'Inter', sans-serif;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .logout-btn:hover {
      background: rgba(255, 0, 0, 0.2);
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }

    /* Main Content */
    .main-content {
      flex: 1;
      margin-left: var(--sidebar-width);
      padding: 2rem;
      max-width: 1400px;
    }

    .content-section {
      display: none;
    }

    .content-section.active {
      display: block;
    }

    /* Mobile Menu Toggle */
    .mobile-menu-toggle {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 101;
      background: var(--card-bg);
      border: 1px solid var(--cyan-glow);
      border-radius: 8px;
      padding: 0.5rem 0.8rem;
      color: var(--cyan-glow);
      cursor: pointer;
      box-shadow: var(--border-glow);
    }

    /* Welcome Section */
    .welcome-section {
      margin-bottom: 2rem;
      padding: 2rem;
      background: var(--card-bg);
      border-radius: 15px;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
    }

    .welcome-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .welcome-text h1 {
      font-size: 2rem;
      margin-bottom: 0.5rem;
      text-shadow: var(--border-glow);
    }

    .welcome-text p {
      color: var(--text-color);
      opacity: 0.9;
    }

    .streak-badge {
      display: flex;
      align-items: center;
      gap: 0.8rem;
      padding: 1rem 1.5rem;
      background: rgba(255, 140, 0, 0.1);
      border: 2px solid rgba(255, 140, 0, 0.4);
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(255, 140, 0, 0.2);
    }

    .streak-icon {
      font-size: 2rem;
      color: #ff8c00;
      animation: flameFlicker 1.5s infinite alternate;
    }

    @keyframes flameFlicker {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(1.1); opacity: 0.8; }
    }

    .streak-info {
      text-align: left;
    }

    .streak-number {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--heading-color);
    }

    .streak-label {
      font-size: 0.85rem;
      color: var(--text-color);
    }

    /* Stats Overview */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--hover-glow);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--button-bg);
      box-shadow: var(--border-glow);
    }

    .stat-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1rem;
    }

    .stat-icon {
      font-size: 2rem;
      color: var(--cyan-glow);
      text-shadow: 0 0 10px var(--cyan-glow);
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--heading-color);
      font-family: 'Orbitron', sans-serif;
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
    }

    .stat-trend {
      font-size: 0.85rem;
      color: #4ade80;
      margin-top: 0.5rem;
    }

    /* Course Grid */
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .section-title {
      font-size: 1.8rem;
      color: var(--heading-color);
      text-shadow: var(--border-glow);
    }

    .view-all-btn {
      padding: 0.6rem 1.5rem;
      background: transparent;
      border: 2px solid var(--cyan-glow);
      color: var(--cyan-glow);
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .view-all-btn:hover {
      background: var(--cyan-glow);
      color: var(--black-bg);
      box-shadow: var(--border-glow);
    }

    .courses-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }

    .course-card {
      background: var(--card-bg);
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }

    .course-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--hover-glow);
    }

    .course-thumbnail {
      width: 100%;
      height: 160px;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }

    .course-thumbnail::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(0,255,255,0.1) 0%, transparent 70%);
      animation: rotate 20s linear infinite;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .course-icon {
      font-size: 4rem;
      color: var(--cyan-glow);
      text-shadow: var(--border-glow);
      position: relative;
      z-index: 1;
    }

    .course-body {
      padding: 1.5rem;
    }

    .course-title {
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
      color: var(--heading-color);
    }

    .course-description {
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 1rem;
      line-height: 1.5;
    }

    .course-progress {
      margin-bottom: 1rem;
    }

    .progress-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 0.5rem;
      font-size: 0.85rem;
    }

    .progress-label {
      color: var(--text-color);
    }

    .progress-percentage {
      color: var(--cyan-glow);
      font-weight: 600;
    }

    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--button-bg);
      border-radius: 10px;
      transition: width 1s ease;
      box-shadow: 0 0 10px var(--cyan-glow);
    }

    .course-footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: 1rem;
      border-top: 1px solid rgba(0, 255, 255, 0.1);
    }

    .course-meta {
      display: flex;
      gap: 1rem;
      font-size: 0.85rem;
      color: var(--text-color);
    }

    .course-meta span {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .action-btn {
      padding: 0.6rem 1.2rem;
      background: var(--button-bg);
      color: var(--button-text-color);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .action-btn:hover {
      box-shadow: var(--border-glow);
      transform: scale(1.05);
    }

    .action-btn.secondary {
      background: transparent;
      border: 2px solid var(--cyan-glow);
      color: var(--cyan-glow);
    }

    .action-btn.secondary:hover {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    /* Settings Page */
    .settings-container {
      max-width: 800px;
    }

    .settings-card {
      background: var(--card-bg);
      padding: 2rem;
      border-radius: 12px;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
    }

    .settings-section-title {
      font-size: 1.3rem;
      color: var(--heading-color);
      margin-bottom: 1.5rem;
      padding-bottom: 0.8rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-label {
      display: block;
      font-size: 0.9rem;
      color: var(--cyan-glow);
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    .form-input {
      width: 100%;
      padding: 0.8rem;
      background: rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(0, 255, 255, 0.2);
      border-radius: 8px;
      color: var(--text-color);
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--cyan-glow);
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.2);
    }

    textarea.form-input {
      resize: vertical;
      min-height: 100px;
    }

    .avatar-upload {
      display: flex;
      align-items: center;
      gap: 1.5rem;
      margin-bottom: 1.5rem;
    }

    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--cyan-glow), var(--light-blue-glow));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      color: var(--black-bg);
      font-weight: 700;
      box-shadow: var(--border-glow);
      overflow: hidden;
    }

    .avatar-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .avatar-upload-btn {
      padding: 0.8rem 1.5rem;
      background: transparent;
      border: 2px solid var(--cyan-glow);
      color: var(--cyan-glow);
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .avatar-upload-btn:hover {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .save-btn {
      padding: 0.8rem 2rem;
      background: var(--button-bg);
      color: var(--button-text-color);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      font-size: 1rem;
    }

    .save-btn:hover {
      box-shadow: var(--border-glow);
      transform: scale(1.05);
    }

    /* Loading State */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 50vh;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(0, 255, 255, 0.1);
      border-top-color: var(--cyan-glow);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      margin-top: 1rem;
      color: var(--text-color);
      font-size: 1.1rem;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 3rem;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
    }

    .empty-state-icon {
      font-size: 4rem;
      color: var(--cyan-glow);
      margin-bottom: 1rem;
      opacity: 0.5;
    }

    .empty-state-title {
      font-size: 1.5rem;
      color: var(--heading-color);
      margin-bottom: 0.5rem;
    }

    .empty-state-description {
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 1.5rem;
    }

    .faculty-section {
      margin-bottom: 3rem;
    }

    .faculty-title {
      font-size: 1.5rem;
      color: var(--light-blue-glow);
      text-shadow: 0 0 10px var(--light-blue-glow);
      margin-bottom: 0.5rem;
    }

    .faculty-description {
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 1.5rem;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .sidebar {
        transform: translateX(-100%);
      }

      .sidebar.active {
        transform: translateX(0);
      }

      .main-content {
        margin-left: 0;
        padding: 5rem 1rem 1rem 1rem;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .stats-grid {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      }

      .courses-grid {
        grid-template-columns: 1fr;
      }

      .welcome-header {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    @media (max-width: 768px) {
      .welcome-section {
        padding: 1.5rem;
      }

      .welcome-text h1 {
        font-size: 1.5rem;
      }

      .section-title {
        font-size: 1.4rem;
      }

      .stat-card {
        padding: 1rem;
      }

      .course-body {
        padding: 1rem;
      }

      .avatar-upload {
        flex-direction: column;
      }
    }

    .success-message {
      padding: 1rem;
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
      border-radius: 8px;
      color: #4ade80;
      margin-bottom: 1rem;
      display: none;
    }

    .error-message {
      padding: 1rem;
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.3);
      border-radius: 8px;
      color: #f87171;
      margin-bottom: 1rem;
      display: none;
    }

    .hidden-file-input {
      display: none;
    }
  </style>
</head>
<body>
  <div id="stars-container"></div>

  <button class="mobile-menu-toggle" id="mobileMenuToggle">
    <i class="fas fa-bars"></i>
  </button>

  <div class="dashboard-container">
    <!-- Sidebar Navigation -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-logo" onclick="showSection('dashboard')">
          <img src="https://i.postimg.cc/PqVhDskJ/file-00000000c7646246889393752cff8df2.png" alt="Elvion University">
          <span class="sidebar-logo-text">Elvion</span>
        </div>
        <div class="user-info">
          <div class="user-avatar" id="sidebarAvatar">A</div>
          <div class="user-details">
            <div class="user-name" id="sidebarUserName">Loading...</div>
            <div class="user-level" id="sidebarUserLevel">Novice Learner</div>
          </div>
        </div>
      </div>

      <nav>
        <ul class="nav-menu">
          <li class="nav-item">
            <div class="nav-link active" onclick="showSection('dashboard')" data-section="dashboard">
              <i class="fas fa-home"></i>
              <span>Dashboard</span>
            </div>
          </li>
          <li class="nav-item">
            <div class="nav-link" onclick="showSection('courses')" data-section="courses">
              <i class="fas fa-book"></i>
              <span>All Courses</span>
            </div>
          </li>
          <li class="nav-item">
            <div class="nav-link" onclick="showSection('my-learning')" data-section="my-learning">
              <i class="fas fa-graduation-cap"></i>
              <span>My Learning</span>
            </div>
          </li>
          <li class="nav-item">
            <div class="nav-link" onclick="showSection('settings')" data-section="settings">
              <i class="fas fa-cog"></i>
              <span>Settings</span>
            </div>
          </li>
        </ul>
      </nav>

      <div class="sidebar-footer">
        <button class="logout-btn" id="logoutBtn">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
      <div class="loading-container" id="loadingContainer">
        <div class="loading-spinner"></div>
        <p class="loading-text">Loading your dashboard...</p>
      </div>

      <!-- Dashboard Section -->
      <div id="dashboard-section" class="content-section active" style="display: none;">
        <section class="welcome-section">
          <div class="welcome-header">
            <div class="welcome-text">
              <h1>Welcome back, <span id="welcomeName">Student</span>! ðŸ‘‹</h1>
              <p id="motivationalQuote">Keep learning, keep growing. Your future is being built today.</p>
            </div>
            <div class="streak-badge">
              <i class="fas fa-fire streak-icon"></i>
              <div class="streak-info">
                <div class="streak-number" id="streakNumber">0</div>
                <div class="streak-label">Day Streak</div>
              </div>
            </div>
          </div>
        </section>

        <section class="stats-grid">
          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="totalCourses">0</div>
                <div class="stat-label">Active Courses</div>
              </div>
              <i class="fas fa-book-open stat-icon"></i>
            </div>
            <div class="stat-trend">
              <i class="fas fa-arrow-up"></i> Keep learning!
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="completedLessons">0</div>
                <div class="stat-label">Lessons Completed</div>
              </div>
              <i class="fas fa-check-circle stat-icon"></i>
            </div>
            <div class="stat-trend">
              <i class="fas fa-arrow-up"></i> Great progress!
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="totalPoints">0</div>
                <div class="stat-label">Total Points</div>
              </div>
              <i class="fas fa-star stat-icon"></i>
            </div>
            <div class="stat-trend">
              <i class="fas fa-arrow-up"></i> Earning rewards!
            </div>
          </div>

          <div class="stat-card">
            <div class="stat-header">
              <div>
                <div class="stat-value" id="studyHours">0h</div>
                <div class="stat-label">Study Hours</div>
              </div>
              <i class="fas fa-clock stat-icon"></i>
            </div>
            <div class="stat-trend">
              <i class="fas fa-arrow-up"></i> Time well spent!
            </div>
          </div>
        </section>

        <section>
          <div class="section-header">
            <h2 class="section-title">Continue Learning</h2>
            <button class="view-all-btn" onclick="showSection('my-learning')">View All</button>
          </div>
          <div class="courses-grid" id="dashboardCoursesGrid"></div>
        </section>
      </div>

      <!-- All Courses Section -->
      <div id="courses-section" class="content-section">
        <div class="section-header">
          <h2 class="section-title">Course Catalog</h2>
          <p style="color: var(--text-color); opacity: 0.8;">Browse all available courses and start learning instantly</p>
        </div>

        <div id="allCoursesContainer"></div>
      </div>

      <!-- My Learning Section -->
      <div id="my-learning-section" class="content-section">
        <div class="section-header">
          <h2 class="section-title">My Learning</h2>
          <button class="view-all-btn" onclick="showSection('courses')">Browse More Courses</button>
        </div>
        <div class="courses-grid" id="myLearningGrid"></div>
      </div>

      <!-- Settings Section -->
      <div id="settings-section" class="content-section">
        <div class="settings-container">
          <div class="section-header">
            <h2 class="section-title">Settings</h2>
          </div>

          <div id="settingsSuccessMessage" class="success-message">
            <i class="fas fa-check-circle"></i> Settings saved successfully!
          </div>

          <div id="settingsErrorMessage" class="error-message">
            <i class="fas fa-exclamation-circle"></i> <span id="errorMessageText"></span>
          </div>

          <div class="settings-card">
            <h3 class="settings-section-title">Profile Information</h3>
            
            <div class="avatar-upload">
              <div class="avatar-preview" id="settingsAvatarPreview">A</div>
              <div>
                <button class="avatar-upload-btn" onclick="document.getElementById('avatarInput').click()">
                  <i class="fas fa-camera"></i> Change Avatar
                </button>
                <input type="file" id="avatarInput" class="hidden-file-input" accept="image/*">
                <p style="font-size: 0.85rem; color: var(--text-color); opacity: 0.7; margin-top: 0.5rem;">
                  Recommended: Square image, max 2MB
                </p>
              </div>
            </div>

            <form id="profileForm">
              <div class="form-group">
                <label class="form-label">Full Name</label>
                <input type="text" class="form-input" id="settingsName" placeholder="Your full name" required>
              </div>

              <div class="form-group">
                <label class="form-label">Email Address</label>
                <input type="email" class="form-input" id="settingsEmail" placeholder="your.email@example.com" disabled>
                <p style="font-size: 0.85rem; color: var(--text-color); opacity: 0.6; margin-top: 0.5rem;">
                  Email cannot be changed after registration
                </p>
              </div>

              <div class="form-group">
                <label class="form-label">Bio</label>
                <textarea class="form-input" id="settingsBio" placeholder="Tell us about yourself..."></textarea>
              </div>

              <button type="submit" class="save-btn">
                <i class="fas fa-save"></i> Save Changes
              </button>
            </form>
          </div>

          <div class="settings-card">
            <h3 class="settings-section-title">Account Security</h3>
            
            <div class="form-group">
              <label class="form-label">Change Password</label>
              <p style="font-size: 0.9rem; color: var(--text-color); opacity: 0.8; margin-bottom: 1rem;">
                For security reasons, password changes are handled through email verification.
              </p>
              <button class="action-btn secondary" id="resetPasswordBtn">
                <i class="fas fa-key"></i> Send Password Reset Email
              </button>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      signOut,
      sendPasswordResetEmail,
      updateProfile
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import {
      getFirestore,
      doc,
      getDoc,
      setDoc,
      updateDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";
    import {
      getStorage,
      ref,
      uploadBytes,
      getDownloadURL
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-storage.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAyROm0aBGjry6NUfhNM3e0qwPcCDoIqSk",
      authDomain: "elvionai.firebaseapp.com",
      projectId: "elvionai",
      storageBucket: "elvionai.firebasestorage.app",
      messagingSenderId: "161078300830",
      appId: "1:161078300830:web:f460df8591704eb0e96b8f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    const storage = getStorage(app);

    // Available Courses Data
    const coursesDatabase = {
      'science-tech': {
        facultyName: 'Faculty of Science & Technology',
        facultyDescription: 'Build your future in technology with courses designed for the digital economy.',
        courses: [
          {
            id: 'cs101',
            title: 'Computer Science',
            description: 'Fundamentals of computing, programming, and algorithms',
            icon: 'fas fa-laptop-code',
            totalLessons: 8,
            estimatedHours: 120,
            lessons: [
              { id: 1, title: 'Introduction to Programming', duration: '45 min', content: 'Learn the basics of programming concepts...' },
              { id: 2, title: 'Data Structures', duration: '60 min', content: 'Understanding arrays, linked lists, and more...' },
              { id: 3, title: 'Object-Oriented Programming', duration: '55 min', content: 'Master OOP principles...' },
              { id: 4, title: 'Database Systems', duration: '50 min', content: 'Introduction to databases...' },
              { id: 5, title: 'Software Engineering', duration: '60 min', content: 'Software development lifecycle...' },
              { id: 6, title: 'Computer Networks', duration: '50 min', content: 'Understanding networking...' },
              { id: 7, title: 'Artificial Intelligence', duration: '65 min', content: 'Introduction to AI concepts...' },
              { id: 8, title: 'Final Year Project', duration: '120 min', content: 'Complete your capstone project...' }
            ]
          },
          {
            id: 'swe101',
            title: 'Software Engineering',
            description: 'Design, develop, and maintain large-scale software systems',
            icon: 'fas fa-code',
            totalLessons: 7,
            estimatedHours: 105,
            lessons: [
              { id: 1, title: 'Software Development Fundamentals', duration: '45 min', content: 'Core concepts of software development...' },
              { id: 2, title: 'Software Design Patterns', duration: '60 min', content: 'Common design patterns in software...' },
              { id: 3, title: 'Testing and Quality Assurance', duration: '50 min', content: 'Ensuring software quality...' },
              { id: 4, title: 'Project Management', duration: '45 min', content: 'Managing software projects...' },
              { id: 5, title: 'Agile Development', duration: '50 min', content: 'Agile methodologies...' },
              { id: 6, title: 'Software Architecture', duration: '55 min', content: 'Designing software systems...' },
              { id: 7, title: 'Capstone Project', duration: '120 min', content: 'Build a complete software system...' }
            ]
          }
        ]
      },
      'law': {
        facultyName: 'Faculty of Law',
        facultyDescription: 'Study legal principles, jurisprudence, and advocacy skills.',
        courses: [
          {
            id: 'law101',
            title: 'Law (LLB)',
            description: 'Comprehensive study of legal principles and practice',
            icon: 'fas fa-balance-scale',
            totalLessons: 9,
            estimatedHours: 135,
            lessons: [
              { id: 1, title: 'Introduction to Law', duration: '45 min', content: 'Fundamentals of legal systems...' },
              { id: 2, title: 'Constitutional Law', duration: '60 min', content: 'Understanding constitutional principles...' },
              { id: 3, title: 'Criminal Law', duration: '55 min', content: 'Principles of criminal justice...' },
              { id: 4, title: 'Contract Law', duration: '50 min', content: 'Legal agreements and contracts...' },
              { id: 5, title: 'Tort Law', duration: '55 min', content: 'Civil wrongs and remedies...' },
              { id: 6, title: 'Property Law', duration: '50 min', content: 'Rights in property...' },
              { id: 7, title: 'Legal Practice and Procedure', duration: '60 min', content: 'Court procedures...' },
              { id: 8, title: 'Jurisprudence', duration: '55 min', content: 'Philosophy of law...' },
              { id: 9, title: 'Law Clinic', duration: '120 min', content: 'Practical legal experience...' }
            ]
          }
        ]
      },
      'arts': {
        facultyName: 'Faculty of Arts & Humanities',
        facultyDescription: 'Develop critical thinking, communication skills, and cultural understanding.',
        courses: [
          {
            id: 'eng101',
            title: 'English & Literary Studies',
            description: 'Study of English language, literature, and critical analysis',
            icon: 'fas fa-book',
            totalLessons: 8,
            estimatedHours: 120,
            lessons: [
              { id: 1, title: 'English Composition', duration: '45 min', content: 'Writing fundamentals...' },
              { id: 2, title: 'Semantics', duration: '50 min', content: 'Meaning in language...' },
              { id: 3, title: 'World Literature', duration: '55 min', content: 'Global literary works...' },
              { id: 4, title: 'Phonetics and Phonology', duration: '50 min', content: 'Sounds of language...' },
              { id: 5, title: 'Contemporary Literature', duration: '55 min', content: 'Modern literary works...' },
              { id: 6, title: 'Syntax', duration: '50 min', content: 'Sentence structure...' },
              { id: 7, title: 'Literary Criticism', duration: '60 min', content: 'Analyzing literature...' },
              { id: 8, title: 'Research Project', duration: '120 min', content: 'Complete research paper...' }
            ]
          },
          {
            id: 'his101',
            title: 'History & Strategic Studies',
            description: 'World history, Nigerian history, and strategic analysis',
            icon: 'fas fa-landmark',
            totalLessons: 8,
            estimatedHours: 120,
            lessons: [
              { id: 1, title: 'Introduction to History', duration: '45 min', content: 'Historical methods...' },
              { id: 2, title: 'African History', duration: '55 min', content: 'African civilizations...' },
              { id: 3, title: 'Modern World History', duration: '60 min', content: 'Global modern history...' },
              { id: 4, title: 'Nigerian History', duration: '50 min', content: "Nigeria's past....." },
              { id: 5, title: 'International Relations', duration: '55 min', content: 'Global politics...' },
              { id: 6, title: 'Strategic Studies', duration: '60 min', content: 'Military and security...' },
              { id: 7, title: 'Historical Research Methods', duration: '50 min', content: 'Research techniques...' },
              { id: 8, title: 'Thesis', duration: '120 min', content: 'Complete historical thesis...' }
            ]
          }
        ]
      },
      'management': {
        facultyName: 'Faculty of Management & Social Sciences',
        facultyDescription: 'Prepare for leadership roles in business, government, and society.',
        courses: [
          {
            id: 'bus101',
            title: 'Business Administration',
            description: 'Principles of management, marketing, and entrepreneurship',
            icon: 'fas fa-briefcase',
            totalLessons: 8,
            estimatedHours: 120,
            lessons: [
              { id: 1, title: 'Principles of Management', duration: '45 min', content: 'Management fundamentals...' },
              { id: 2, title: 'Marketing Fundamentals', duration: '50 min', content: 'Marketing concepts...' },
              { id: 3, title: 'Financial Management', duration: '55 min', content: 'Managing finances...' },
              { id: 4, title: 'Human Resource Management', duration: '50 min', content: 'Managing people...' },
              { id: 5, title: 'Strategic Management', duration: '60 min', content: 'Business strategy...' },
              { id: 6, title: 'Entrepreneurship', duration: '55 min', content: 'Starting businesses...' },
              { id: 7, title: 'Business Ethics', duration: '45 min', content: 'Ethical business practices...' },
              { id: 8, title: 'Capstone Project', duration: '120 min', content: 'Business plan development...' }
            ]
          },
          {
            id: 'mass101',
            title: 'Mass Communication',
            description: 'Journalism, public relations, and digital media',
            icon: 'fas fa-broadcast-tower',
            totalLessons: 8,
            estimatedHours: 120,
            lessons: [
              { id: 1, title: 'Introduction to Mass Communication', duration: '45 min', content: 'Media fundamentals...' },
              { id: 2, title: 'News Writing and Reporting', duration: '50 min', content: 'Journalism skills...' },
              { id: 3, title: 'Broadcast Journalism', duration: '55 min', content: 'TV and radio...' },
              { id: 4, title: 'Public Relations', duration: '50 min', content: 'PR strategies...' },
              { id: 5, title: 'Digital Media Production', duration: '60 min', content: 'Creating digital content...' },
              { id: 6, title: 'Media Ethics and Law', duration: '50 min', content: 'Legal and ethical issues...' },
              { id: 7, title: 'Investigative Journalism', duration: '55 min', content: 'In-depth reporting...' },
              { id: 8, title: 'Media Research Project', duration: '120 min', content: 'Complete media project...' }
            ]
          }
        ]
      },
      'education': {
        facultyName: 'Faculty of Education',
        facultyDescription: 'Prepare for careers in teaching and educational leadership.',
        courses: [
          {
            id: 'math101',
            title: 'Mathematics Education',
            description: 'Methods and strategies for teaching mathematics',
            icon: 'fas fa-calculator',
            totalLessons: 8,
            estimatedHours: 120,
            lessons: [
              { id: 1, title: 'Foundations of Mathematics Teaching', duration: '45 min', content: 'Teaching methods...' },
              { id: 2, title: 'Calculus I', duration: '60 min', content: 'Differential calculus...' },
              { id: 3, title: 'Mathematics Curriculum', duration: '50 min', content: 'Curriculum design...' },
              { id: 4, title: 'Abstract Algebra', duration: '55 min', content: 'Advanced algebra...' },
              { id: 5, title: 'Assessment in Mathematics', duration: '50 min', content: 'Student evaluation...' },
              { id: 6, title: 'Technology in Math Teaching', duration: '55 min', content: 'Digital tools...' },
              { id: 7, title: 'Research in Mathematics Education', duration: '60 min', content: 'Educational research...' },
              { id: 8, title: 'Student Teaching', duration: '120 min', content: 'Practical teaching experience...' }
            ]
          },
          {
            id: 'aed101',
            title: 'Adult Education',
            description: 'Teaching strategies for adult learners',
            icon: 'fas fa-chalkboard-teacher',
            totalLessons: 7,
            estimatedHours: 105,
            lessons: [
              { id: 1, title: 'Foundations of Adult Learning', duration: '45 min', content: 'Adult learning theory...' },
              { id: 2, title: 'Adult Learning Theories', duration: '50 min', content: 'Key theories...' },
              { id: 3, title: 'Program Planning', duration: '55 min', content: 'Designing programs...' },
              { id: 4, title: 'Community Education', duration: '50 min', content: 'Community-based learning...' },
              { id: 5, title: 'Literacy and Numeracy', duration: '55 min', content: 'Basic skills teaching...' },
              { id: 6, title: 'Research in Adult Education', duration: '60 min', content: 'Research methods...' },
              { id: 7, title: 'Practicum', duration: '120 min', content: 'Hands-on practice...' }
            ]
          }
        ]
      }
    };

    const motivationalQuotes = [
      "Keep learning, keep growing. Your future is being built today.",
      "Every expert was once a beginner. Keep pushing forward!",
      "The journey of a thousand miles begins with a single step.",
      "Your only limit is you. Break through it!",
      "Education is the most powerful weapon to change the world.",
      "Success is the sum of small efforts repeated daily.",
      "Dream big, work hard, stay focused."
    ];

    let currentUser = null;
    let userData = null;

    // Stars Animation
    document.addEventListener('DOMContentLoaded', () => {
      const starsContainer = document.getElementById('stars-container');
      const numStars = 100;
      const minSize = 1;
      const maxSize = 3;

      function createStar() {
        const star = document.createElement('div');
        star.className = 'star';
        starsContainer.appendChild(star);
        const size = Math.random() * (maxSize - minSize) + minSize;
        star.style.width = `${size}px`;
        star.style.height = `${size}px`;
        star.style.left = `${Math.random() * 100}%`;
        star.style.top = `${Math.random() * 100}%`;
        star.style.animationDelay = `${Math.random() * 4}s`;
        star.style.animationDuration = `${3 + Math.random() * 2}s`;
      }

      for (let i = 0; i < numStars; i++) createStar();
    });

    // Mobile Menu Toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const sidebar = document.getElementById('sidebar');

    mobileMenuToggle.addEventListener('click', () => {
      sidebar.classList.toggle('active');
    });

    document.addEventListener('click', (e) => {
      if (window.innerWidth <= 992) {
        if (!sidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
          sidebar.classList.remove('active');
        }
      }
    });

    // Section Navigation
    window.showSection = function(sectionName) {
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
        section.style.display = 'none';
      });

      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
      });

      const targetSection = document.getElementById(`${sectionName}-section`);
      if (targetSection) {
        targetSection.classList.add('active');
        targetSection.style.display = 'block';
      }

      const activeNav = document.querySelector(`[data-section="${sectionName}"]`);
      if (activeNav) {
        activeNav.classList.add('active');
      }

      if (window.innerWidth <= 992) {
        sidebar.classList.remove('active');
      }

      if (sectionName === 'courses') {
        renderAllCourses();
      } else if (sectionName === 'my-learning') {
        renderMyLearning();
      } else if (sectionName === 'settings') {
        loadSettingsData();
      }
    };

    // Auth State Management
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        currentUser = user;
        await loadUserData(user);
        await initializeDashboard();
      } else {
        window.location.href = 'enroll.html';
      }
    });

    async function loadUserData(user) {
      try {
        const userDocRef = doc(db, 'users', user.uid);
        const userDoc = await getDoc(userDocRef);

        if (userDoc.exists()) {
          userData = userDoc.data();
        } else {
          userData = {
            name: user.displayName || user.email.split('@')[0],
            email: user.email,
            bio: '',
            photoURL: user.photoURL || '',
            enrolledCourses: [],
            completedLessons: 0,
            totalPoints: 0,
            studyStreak: 0,
            studyHours: 0,
            lastLoginDate: serverTimestamp(),
            level: 'Novice Learner',
            createdAt: serverTimestamp()
          };
          await setDoc(userDocRef, userData);
        }

        await updateDoc(userDocRef, {
          lastLoginDate: serverTimestamp()
        });

        updateUserProfile();
      } catch (error) {
        console.error('Error loading user data:', error);
      }
    }

    function updateUserProfile() {
      const userName = userData.name || currentUser.displayName || 'Student';
      const userInitial = userName.charAt(0).toUpperCase();

      document.getElementById('sidebarUserName').textContent = userName;
      document.getElementById('welcomeName').textContent = userName;
      document.getElementById('sidebarUserLevel').textContent = userData.level || 'Novice Learner';

      // Update avatars
      const avatarElements = [
        document.getElementById('sidebarAvatar'),
        document.getElementById('settingsAvatarPreview')
      ];

      avatarElements.forEach(element => {
        if (userData.photoURL) {
          element.innerHTML = `<img src="${userData.photoURL}" alt="Avatar">`;
        } else {
          element.textContent = userInitial;
        }
      });

      const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
      document.getElementById('motivationalQuote').textContent = randomQuote;
    }

    async function initializeDashboard() {
      try {
        document.getElementById('totalCourses').textContent = userData.enrolledCourses?.length || 0;
        document.getElementById('completedLessons').textContent = userData.completedLessons || 0;
        document.getElementById('totalPoints').textContent = userData.totalPoints || 0;
        document.getElementById('studyHours').textContent = `${userData.studyHours || 0}h`;
        document.getElementById('streakNumber').textContent = userData.studyStreak || 0;

        renderDashboardCourses();

        document.getElementById('loadingContainer').style.display = 'none';
        document.getElementById('dashboard-section').style.display = 'block';
      } catch (error) {
        console.error('Error initializing dashboard:', error);
      }
    }

    function renderDashboardCourses() {
      const grid = document.getElementById('dashboardCoursesGrid');

      if (!userData.enrolledCourses || userData.enrolledCourses.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-book-open empty-state-icon"></i>
            <h3 class="empty-state-title">No Courses Yet</h3>
            <p class="empty-state-description">Start your learning journey by enrolling in a course.</p>
            <button class="action-btn" onclick="showSection('courses')">Browse Courses</button>
          </div>
        `;
        return;
      }

      grid.innerHTML = '';

      userData.enrolledCourses.slice(0, 3).forEach(enrolledCourse => {
        const course = findCourseById(enrolledCourse.courseId);
        if (!course) return;

        const progress = enrolledCourse.progress || 0;
        const completedLessons = enrolledCourse.completedLessons?.length || 0;

        const courseCard = document.createElement('div');
        courseCard.className = 'course-card';
        courseCard.innerHTML = `
          <div class="course-thumbnail">
            <i class="${course.icon} course-icon"></i>
          </div>
          <div class="course-body">
            <h3 class="course-title">${course.title}</h3>
            <p class="course-description">${course.description}</p>
            <div class="course-progress">
              <div class="progress-header">
                <span class="progress-label">Progress</span>
                <span class="progress-percentage">${progress}%</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar-fill" style="width: ${progress}%"></div>
              </div>
            </div>
            <div class="course-footer">
              <div class="course-meta">
                <span><i class="fas fa-book"></i> ${completedLessons}/${course.totalLessons}</span>
                <span><i class="fas fa-clock"></i> ${course.estimatedHours}h</span>
              </div>
              <button class="action-btn" onclick="startCourse('${course.id}')">
                Continue
              </button>
            </div>
          </div>
        `;
        grid.appendChild(courseCard);
      });
    }

    function renderAllCourses() {
      const container = document.getElementById('allCoursesContainer');
      container.innerHTML = '';

      Object.keys(coursesDatabase).forEach(facultyKey => {
        const faculty = coursesDatabase[facultyKey];
        
        const facultySection = document.createElement('div');
        facultySection.className = 'faculty-section';
        
        facultySection.innerHTML = `
          <h2 class="faculty-title">${faculty.facultyName}</h2>
          <p class="faculty-description">${faculty.facultyDescription}</p>
        `;

        const coursesGrid = document.createElement('div');
        coursesGrid.className = 'courses-grid';

        faculty.courses.forEach(course => {
          const isEnrolled = userData.enrolledCourses?.some(ec => ec.courseId === course.id);
          
          const courseCard = document.createElement('div');
          courseCard.className = 'course-card';
          courseCard.innerHTML = `
            <div class="course-thumbnail">
              <i class="${course.icon} course-icon"></i>
            </div>
            <div class="course-body">
              <h3 class="course-title">${course.title}</h3>
              <p class="course-description">${course.description}</p>
              <div class="course-footer">
                <div class="course-meta">
                  <span><i class="fas fa-book"></i> ${course.totalLessons} lessons</span>
                  <span><i class="fas fa-clock"></i> ${course.estimatedHours}h</span>
                </div>
                <button class="action-btn ${isEnrolled ? 'secondary' : ''}" onclick="${isEnrolled ? `startCourse('${course.id}')` : `enrollAndStart('${course.id}')`}">
                  ${isEnrolled ? 'Continue' : 'Start Learning'}
                </button>
              </div>
            </div>
          `;
          coursesGrid.appendChild(courseCard);
        });

        facultySection.appendChild(coursesGrid);
        container.appendChild(facultySection);
      });
    }

    function renderMyLearning() {
      const grid = document.getElementById('myLearningGrid');

      if (!userData.enrolledCourses || userData.enrolledCourses.length === 0) {
        grid.innerHTML = `
          <div class="empty-state">
            <i class="fas fa-graduation-cap empty-state-icon"></i>
            <h3 class="empty-state-title">No Enrolled Courses</h3>
            <p class="empty-state-description">You haven't enrolled in any courses yet. Browse our catalog to get started!</p>
            <button class="action-btn" onclick="showSection('courses')">Browse Courses</button>
          </div>
        `;
        return;
      }

      grid.innerHTML = '';

      userData.enrolledCourses.forEach(enrolledCourse => {
        const course = findCourseById(enrolledCourse.courseId);
        if (!course) return;

        const progress = enrolledCourse.progress || 0;
        const completedLessons = enrolledCourse.completedLessons?.length || 0;

        const courseCard = document.createElement('div');
        courseCard.className = 'course-card';
        courseCard.innerHTML = `
          <div class="course-thumbnail">
            <i class="${course.icon} course-icon"></i>
          </div>
          <div class="course-body">
            <h3 class="course-title">${course.title}</h3>
            <p class="course-description">${course.description}</p>
            <div class="course-progress">
              <div class="progress-header">
                <span class="progress-label">Progress</span>
                <span class="progress-percentage">${progress}%</span>
              </div>
              <div class="progress-bar-container">
                <div class="progress-bar-fill" style="width: ${progress}%"></div>
              </div>
            </div>
            <div class="course-footer">
              <div class="course-meta">
                <span><i class="fas fa-book"></i> ${completedLessons}/${course.totalLessons}</span>
                <span><i class="fas fa-clock"></i> ${course.estimatedHours}h</span>
              </div>
              <button class="action-btn" onclick="startCourse('${course.id}')">
                ${progress === 100 ? 'Review' : 'Continue'}
              </button>
            </div>
          </div>
        `;
        grid.appendChild(courseCard);
      });
    }

    function findCourseById(courseId) {
      for (const facultyKey in coursesDatabase) {
        const course = coursesDatabase[facultyKey].courses.find(c => c.id === courseId);
        if (course) return course;
      }
      return null;
    }

    window.enrollAndStart = async function(courseId) {
      try {
        const enrolledCourses = userData.enrolledCourses || [];
        
        if (!enrolledCourses.find(c => c.courseId === courseId)) {
          enrolledCourses.push({
            courseId: courseId,
            enrolledDate: new Date().toISOString(),
            progress: 0,
            completedLessons: [],
            currentLesson: 1
          });

          await updateDoc(doc(db, 'users', currentUser.uid), {
            enrolledCourses: enrolledCourses,
            totalPoints: (userData.totalPoints || 0) + 50
          });

          userData.enrolledCourses = enrolledCourses;
          userData.totalPoints += 50;

          document.getElementById('totalCourses').textContent = enrolledCourses.length;
          document.getElementById('totalPoints').textContent = userData.totalPoints;
        }

        startCourse(courseId);
      } catch (error) {
        console.error('Error enrolling:', error);
        alert('Error enrolling in course. Please try again.');
      }
    };

    window.startCourse = function(courseId) {
      const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
      const currentLesson = enrolledCourse?.currentLesson || 1;
      window.location.href = `course-viewer.html?courseId=${courseId}&lesson=${currentLesson}`;
    };

    // Settings
    function loadSettingsData() {
      document.getElementById('settingsName').value = userData.name || '';
      document.getElementById('settingsEmail').value = userData.email || '';
      document.getElementById('settingsBio').value = userData.bio || '';

      const avatarPreview = document.getElementById('settingsAvatarPreview');
      if (userData.photoURL) {
        avatarPreview.innerHTML = `<img src="${userData.photoURL}" alt="Avatar">`;
      } else {
        const initial = (userData.name || 'A').charAt(0).toUpperCase();
        avatarPreview.textContent = initial;
      }
    }

    document.getElementById('avatarInput').addEventListener('change', async (e) => {
      const file = e.target.files[0];
      if (!file) return;

      if (file.size > 2 * 1024 * 1024) {
        showError('Image size must be less than 2MB');
        return;
      }

      try {
        const storageRef = ref(storage, `avatars/${currentUser.uid}/${Date.now()}_${file.name}`);
        await uploadBytes(storageRef, file);
        const photoURL = await getDownloadURL(storageRef);

        await updateDoc(doc(db, 'users', currentUser.uid), { photoURL });
        await updateProfile(currentUser, { photoURL });

        userData.photoURL = photoURL;
        updateUserProfile();
        showSuccess();
      } catch (error) {
        console.error('Error uploading avatar:', error);
        showError('Failed to upload avatar');
      }
    });

    document.getElementById('profileForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('settingsName').value.trim();
      const bio = document.getElementById('settingsBio').value.trim();

      if (!name) {
        showError('Name is required');
        return;
      }

      try {
        await updateDoc(doc(db, 'users', currentUser.uid), { name, bio });
        await updateProfile(currentUser, { displayName: name });

        userData.name = name;
        userData.bio = bio;

        updateUserProfile();
        showSuccess();
      } catch (error) {
        console.error('Error updating profile:', error);
        showError('Failed to update profile');
      }
    });

    document.getElementById('resetPasswordBtn').addEventListener('click', async () => {
      try {
        await sendPasswordResetEmail(auth, currentUser.email);
        alert('Password reset email sent! Check your inbox.');
      } catch (error) {
        console.error('Error sending reset email:', error);
        alert('Failed to send reset email. Please try again.');
      }
    });

    function showSuccess() {
      const successMsg = document.getElementById('settingsSuccessMessage');
      successMsg.style.display = 'block';
      setTimeout(() => {
        successMsg.style.display = 'none';
      }, 3000);
    }

    function showError(message) {
      const errorMsg = document.getElementById('settingsErrorMessage');
      document.getElementById('errorMessageText').textContent = message;
      errorMsg.style.display = 'block';
      setTimeout(() => {
        errorMsg.style.display = 'none';
      }, 3000);
    }

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', async () => {
      try {
        await signOut(auth);
        window.location.href = 'index.html';
      } catch (error) {
        console.error('Error signing out:', error);
      }
    });
  </script>
</body>
      </html>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
Â  window.dataLayer = window.dataLayer || [];
Â  function gtag(){dataLayer.push(arguments);}
Â  gtag('js', new Date()); 

Â  gtag('config', 'G-J1YTKP10ZX');
</script>
