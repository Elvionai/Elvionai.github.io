<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Elvion AI | Developer Console</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --primary: #00f5ff;
      --secondary: #7b2cff;
      --accent: #00c3ff;
      --bg-dark: #02040b;
      --glass-bg: rgba(10, 18, 40, 0.78);
      --glass-border: rgba(0, 255, 255, 0.25);
      --text-main: #ffffff;
      --success: #00e676;
      --danger: #ff1744;
      --warning: #ffae42;
    }

    * { box-sizing: border-box; outline: none; }

    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: radial-gradient(circle at top, #041935 0%, #02040b 40%, #000000 100%);
      color: var(--text-main);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Holographic grid background */
    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background:
        radial-gradient(circle at 10% 20%, rgba(0, 255, 255, 0.12), transparent 60%),
        radial-gradient(circle at 80% 0%, rgba(140, 0, 255, 0.18), transparent 55%),
        radial-gradient(circle at 50% 100%, rgba(0, 140, 255, 0.18), transparent 55%);
      opacity: 0.9;
      pointer-events: none;
      z-index: -3;
    }

    /* STARFIELD */
    #stars { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -2; pointer-events: none; }
    .star { position: absolute; background: #e0f7ff; border-radius: 50%; animation: twinkle var(--duration) linear infinite; opacity: 0; box-shadow: 0 0 6px rgba(0,255,255,0.7); }
    @keyframes twinkle { 0% { opacity: 0; transform: scale(0.7); } 50% { opacity: 0.9; transform: scale(1); } 100% { opacity: 0; transform: scale(0.7); } }

    /* ORBITING LIGHT RINGS */
    .ring {
      position: fixed;
      width: 420px;
      height: 420px;
      border-radius: 50%;
      border: 1px solid rgba(0, 255, 255, 0.18);
      box-shadow: 0 0 45px rgba(0, 255, 255, 0.18);
      top: -120px;
      right: -80px;
      filter: blur(1px);
      animation: spinRing 18s linear infinite;
      z-index: -1;
    }
    .ring:nth-child(2) {
      width: 520px;
      height: 520px;
      top: auto;
      bottom: -160px;
      right: auto;
      left: -140px;
      border-color: rgba(123, 44, 255, 0.18);
      box-shadow: 0 0 60px rgba(123, 44, 255, 0.25);
      animation-duration: 26s;
      animation-direction: reverse;
    }
    @keyframes spinRing {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }

    /* TOP NAV */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 0 20px 0;
      margin-bottom: 18px;
      border-bottom: 1px solid rgba(0, 255, 255, 0.12);
      gap: 20px;
    }

    .brand { display: flex; align-items: center; gap: 14px; }
    .brand img {
      width: 50px;
      height: 50px;
      border-radius: 16px;
      border: 2px solid rgba(0, 255, 255, 0.35);
      box-shadow:
        0 0 10px rgba(0,255,255,0.7),
        0 0 25px rgba(123,44,255,0.45);
      object-fit: cover;
    }
    .brand h1 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.5rem;
      margin: 0;
      letter-spacing: 1px;
      background: linear-gradient(120deg, #00f5ff, #7b2cff, #ff00d4);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      animation: gradientText 8s ease infinite;
    }
    .brand small {
      font-size: 0.7rem;
      color: #9fe7ff;
      letter-spacing: 2px;
    }
    @keyframes gradientText {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
    }
    .nav-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      border-radius: 999px;
      border: 1px solid rgba(0,255,255,0.2);
      background: radial-gradient(circle at top left, rgba(0,255,255,0.15), rgba(0,0,0,0.6));
      color: #e4faff;
      font-size: 0.8rem;
      text-decoration: none;
      text-transform: uppercase;
      letter-spacing: 1px;
      transition: 0.25s;
    }
    .nav-pill i { color: var(--primary); }
    .nav-pill:hover {
      transform: translateY(-1px);
      box-shadow: 0 0 14px rgba(0,255,255,0.35);
      border-color: rgba(0,255,255,0.4);
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      background: radial-gradient(circle at top left, rgba(0,255,255,0.18), rgba(0,0,0,0.85));
      padding: 8px 16px;
      border-radius: 999px;
      border: 1px solid rgba(0,255,255,0.35);
      backdrop-filter: blur(15px);
      box-shadow: 0 0 18px rgba(0,255,255,0.4);
    }
    .user-email {
      font-size: 0.85rem;
      color: #b8e7ff;
    }
    .logout-btn {
      background: none;
      border: none;
      color: var(--danger);
      cursor: pointer;
      transition: 0.25s;
      font-size: 1rem;
    }
    .logout-btn:hover {
      transform: scale(1.1) rotate(-6deg);
      text-shadow: 0 0 10px var(--danger);
    }

    /* DASHBOARD GRID */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(330px, 1fr));
      gap: 20px;
      margin-bottom: 24px;
    }
    .card {
      background: linear-gradient(135deg, rgba(10,18,40,0.92), rgba(4,10,28,0.92));
      backdrop-filter: blur(18px);
      border-radius: 16px;
      padding: 22px;
      border: 1px solid rgba(0,255,255,0.16);
      box-shadow:
        0 18px 40px rgba(0,0,0,0.7),
        0 0 24px rgba(0, 180, 255, 0.35);
      position: relative;
      overflow: hidden;
      transition: transform 0.25s ease, box-shadow 0.25s ease, border-color 0.25s ease;
    }
    .card::before {
      content: "";
      position: absolute;
      inset: -2px;
      background: conic-gradient(from 180deg at 50% 50%, rgba(0,255,255,0.3), transparent, rgba(123,44,255,0.3), transparent, rgba(0,255,255,0.3));
      opacity: 0;
      transition: opacity 0.35s;
      z-index: -1;
    }
    .card:hover {
      transform: translateY(-4px);
      border-color: rgba(0,255,255,0.35);
      box-shadow:
        0 22px 45px rgba(0,0,0,0.8),
        0 0 28px rgba(0, 200, 255, 0.6);
    }
    .card:hover::before { opacity: 0.35; }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }
    .card-title {
      font-family: 'Orbitron', sans-serif;
      font-size: 1rem;
      color: var(--primary);
      margin: 0;
      display: flex;
      align-items: center;
      gap: 8px;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    .card-title i {
      color: var(--secondary);
      text-shadow: 0 0 10px rgba(123,44,255,0.7);
    }
    .card-sub {
      font-size: 0.75rem;
      color: #8ea9ff;
    }

    /* BALANCE */
    .balance-wrapper { text-align: center; padding: 8px 0 16px 0; }
    .balance-label {
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 2px;
      color: #7bdfff;
    }
    .balance-amount {
      font-family: 'Orbitron', sans-serif;
      font-size: 2.6rem;
      font-weight: 700;
      color: #ffffff;
      margin: 4px 0 6px 0;
      text-shadow:
        0 0 28px rgba(0, 255, 255, 0.6),
        0 0 60px rgba(0, 120, 255, 0.5);
      position: relative;
    }
    .balance-amount span.cr {
      font-size: 1rem;
      color: #7ad6ff;
      margin-left: 4px;
    }
    .balance-pulse {
      position: absolute;
      inset: -6px;
      border-radius: 20px;
      border: 1px solid rgba(0,255,255,0.35);
      filter: blur(5px);
      opacity: 0;
      animation: pulseGlow 2.8s infinite;
    }
    @keyframes pulseGlow {
      0% { opacity: 0; transform: scale(0.9); }
      40% { opacity: 0.8; transform: scale(1); }
      100% { opacity: 0; transform: scale(1.05); }
    }

    /* BUTTONS */
    .btn {
      background: linear-gradient(135deg, #00f5ff, #0077ff);
      color: #020617;
      border: none;
      padding: 11px 18px;
      border-radius: 999px;
      font-weight: 800;
      font-family: 'Inter', sans-serif;
      cursor: pointer;
      transition: all 0.25s;
      width: 100%;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 0.85rem;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
    }
    .btn::after {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(120deg, rgba(255,255,255,0.35), transparent 60%);
      transform: translateX(-120%);
      transition: transform 0.45s;
    }
    .btn:hover::after {
      transform: translateX(120%);
    }
    .btn:hover {
      transform: translateY(-1px) scale(1.01);
      box-shadow: 0 0 18px rgba(0, 230, 255, 0.7);
    }

    .btn-secondary {
      background: radial-gradient(circle at top left, rgba(0,255,255,0.18), rgba(0,0,0,0.85));
      color: #e0f7ff;
      border: 1px solid rgba(0,255,255,0.28);
      font-weight: 600;
    }
    .btn-secondary::after { display: none; }
    .btn-secondary:hover {
      border-color: rgba(0,255,255,0.55);
      box-shadow: 0 0 16px rgba(0,255,255,0.55);
    }

    .btn-danger {
      background: rgba(255, 23, 68, 0.08);
      color: var(--danger);
      border: 1px solid rgba(255, 23, 68, 0.65);
      padding: 6px 12px;
      border-radius: 999px;
      font-size: 0.72rem;
      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      transition: 0.22s;
    }
    .btn-danger:hover {
      background: rgba(255, 23, 68, 0.2);
      box-shadow: 0 0 16px rgba(255,23,68,0.5);
      transform: translateY(-1px);
    }

    .btn-ghost-small {
      background: transparent;
      border: 1px dashed rgba(0,255,255,0.5);
      padding: 4px 10px;
      border-radius: 999px;
      color: #a7ecff;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      cursor: pointer;
      transition: 0.22s;
    }
    .btn-ghost-small:hover {
      background: rgba(0,255,255,0.09);
      box-shadow: 0 0 12px rgba(0,255,255,0.5);
    }

    .loader {
      width: 15px;
      height: 15px;
      border: 2px solid rgba(0,0,0,0.4);
      border-top-color: #000;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      display: none;
    }
    .btn.loading .loader { display: inline-block; }
    .btn.loading span { opacity: 0.4; }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* TABLES */
    .table-container {
      overflow-x: auto;
      max-height: 420px;
      border-radius: 10px;
      border: 1px solid rgba(0,255,255,0.16);
    }
    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
    }
    th {
      text-align: left;
      padding: 12px 14px;
      color: #89a4ff;
      font-size: 0.75rem;
      text-transform: uppercase;
      border-bottom: 1px solid rgba(0,255,255,0.16);
      background: linear-gradient(90deg, rgba(0,255,255,0.15), rgba(0,0,0,0.4));
    }
    td {
      padding: 11px 14px;
      border-bottom: 1px solid rgba(255,255,255,0.05);
      color: #eef7ff;
    }
    tr:nth-child(even) {
      background: rgba(2, 8, 23, 0.75);
    }

    .cost-pos { color: var(--success); font-family: 'Orbitron', sans-serif; }
    .cost-neg { color: var(--danger); font-family: 'Orbitron', sans-serif; }

    /* STATUS BADGES & NOTIFICATIONS */
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    .badge-success {
      background: rgba(0, 230, 118, 0.12);
      color: #7befb2;
      border: 1px solid rgba(0, 230, 118, 0.7);
    }
    .badge-warning {
      background: rgba(255, 174, 66, 0.12);
      color: #ffdd9b;
      border: 1px solid rgba(255, 174, 66, 0.8);
    }

    /* MODALS */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(0,0,0,0.9), rgba(0,0,0,0.98));
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: none;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.2s ease-out;
    }
    .modal {
      background: radial-gradient(circle at top, #061225, #030713);
      border: 1px solid rgba(0,255,255,0.4);
      padding: 26px 24px 24px;
      border-radius: 18px;
      width: 90%;
      max-width: 420px;
      position: relative;
      box-shadow:
        0 24px 60px rgba(0,0,0,0.9),
        0 0 32px rgba(0, 220, 255, 0.5);
      transform: translateY(12px) scale(0.96);
      animation: slideUp 0.25s ease-out forwards;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    @keyframes slideUp {
      to { transform: translateY(0) scale(1); }
    }

    input {
      background: #ffffff !important;
      color: #000000 !important;
      border: 2px solid #ced0ff;
      padding: 10px 11px;
      border-radius: 8px;
      width: 100%;
      font-size: 0.96rem;
      font-weight: 600;
      margin-top: 4px;
      margin-bottom: 13px;
    }
    input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 8px rgba(0,255,255,0.7);
    }
    label {
      color: #9acfff;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .close-modal {
      position: absolute;
      top: 9px;
      right: 10px;
      background: none;
      border: none;
      color: #e2f2ff;
      font-size: 1.4rem;
      cursor: pointer;
      transition: 0.2s;
    }
    .close-modal:hover {
      color: var(--danger);
      transform: rotate(10deg) scale(1.1);
    }

    /* TOAST / NOTIFICATION */
    #toast-container {
      position: fixed;
      top: 16px;
      right: 16px;
      z-index: 2000;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .toast {
      background: radial-gradient(circle at top left, rgba(0,255,255,0.2), #020617);
      border-left: 4px solid var(--primary);
      padding: 12px 15px;
      border-radius: 10px;
      color: white;
      min-width: 260px;
      max-width: 320px;
      box-shadow: 0 10px 28px rgba(0,0,0,0.85);
      animation: slideIn 0.25s ease-out;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 0.82rem;
    }
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }

    /* Notification center card */
    .notif-list {
      max-height: 240px;
      overflow-y: auto;
      padding-right: 4px;
      margin-top: 8px;
    }
    .notif-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px dashed rgba(255,255,255,0.04);
      font-size: 0.8rem;
    }
    .notif-icon {
      width: 26px;
      height: 26px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at top, rgba(0,255,255,0.3), rgba(0,0,0,0.9));
      box-shadow: 0 0 10px rgba(0,255,255,0.4);
      flex-shrink: 0;
    }
    .notif-meta {
      color: #7fb9ff;
      font-size: 0.7rem;
      margin-top: 2px;
    }

    /* VERIFICATION BANNER */
    #verify-box {
      display: none;
      margin-top: 14px;
      background: linear-gradient(120deg, rgba(255, 174, 66, 0.15), rgba(6, 9, 18, 0.95));
      padding: 10px 11px;
      border-radius: 10px;
      border: 1px solid var(--warning);
      text-align: left;
    }

    /* ADMIN PANEL */
    #admin-panel {
      margin-top: 20px;
      border: 1px solid rgba(255, 174, 66, 0.8);
      background: radial-gradient(circle at top left, rgba(255, 174, 66, 0.22), rgba(8, 7, 18, 0.96));
      box-shadow:
        0 18px 40px rgba(0,0,0,0.9),
        0 0 26px rgba(255,174,66,0.55);
    }
    #admin-panel .card-title {
      color: #ffdd9b;
    }
    .admin-pill {
      font-size: 0.7rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #ffd27a;
      margin-bottom: 6px;
    }

    /* FAQ + SUPPORT */
    .faq-grid {
      display: grid;
      grid-template-columns: minmax(0,2fr) minmax(0,1.5fr);
      gap: 16px;
      margin-top: 22px;
    }
    .faq-item {
      margin-bottom: 10px;
    }
    .faq-q {
      font-size: 0.82rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      color: #8ad3ff;
      margin-bottom: 4px;
    }
    .faq-a {
      font-size: 0.85rem;
      color: #e6f4ff;
    }
    .support-box {
      background: radial-gradient(circle at top, rgba(0,255,255,0.18), rgba(0,0,0,0.9));
      border-radius: 14px;
      padding: 14px 14px 12px;
      border: 1px solid rgba(0,255,255,0.4);
      display: flex;
      flex-direction: column;
      gap: 8px;
      font-size: 0.83rem;
    }
    .support-chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,0.85);
      border: 1px solid rgba(0,255,255,0.4);
      font-size: 0.75rem;
      color: #baf2ff;
    }
    .support-cta {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 4px;
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(0,255,255,0.4);
      background: linear-gradient(120deg, rgba(0,255,255,0.25), rgba(0,0,0,0.8));
      color: #04131f;
      font-weight: 700;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.7px;
      cursor: pointer;
      text-decoration: none;
      box-shadow: 0 0 16px rgba(0,255,255,0.6);
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      header {
        flex-direction: column;
        align-items: flex-start;
      }
      .nav-links {
        align-self: stretch;
        justify-content: space-between;
      }
      .faq-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
<div class="ring"></div>
<div class="ring"></div>
<div id="stars"></div>
<div id="toast-container"></div>

<div class="container">
  <!-- Header -->
  <header>
    <div class="brand">
      <img src="https://i.ibb.co/YTkKPfvf/IMG-20250715-102103-129.jpg" alt="Logo">
      <div>
        <h1>Elvion AI</h1>
        <small>DEVELOPER CONSOLE</small>
      </div>
    </div>

    <div class="nav-links">
      <a href="https://elvionai.com.ng" class="nav-pill">
        <i class="fas fa-home"></i>
        <span>Home</span>
      </a>
      <a href="https://elvionai.com.ng/api.html" class="nav-pill">
        <i class="fas fa-book"></i>
        <span>Docs</span>
      </a>
      <a href="https://elvionai.com.ng/philadelphia.html" class="nav-pill">
        <i class="fas fa-robot"></i>
        <span>Philadelphia AI</span>
      </a>
    </div>

    <div class="user-info">
      <i class="fas fa-user-astronaut" style="color:var(--primary);"></i>
      <span id="user-email" class="user-email">Loading...</span>
      <button class="logout-btn" onclick="logout()"><i class="fas fa-sign-out-alt"></i></button>
    </div>
  </header>

  <div class="dashboard-grid">
    <!-- Wallet -->
    <div class="card">
      <div class="card-header">
        <div>
          <h3 class="card-title"><i class="fas fa-wallet"></i> Balance</h3>
          <div class="card-sub">Your fuel for every API call.</div>
        </div>
        <button class="btn-ghost-small" onclick="loadData()">
          <i class="fas fa-sync-alt"></i> Refresh
        </button>
      </div>
      <div class="balance-wrapper">
        <div class="balance-label">Available Credits</div>
        <div class="balance-amount">
          <div class="balance-pulse"></div>
          <span id="balance-display">---</span><span class="cr">Cr</span>
        </div>
      </div>
      <button class="btn" onclick="openModal('payment-modal')">
        <i class="fas fa-bolt"></i> <span>Fund Wallet</span>
        <div class="loader"></div>
      </button>

      <!-- Verification Status Box -->
      <div id="verify-box">
        <p style="color:var(--warning); font-size:0.78rem; margin:0 0 4px 0;">
          <i class="fas fa-spinner fa-spin"></i> Verifying transaction with bank...
        </p>
        <div style="font-size:0.7rem; color:#aaa;">
          Sit tight, your credits will appear automatically once confirmed.
        </div>
      </div>
    </div>

    <!-- Actions + Notifications -->
    <div class="card">
      <div class="card-header">
        <div>
          <h3 class="card-title"><i class="fas fa-rocket"></i> Actions</h3>
          <div class="card-sub">Send credits, mint keys, stay in flow.</div>
        </div>
      </div>

      <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:14px;">
        <button class="btn-secondary" onclick="openModal('transfer-modal')">
          <i class="fas fa-paper-plane"></i> Transfer
        </button>
        <button class="btn-secondary" id="gen-key-btn" onclick="generateKey()">
          <span><i class="fas fa-key"></i> New Key</span>
          <div class="loader"></div>
        </button>
      </div>
      <p style="text-align:center; color:#8ea9ff; font-size:0.78rem; margin:0 0 8px;">
        API key creation cost: <strong>100 Credits</strong>
      </p>

      <div style="margin-top:14px;">
        <div style="display:flex; justify-content:space-between; align-items:center;">
          <span style="font-size:0.78rem; color:#8ad3ff; text-transform:uppercase; letter-spacing:1px;">
            Notifications
          </span>
          <span style="font-size:0.7rem; color:#7fb9ff;">
            Human-readable events, not raw calls.
          </span>
        </div>
        <div class="notif-list" id="notif-list">
          <div style="font-size:0.8rem; color:#7fb9ff; margin-top:5px;">
            <em>No notifications yet. Fund, transfer or call the API to see activity.</em>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats -->
    <div class="card">
      <div class="card-header">
        <div>
          <h3 class="card-title"><i class="fas fa-chart-line"></i> Overview</h3>
          <div class="card-sub">Snapshot of how your API is behaving.</div>
        </div>
      </div>
      <div style="display:flex; justify-content:space-between; margin-top:14px; gap:12px;">
        <div>
          <div style="color:#888; font-size:0.78rem; text-transform:uppercase; letter-spacing:1px;">Active Keys</div>
          <div style="font-family:'Orbitron'; font-size:1.9rem;" id="active-keys-display">0</div>
          <span class="badge badge-success"><i class="fas fa-unlock"></i> Live</span>
        </div>
        <div>
          <div style="color:#888; font-size:0.78rem; text-transform:uppercase; letter-spacing:1px;">Total Calls</div>
          <div style="font-family:'Orbitron'; font-size:1.9rem;" id="total-calls-display">0</div>
          <span class="badge badge-warning"><i class="fas fa-wave-square"></i> Traffic</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="card">
    <div class="card-header">
      <div>
        <h3 class="card-title"><i class="fas fa-history"></i> Recent Activity</h3>
        <div class="card-sub">Payments, gifts, usage and more.</div>
      </div>
    </div>
    <div class="table-container">
      <table>
        <thead>
        <tr>
          <th>Event</th>
          <th>Actor</th>
          <th style="text-align:right;">Amount</th>
          <th style="text-align:right;">Time (Local)</th>
        </tr>
        </thead>
        <tbody id="usage-list">
        <tr>
          <td colspan="4" style="text-align:center; padding:28px;">Loading history...</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- API Keys -->
  <div class="card" style="margin-top:18px;">
    <div class="card-header">
      <div>
        <h3 class="card-title"><i class="fas fa-code"></i> Active Keys</h3>
        <div class="card-sub">Rotate, revoke or delete keys anytime.</div>
      </div>
    </div>
    <div class="table-container">
      <table>
        <thead>
        <tr>
          <th>Key ID</th>
          <th>Created</th>
          <th style="text-align:right;">Manage</th>
        </tr>
        </thead>
        <tbody id="key-list">
        <tr>
          <td colspan="3" style="text-align:center; padding:28px;">Loading keys...</td>
        </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Admin Panel -->
  <div class="card" id="admin-panel" style="display:none;">
    <div class="card-header">
      <div>
        <h3 class="card-title"><i class="fas fa-user-shield"></i> Admin Controls</h3>
        <div class="card-sub">Secret console for the keeper of the flame.</div>
      </div>
    </div>
    <div style="display:grid; grid-template-columns:1fr 1fr; gap:18px;">
      <div>
        <div class="admin-pill"><i class="fas fa-fire-alt"></i> Self grant</div>
        <button class="btn" style="background:linear-gradient(135deg,#ffae42,#ff6347);color:#1b0600;" onclick="adminGrantSelf()">
          <i class="fas fa-magic"></i> Set 100k
        </button>
      </div>
      <div>
        <div class="admin-pill"><i class="fas fa-gift"></i> Gift user</div>
        <label>Receiver</label>
        <input type="email" id="gift-email" placeholder="user@email.com">
        <label>Amount</label>
        <input type="number" id="gift-amount" placeholder="Amount">
        <button class="btn-secondary" onclick="adminGift()">
          <i class="fas fa-paper-plane"></i> Send Gift
        </button>
      </div>
    </div>
  </div>

  <!-- FAQ & Support -->
  <div class="faq-grid">
    <div class="card" style="margin-top:18px;">
      <div class="card-header">
        <div>
          <h3 class="card-title"><i class="fas fa-question-circle"></i> FAQ</h3>
          <div class="card-sub">The fastest answers to the questions you actually ask.</div>
        </div>
      </div>
      <div>
        <div class="faq-item">
          <div class="faq-q">Want free API credits?</div>
          <div class="faq-a">
            Tell the compliance team what you are building and why Elvion is the engine. The more specific your use case, the more generous the test credits.
          </div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Got an inquiry?</div>
          <div class="faq-a">
            From pricing to rate limits, everything can be clarified in a single friendly thread with the compliance team.
          </div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Having issues integrating?</div>
          <div class="faq-a">
            Share your request logs, error messages and brief code context; you will get a targeted fix, not a generic reply.
          </div>
        </div>
      </div>
    </div>

    <div class="card" style="margin-top:18px;">
      <div class="card-header">
        <div>
          <h3 class="card-title"><i class="fas fa-headset"></i> Reach compliance</h3>
          <div class="card-sub">Instant human support when things get serious.</div>
        </div>
      </div>
      <div class="support-box">
        <div style="font-size:0.84rem; color:#e6f4ff;">
          Want free credits, have an inquiry, or stuck on something? Ping the compliance desk and get a response in minutes, not days.
        </div>
        <div class="support-chip">
          <i class="fas fa-envelope-open-text" style="color:var(--primary);"></i>
          <span>compliance @ <strong>elvionlabs@gmail.com</strong></span>
        </div>
        <div class="support-chip">
          <i class="fab fa-whatsapp" style="color:#25D366;"></i>
          <span>Tap to chat instantly on WhatsApp</span>
        </div>
        <a href="https://wa.me/+2348159983206" class="support-cta">
          <i class="fas fa-bolt"></i>
          <span>Start instant chat</span>
        </a>
      </div>
    </div>
  </div>
</div>

<!-- MODALS -->
<div id="payment-modal" class="modal-overlay">
  <div class="modal">
    <button class="close-modal" onclick="closeModal('payment-modal')">&times;</button>
    <div style="text-align:center; margin-bottom:10px;">
      <i class="fas fa-wallet" style="font-size:3rem; color:var(--primary); margin-bottom:8px;"></i>
      <h3 style="margin:0 0 4px;">Fund Wallet</h3>
      <div style="font-size:0.78rem; color:#8ea9ff;">Secure checkout. Credits will auto-sync once payment is confirmed.</div>
    </div>
    <label>Amount (NGN)</label>
    <input type="number" id="pay-amount" value="1000" min="100">
    <button class="btn" id="pay-btn" onclick="initiatePayment()">
      <span>Pay Now</span>
      <div class="loader"></div>
    </button>
  </div>
</div>

<div id="transfer-modal" class="modal-overlay">
  <div class="modal">
    <button class="close-modal" onclick="closeModal('transfer-modal')">&times;</button>
    <div style="text-align:center; margin-bottom:10px;">
      <i class="fas fa-paper-plane" style="font-size:3rem; color:var(--secondary); margin-bottom:8px;"></i>
      <h3 style="margin:0 0 4px;">Transfer Credits</h3>
      <div style="font-size:0.78rem; color:#8ea9ff;">Send credits to another Elvion developer in seconds.</div>
    </div>
    <label>Receiver Email</label>
    <input type="email" id="trans-email" placeholder="developer@example.com">
    <label>Amount</label>
    <input type="number" id="trans-amount" placeholder="500">
    <button class="btn" id="trans-btn" onclick="transferCredits()">
      <span>Send</span>
      <div class="loader"></div>
    </button>
  </div>
</div>

<div id="key-modal" class="modal-overlay">
  <div class="modal">
    <button class="close-modal" onclick="closeModal('key-modal')">&times;</button>
    <div style="text-align:center; margin-bottom:10px;">
      <i class="fas fa-check-circle" style="font-size:3rem; color:var(--success); margin-bottom:8px;"></i>
      <h3 style="margin:0 0 4px;">Key Generated</h3>
      <div style="font-size:0.78rem; color:#8ea9ff;">Copy and keep this key safe. You will not see it in full again.</div>
    </div>
    <div id="new-key" style="background:black; color:var(--success); padding:12px; border-radius:8px; font-family:monospace; word-break:break-all; text-align:center; border:1px dashed rgba(0,255,255,0.5); font-size:0.82rem;"></div>
    <button class="btn-secondary" style="margin-top:13px; width:100%;" onclick="copyKey()">
      <i class="fas fa-copy"></i> Copy to Clipboard
    </button>
  </div>
</div>

<script type="module">
  const API_URL = "https://web-production-9a18.up.railway.app";
  const ADMIN_EMAIL = "koladhino@gmail.com";

  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
  import { getAuth, onIdTokenChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

  const app = initializeApp({
    apiKey: "AIzaSyAyROm0aBGjry6NUfhNM3e0qwPcCDoIqSk",
    authDomain: "elvionai.firebaseapp.com",
    projectId: "elvionai",
    storageBucket: "elvionai.appspot.com",
    messagingSenderId: "161078300830",
    appId: "1:161078300830:web:f460df8591704eb0e96b8f"
  });

  const auth = getAuth(app);
  let token = null;

  window.logout = () => signOut(auth);
  window.openModal = (id) => document.getElementById(id).style.display = 'flex';
  window.closeModal = (id) => document.getElementById(id).style.display = 'none';
  window.copyKey = () => {
    navigator.clipboard.writeText(document.getElementById('new-key').innerText);
    toast('API key copied to clipboard', 'success');
    closeModal('key-modal');
  };

  onIdTokenChanged(auth, async (user) => {
    if (user) {
      token = await user.getIdToken(true);
      document.getElementById('user-email').innerText = user.email;
      if (user.email.toLowerCase() === ADMIN_EMAIL) {
        document.getElementById('admin-panel').style.display = 'block';
      }
      loadData();

      // Auto-verify payment
      const params = new URLSearchParams(window.location.search);
      const ref = params.get('reference') || params.get('trxref');
      if (ref) {
        window.history.replaceState({}, document.title, window.location.pathname);
        startVerificationLoop(ref);
      }
    } else {
      window.location.href = 'developer-login.html';
    }
  });

  async function req(endpoint, method='GET', body=null) {
    try {
      const opts = {
        method,
        headers: {
          'Content-Type': 'application/json',
          'X-Firebase-Token': token
        }
      };
      if (body) opts.body = JSON.stringify(body);
      const res = await fetch(\`\${API_URL}\${endpoint}\`, opts);
      const data = await res.json();
      if (!res.ok) throw new Error(data.detail || 'Request failed');
      return data;
    } catch (e) {
      toast(e.message, 'error');
      throw e;
    }
  }

  // Build human-readable notification line + who-sent info
  function buildEventLine(log) {
    const type = log.type || '';
    if (type === 'funding') {
      return {
        title: 'Wallet funded',
        actor: 'You',
        icon: 'fa-bolt',
        tone: 'success'
      };
    }
    if (type === 'gift') {
      // backend should send either sender_email or receiver_email; fall back gracefully
      const actor = log.sender_email || log.receiver_email || 'Someone';
      const isIncoming = log.direction === 'incoming' || log.receiver_email;
      return {
        title: isIncoming ? 'Credits received' : 'Credits sent',
        actor: actor,
        icon: isIncoming ? 'fa-arrow-down' : 'fa-arrow-up',
        tone: isIncoming ? 'success' : 'warning'
      };
    }
    if (type === 'usage') {
      return {
        title: 'API call',
        actor: log.model || 'API',
        icon: 'fa-wave-square',
        tone: 'info'
      };
    }
    if (type === 'admin_grant') {
      return {
        title: 'Admin grant',
        actor: log.actor || 'Admin',
        icon: 'fa-fire-alt',
        tone: 'warning'
      };
    }
    return {
      title: log.endpoint || 'Activity',
      actor: 'System',
      icon: 'fa-circle-notch',
      tone: 'info'
    };
  }

  function pushNotificationFromLog(log) {
    const evt = buildEventLine(log);
    const list = document.getElementById('notif-list');
    const div = document.createElement('div');
    div.className = 'notif-item';
    div.innerHTML = \`
      <div class="notif-icon">
        <i class="fas \${evt.icon}" style="font-size:0.78rem;"></i>
      </div>
      <div>
        <div>\${evt.title}</div>
        <div class="notif-meta">\${evt.actor} &middot; \${new Date(log.timestamp).toLocaleTimeString()}</div>
      </div>
    \`;
    if (list.firstElementChild && list.firstElementChild.tagName === 'DIV' && list.firstElementChild.innerText.includes('No notifications')) {
      list.innerHTML = '';
    }
    list.prepend(div);
  }

  window.loadData = async () => {
    try {
      const d = await req('/api/user/keys-and-balance');
      document.getElementById('balance-display').innerText = d.balance.toLocaleString();
      document.getElementById('active-keys-display').innerText = d.keys.filter(k => k.is_active).length;

      const kList = document.getElementById('key-list');
      if (!d.keys.length) {
        kList.innerHTML = '<tr><td colspan="3" style="text-align:center;">No keys found</td></tr>';
      } else {
        kList.innerHTML = d.keys.map(k => {
          const shortId = '...' + k.api_key.slice(-8);
          const created = k.created_at.split('T')[0];
          const controls = k.is_active
            ? \`
              <button class="btn-danger" onclick="revokeKey('\${k.api_key}')">Revoke</button>
              <button class="btn-danger" style="margin-left:4px;background:rgba(255,23,68,0.18);" onclick="deleteKey('\${k.api_key}')">Delete</button>
            \`
            : '<span style="font-size:0.75rem; color:#ff8a80;">Revoked</span>';
          return \`
            <tr>
              <td style="font-family:monospace; color:var(--primary);">\${shortId}</td>
              <td>\${created}</td>
              <td style="text-align:right;">\${controls}</td>
            </tr>
          \`;
        }).join('');
      }

      const h = await req('/api/user/usage-history');
      document.getElementById('total-calls-display').innerText = h.logs.length;
      const hList = document.getElementById('usage-list');
      if (!h.logs.length) {
        hList.innerHTML = '<tr><td colspan="4" style="text-align:center; padding:28px;">No history found</td></tr>';
      } else {
        hList.innerHTML = h.logs.map(l => {
          const isPos = l.type === 'funding' || l.type === 'gift' || l.type === 'admin_grant';
          const evt = buildEventLine(l);
          const actor = evt.actor || '-';
          return \`
            <tr>
              <td>\${evt.title}</td>
              <td>\${actor}</td>
              <td style="text-align:right;" class="\${isPos ? 'cost-pos' : 'cost-neg'}">\${isPos ? '+' : '-'} \${l.cost}</td>
              <td style="text-align:right; color:#888;">\${new Date(l.timestamp).toLocaleString()}</td>
            </tr>
          \`;
        }).join('');
      }

      // Seed notifications with the last few events
      const notifList = document.getElementById('notif-list');
      notifList.innerHTML = '';
      h.logs.slice(-5).forEach(l => pushNotificationFromLog(l));
      if (!h.logs.length) {
        notifList.innerHTML = '<div style="font-size:0.8rem; color:#7fb9ff; margin-top:5px;"><em>No notifications yet. Fund, transfer or call the API to see activity.</em></div>';
      }
    } catch (e) {}
  };

  // Payment verification loop
  async function startVerificationLoop(ref) {
    document.getElementById('verify-box').style.display = 'block';
    toast('Payment detected. Verifying...', 'warning');

    for (let i = 0; i < 20; i++) {
      try {
        const res = await req(\`/api/payments/verify?transaction_ref=\${ref}\`);
        if (res.status === 'success' || res.status === 'already_credited') {
          document.getElementById('verify-box').style.display = 'none';
          toast(\`Payment confirmed. +\${res.credits_added} credits\`, 'success');
          loadData();
          return;
        } else if (res.status === 'failed') {
          document.getElementById('verify-box').style.display = 'none';
          toast('Payment failed. Please try again or contact compliance.', 'error');
          return;
        }
      } catch (e) {
        console.log(e);
      }
      await new Promise(r => setTimeout(r, 3000));
    }

    document.getElementById('verify-box').style.display = 'none';
    toast('Verification timed out. Check history or reach compliance.', 'error');
  }

  // ACTIONS
  window.initiatePayment = async () => {
    const btn = document.getElementById('pay-btn');
    btn.classList.add('loading');
    try {
      const amt = document.getElementById('pay-amount').value;
      const res = await req('/api/payments/initiate', 'POST', { amount: parseInt(amt) });
      toast('Redirecting to secure payment...', 'info');
      window.location.href = res.checkout_url;
    } catch (e) {
      btn.classList.remove('loading');
    }
  };

  window.generateKey = async () => {
    const btn = document.getElementById('gen-key-btn');
    btn.classList.add('loading');
    try {
      const res = await req('/api/user/create-api-key', 'POST');
      document.getElementById('new-key').innerText = res.api_key;
      openModal('key-modal');
      loadData();
      toast('New API key created successfully', 'success');
    } catch (e) {
    } finally {
      btn.classList.remove('loading');
    }
  };

  window.transferCredits = async () => {
    const btn = document.getElementById('trans-btn');
    btn.classList.add('loading');
    try {
      const email = document.getElementById('trans-email').value;
      const amt = document.getElementById('trans-amount').value;
      const res = await req('/api/user/transfer-credits', 'POST', {
        receiver_email: email,
        amount: parseInt(amt)
      });
      toast(res.message || 'Credits transferred successfully', 'success');
      closeModal('transfer-modal');
      loadData();
    } catch (e) {
    } finally {
      btn.classList.remove('loading');
    }
  };

  window.revokeKey = async (key) => {
    if (!confirm('Revoke this key? It will stop working immediately.')) return;
    try {
      await req('/api/user/revoke-api-key', 'POST', { api_key: key });
      loadData();
      toast('Key revoked', 'warning');
    } catch (e) {}
  };

  // Delete key: separate option from revoke
  window.deleteKey = async (key) => {
    if (!confirm('Delete this key record permanently? This is usually done after rotation.')) return;
    try {
      await req('/api/user/delete-api-key', 'POST', { api_key: key });
      loadData();
      toast('Key deleted from console', 'success');
    } catch (e) {}
  };

  window.adminGrantSelf = async () => {
    try {
      await req('/api/admin/grant-credits', 'POST');
      loadData();
      toast('Admin wallet boost applied', 'success');
    } catch (e) {}
  };

  window.adminGift = async () => {
    try {
      await req('/api/admin/gift-credits', 'POST', {
        target_email: document.getElementById('gift-email').value,
        amount: parseInt(document.getElementById('gift-amount').value)
      });
      toast('Gift sent from admin wallet', 'success');
    } catch (e) {}
  };

  function toast(msg, type) {
    const d = document.createElement('div');
    d.className = 'toast';
    let color = '#00f5ff';
    let icon = 'info-circle';
    if (type === 'success') { color = '#00e676'; icon = 'check-circle'; }
    else if (type === 'warning') { color = '#ffae42'; icon = 'exclamation-triangle'; }
    else if (type === 'error') { color = '#ff1744'; icon = 'times-circle'; }
    d.style.borderColor = color;
    d.innerHTML = \`
      <i class="fas fa-\${icon}" style="color:\${color};"></i>
      <span>\${msg}</span>
    \`;
    document.getElementById('toast-container').appendChild(d);
    setTimeout(() => d.remove(), 4500);
  }

  // Background Stars Init
  const stars = document.getElementById('stars');
  for (let i = 0; i < 80; i++) {
    const s = document.createElement('div');
    s.className = 'star';
    s.style.left = Math.random() * 100 + '%';
    s.style.top = Math.random() * 100 + '%';
    const size = Math.random() * 2 + 0.5;
    s.style.width = size + 'px';
    s.style.height = size + 'px';
    s.style.animationDuration = (Math.random() * 3 + 2) + 's';
    s.style.animationDelay = (Math.random() * 5) + 's';
    stars.appendChild(s);
  }
</script>
</body>
</html>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date()); 

  gtag('config', 'G-J1YTKP10ZX');
</script>
