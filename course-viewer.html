<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Course Viewer | Elvion University</title>
  <meta name="description" content="Learn with interactive courses at Elvion University">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --dark-navy: #00001a;
      --black-bg: #000000;
      --cyan-glow: #00ffff;
      --light-blue-glow: #00aaff;
      --text-color: #e0e0e0;
      --heading-color: #ffffff;
      --gradient-start: #0a1128;
      --gradient-end: #121a30;
      --card-bg: rgba(18, 26, 48, 0.85);
      --border-glow: 0 0 10px var(--cyan-glow), 0 0 20px var(--light-blue-glow);
      --hover-glow: 0 0 15px var(--cyan-glow), 0 0 30px var(--light-blue-glow);
      --button-bg: linear-gradient(45deg, var(--cyan-glow), var(--light-blue-glow));
      --button-text-color: var(--black-bg);
      --star-color: rgba(255, 255, 255, 0.7);
      --sidebar-width: 300px;
      --success-color: #4ade80;
      --warning-color: #fbbf24;
      --error-color: #f87171;
      --primary-color: var(--cyan-glow);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--black-bg);
      color: var(--text-color);
      line-height: 1.7;
      overflow-x: hidden;
      position: relative;
      min-height: 100vh;
    }

    h1, h2, h3, h4, h5, h6 {
      font-family: 'Orbitron', sans-serif;
      color: var(--heading-color);
      margin-top: 0;
    }

    /* Stars Animation */
    #stars-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
      overflow: hidden;
    }

    .star {
      position: absolute;
      background-color: var(--star-color);
      border-radius: 50%;
      opacity: 0;
      animation: twinkle 4s infinite ease-in-out;
    }

    @keyframes twinkle {
      0%, 100% { opacity: 0; transform: scale(0.5); }
      50% { opacity: 1; transform: scale(1); }
    }

    /* Main Layout */
    .course-viewer-container {
      display: flex;
      min-height: 100vh;
      position: relative;
      z-index: 1;
    }

    /* Course Sidebar */
    .course-sidebar {
      width: var(--sidebar-width);
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(0, 255, 255, 0.2);
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 100;
      transition: transform 0.3s ease;
    }

    .course-sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--cyan-glow);
      text-decoration: none;
      font-weight: 600;
      padding: 0.8rem;
      border-radius: 8px;
      transition: all 0.3s ease;
      margin-bottom: 1rem;
    }

    .back-btn:hover {
      background: rgba(0, 255, 255, 0.1);
    }

    .course-info {
      text-align: center;
    }

    .course-icon-large {
      font-size: 3rem;
      color: var(--cyan-glow);
      text-shadow: var(--border-glow);
      margin-bottom: 1rem;
    }

    .course-title {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
      color: var(--heading-color);
    }

    .course-subtitle {
      font-size: 0.9rem;
      color: var(--text-color);
      opacity: 0.8;
      margin-bottom: 1rem;
    }

    .overall-progress {
      background: rgba(0, 0, 0, 0.3);
      border-radius: 10px;
      padding: 1rem;
      margin-bottom: 1rem;
    }

    .progress-label {
      font-size: 0.85rem;
      color: var(--text-color);
      margin-bottom: 0.5rem;
    }

    .progress-bar-container {
      width: 100%;
      height: 8px;
      background: rgba(0, 255, 255, 0.1);
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 0.5rem;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--button-bg);
      border-radius: 10px;
      transition: width 0.8s ease;
      box-shadow: 0 0 10px var(--cyan-glow);
    }

    .progress-text {
      font-size: 0.85rem;
      color: var(--cyan-glow);
      font-weight: 600;
    }

    /* Lessons List */
    .lessons-list {
      padding: 1rem 0;
    }

    .lessons-header {
      padding: 0 1.5rem 1rem 1.5rem;
      font-size: 1.1rem;
      color: var(--heading-color);
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
    }

    .lesson-item {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
      border-left: 3px solid transparent;
    }

    .lesson-item:hover {
      background: rgba(0, 255, 255, 0.05);
    }

    .lesson-item.active {
      background: rgba(0, 255, 255, 0.1);
      border-left-color: var(--cyan-glow);
    }

    .lesson-item.completed {
      opacity: 0.8;
    }

    .lesson-status {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.8rem;
      flex-shrink: 0;
    }

    .lesson-status.completed {
      background: var(--success-color);
      color: var(--black-bg);
    }

    .lesson-status.current {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .lesson-status.locked {
      background: rgba(255, 255, 255, 0.1);
      color: var(--text-color);
    }

    .lesson-details {
      flex: 1;
    }

    .lesson-title {
      font-size: 0.9rem;
      font-weight: 600;
      color: var(--heading-color);
      margin-bottom: 0.3rem;
    }

    .lesson-duration {
      font-size: 0.8rem;
      color: var(--text-color);
      opacity: 0.7;
    }

    /* Mobile Menu Toggle */
    .mobile-menu-toggle {
      display: none;
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 101;
      background: var(--card-bg);
      border: 1px solid var(--cyan-glow);
      border-radius: 8px;
      padding: 0.5rem 0.8rem;
      color: var(--cyan-glow);
      cursor: pointer;
      box-shadow: var(--border-glow);
    }

    /* Content Area */
    .content-area {
      flex: 1;
      margin-left: var(--sidebar-width);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    .content-header {
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
      padding: 1.5rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
    }

    .lesson-info h1 {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .lesson-meta {
      display: flex;
      gap: 1.5rem;
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .lesson-meta span {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .content-actions {
      display: flex;
      gap: 1rem;
      align-items: center;
    }

    .action-btn {
      padding: 0.8rem 1.5rem;
      background: var(--button-bg);
      color: var(--button-text-color);
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .action-btn:hover {
      box-shadow: var(--border-glow);
      transform: scale(1.05);
    }

    .action-btn.secondary {
      background: transparent;
      border: 2px solid var(--cyan-glow);
      color: var(--cyan-glow);
    }

    .action-btn.secondary:hover {
      background: var(--cyan-glow);
      color: var(--black-bg);
    }

    .action-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Main Content */
    .main-content {
      flex: 1;
      padding: 2rem;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
    }

    .content-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
      max-width: 900px; /* Fitting to page constraint */
      margin-left: auto;
      margin-right: auto;
    }

    .lesson-content {
      line-height: 1.8;
      font-size: 1.1rem;
    }

    .lesson-content h2 {
      color: var(--cyan-glow);
      margin: 2rem 0 1rem 0;
      font-size: 1.4rem;
    }

    .lesson-content h3 {
      color: var(--heading-color);
      margin: 1.5rem 0 0.8rem 0;
      font-size: 1.2rem;
    }

    .lesson-content p {
      margin-bottom: 1.2rem;
    }

    .lesson-content ul, .lesson-content ol {
      margin: 1rem 0 1rem 2rem;
    }

    .lesson-content li {
      margin-bottom: 0.5rem;
    }
    
    /* Code block styling for practical examples */
    .lesson-content code {
      background: rgba(0, 255, 255, 0.1);
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      color: var(--cyan-glow);
      font-family: 'Courier New', monospace;
    }

    .lesson-content pre {
      background: rgba(0, 0, 0, 0.5);
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid var(--cyan-glow);
      overflow-x: auto;
      margin: 1.5rem 0;
      box-shadow: 0 0 5px rgba(0, 255, 255, 0.3);
      position: relative;
    }

    .lesson-content pre code {
      background: none;
      padding: 0;
      color: var(--text-color);
      display: block;
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* Interactive Code/Markdown Area Simulation */
    .interactive-code-area {
        background: #1e1e2d;
        border: 2px solid var(--primary-color);
        border-radius: 8px;
        padding: 1rem;
        margin: 1.5rem 0;
        box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
    }
    .interactive-code-area textarea {
        width: 100%;
        min-height: 150px;
        background: transparent;
        color: var(--success-color);
        border: none;
        resize: vertical;
        padding: 0.5rem;
        font-family: 'Courier New', monospace;
        font-size: 1rem;
        outline: none;
    }
    .interactive-code-area .output {
        border-top: 1px dashed rgba(255, 255, 255, 0.2);
        padding-top: 0.5rem;
        color: var(--warning-color);
        font-size: 0.9rem;
        min-height: 30px;
        margin-top: 0.5rem;
    }
    .interactive-code-area .area-header {
        font-size: 0.8rem;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }


    /* Video Player Placeholder */
    .media-player {
      width: 100%;
      height: 400px;
      background: linear-gradient(135deg, var(--gradient-start), var(--gradient-end));
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 2rem;
      border: 1px solid rgba(0, 255, 255, 0.2);
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .media-placeholder {
      text-align: center;
      color: var(--text-color);
    }

    .media-placeholder i {
      font-size: 4rem;
      color: var(--cyan-glow);
      margin-bottom: 1rem;
      display: block;
    }

    /* Navigation Controls */
    .lesson-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1.5rem 2rem;
      background: var(--card-bg);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(0, 255, 255, 0.1);
    }

    .nav-info {
      display: flex;
      align-items: center;
      gap: 1rem;
      font-size: 0.9rem;
      color: var(--text-color);
    }

    .lesson-indicator {
      background: rgba(0, 255, 255, 0.1);
      padding: 0.5rem 1rem;
      border-radius: 20px;
      border: 1px solid rgba(0, 255, 255, 0.3);
    }

    .nav-buttons {
      display: flex;
      gap: 1rem;
    }

    /* Quiz/Assessment Styles */
    .quiz-container {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 2rem;
      box-shadow: var(--border-glow);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 255, 255, 0.1);
      margin-bottom: 2rem;
      max-width: 900px;
      margin-left: auto;
      margin-right: auto;
    }

    .quiz-question {
      font-size: 1.2rem;
      color: var(--heading-color);
      margin-bottom: 1.5rem;
      border-bottom: 1px solid rgba(0, 255, 255, 0.1);
      padding-bottom: 1rem;
    }

    .quiz-options {
      display: grid;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .quiz-option {
      padding: 1rem 1.5rem;
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(0, 255, 255, 0.2);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease, transform 0.1s ease; /* Added transform for animation */
      color: var(--text-color);
      position: relative;
    }

    .quiz-option:hover {
      border-color: var(--cyan-glow);
      background: rgba(0, 255, 255, 0.05);
      transform: translateY(-2px); /* Slight hover animation */
    }

    .quiz-option.selected {
      border-color: var(--cyan-glow);
      background: rgba(0, 255, 255, 0.1);
      color: var(--cyan-glow);
    }
    
    /* Correct/Incorrect state styling with simple animation */
    .quiz-option.correct {
      border-color: var(--success-color) !important;
      background: rgba(74, 222, 128, 0.1) !important;
      color: var(--success-color) !important;
      animation: flash-correct 0.3s ease-in-out;
    }

    .quiz-option.incorrect {
      border-color: var(--error-color) !important;
      background: rgba(248, 113, 113, 0.1) !important;
      color: var(--error-color) !important;
      animation: shake 0.3s;
    }
    
    .quiz-option.correct::after {
      content: ' (Correct)';
      color: var(--success-color);
      font-weight: bold;
      margin-left: 10px;
    }
    .quiz-option.incorrect::after {
      content: ' (Incorrect)';
      color: var(--error-color);
      font-weight: bold;
      margin-left: 10px;
    }
    
    @keyframes flash-correct {
        0% { opacity: 0.5; }
        100% { opacity: 1; }
    }
    
    @keyframes shake {
        0%, 100% { transform: translateX(0); }
        20%, 60% { transform: translateX(-5px); }
        40%, 80% { transform: translateX(5px); }
    }


    .quiz-feedback {
      padding: 1rem;
      border-radius: 8px;
      margin-top: 1rem;
      display: none;
    }

    .quiz-feedback.correct {
      background: rgba(74, 222, 128, 0.1);
      border: 1px solid rgba(74, 222, 128, 0.3);
      color: var(--success-color);
      display: block;
    }

    .quiz-feedback.incorrect {
      background: rgba(248, 113, 113, 0.1);
      border: 1px solid rgba(248, 113, 113, 0.3);
      color: var(--error-color);
      display: block;
    }
    
    /* Completion Modal Adjustments */
    .completion-modal .completion-icon {
        font-size: 4rem;
        color: var(--success-color);
        text-shadow: 0 0 10px var(--success-color);
        margin-bottom: 1rem;
        animation: pulse 1s infinite alternate;
    }
    
    .completion-modal .points-earned {
        font-size: 1.2rem;
        font-weight: 700;
        color: var(--cyan-glow);
        margin: 1.5rem 0;
        padding: 0.5rem 1rem;
        background: rgba(0, 255, 255, 0.1);
        border-radius: 8px;
        display: inline-block;
        border: 1px solid var(--cyan-glow);
    }
    
    @keyframes pulse {
        from { transform: scale(1); opacity: 0.8; }
        to { transform: scale(1.05); opacity: 1; }
    }


    /* Certificate Form & Final Page Styles */
    .final-page-content {
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }
    .certificate-form-card {
      background: var(--card-bg);
      border-radius: 15px;
      padding: 3rem;
      box-shadow: var(--hover-glow);
      border: 1px solid var(--primary-color);
      text-align: left;
      margin-top: 2rem;
    }
    .certificate-form-card h2 {
      color: var(--success-color);
      text-shadow: 0 0 10px var(--success-color);
      margin-bottom: 1.5rem;
    }
    .certificate-form-card label {
      display: block;
      margin-top: 1rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--text-color);
    }
    .certificate-form-card input[type="text"],
    .certificate-form-card input[type="email"] {
      width: 100%;
      padding: 0.8rem;
      border: 2px solid rgba(0, 255, 255, 0.3);
      border-radius: 8px;
      background: rgba(0, 0, 0, 0.3);
      color: var(--text-color);
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }
    .certificate-form-card input:focus {
      border-color: var(--cyan-glow);
      box-shadow: 0 0 5px var(--cyan-glow);
      outline: none;
    }
    .certificate-form-card .submit-btn {
      width: 100%;
      margin-top: 2rem;
    }

    /* Comment Section Styles */
    .comment-section {
        background: rgba(0, 0, 0, 0.3);
        border-radius: 10px;
        padding: 1.5rem;
        margin-top: 2rem;
        border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .comment-section textarea {
        width: 100%;
        min-height: 100px;
        padding: 1rem;
        border-radius: 8px;
        border: 2px solid rgba(0, 255, 255, 0.3);
        background: rgba(0, 0, 0, 0.5);
        color: var(--text-color);
        font-size: 1rem;
        resize: vertical;
        outline: none;
        transition: border-color 0.3s ease;
    }
    .comment-section textarea:focus {
        border-color: var(--cyan-glow);
        box-shadow: 0 0 5px var(--cyan-glow);
    }
    .comment-section .comment-btn {
        margin-top: 1rem;
        padding: 0.6rem 1.2rem;
        font-weight: 500;
        float: right;
    }

    /* Completion Modal */
    .completion-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .completion-content {
      background: var(--card-bg);
      padding: 3rem;
      border-radius: 15px;
      text-align: center;
      max-width: 500px;
      box-shadow: var(--hover-glow);
      border: 1px solid rgba(0, 255, 255, 0.3);
    }
    
    /* Loading State */
    .loading-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 50vh;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(0, 255, 255, 0.1);
      border-top-color: var(--cyan-glow);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text {
      margin-top: 1rem;
      color: var(--text-color);
      font-size: 1.1rem;
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .course-sidebar {
        transform: translateX(-100%);
      }

      .course-sidebar.active {
        transform: translateX(0);
      }

      .content-area {
        margin-left: 0;
      }

      .mobile-menu-toggle {
        display: block;
      }

      .main-content {
        padding: 1rem;
        padding-top: 4rem;
      }

      .content-header {
        padding: 1rem;
        flex-direction: column;
        align-items: flex-start;
      }

      .content-actions {
        width: 100%;
        justify-content: stretch;
      }

      .action-btn {
        flex: 1;
        justify-content: center;
      }

      .lesson-navigation {
        padding: 1rem;
        flex-direction: column;
        gap: 1rem;
      }

      .nav-buttons {
        width: 100%;
        justify-content: stretch;
      }

      .nav-buttons .action-btn {
        flex: 1;
      }
    }

    @media (max-width: 768px) {
      .media-player {
        height: 250px;
      }

      .content-card {
        padding: 1.5rem;
      }

      .completion-content {
        margin: 1rem;
        padding: 2rem;
      }

      .quiz-option {
        padding: 0.8rem 1rem;
      }
    }
  </style>
</head>
<body>
  <div id="stars-container"></div>

  <button class="mobile-menu-toggle" id="mobileMenuToggle">
    <i class="fas fa-bars"></i>
  </button>

  <div class="course-viewer-container">
    <aside class="course-sidebar" id="courseSidebar">
      <div class="course-sidebar-header">
        <a href="studyingatelvion.html" class="back-btn">
          <i class="fas fa-arrow-left"></i>
          Back to Dashboard
        </a>
        
        <div class="course-info">
          <i id="courseIconLarge" class="course-icon-large"></i>
          <h2 id="courseTitle" class="course-title">Loading...</h2>
          <p id="courseSubtitle" class="course-subtitle">Please wait...</p>
          
          <div class="overall-progress">
            <div class="progress-label">Overall Progress</div>
            <div class="progress-bar-container">
              <div id="overallProgressBar" class="progress-bar-fill" style="width: 0%"></div>
            </div>
            <div class="progress-text"><span id="overallProgressText">0% Complete</span></div>
            <div class="progress-text" style="margin-top: 0.5rem;"><i class="fas fa-trophy"></i> Total Points: <span id="totalPointsEarnedSidebar">0</span></div>
          </div>
        </div>
      </div>

      <div class="lessons-list">
        <div class="lessons-header">Course Lessons</div>
        <div id="lessonsContainer">
          </div>
      </div>
    </aside>

    <main class="content-area">
      <div class="loading-container" id="loadingContainer">
        <div class="loading-spinner"></div>
        <p class="loading-text">Loading course content...</p>
      </div>

      <header class="content-header" id="contentHeader" style="display: none;">
        <div class="lesson-info">
          <h1 id="lessonTitle">Lesson Title</h1>
          <div class="lesson-meta">
            <span><i class="fas fa-clock"></i> <span id="lessonDuration">45 min</span></span>
            <span><i class="fas fa-book"></i> Lesson <span id="currentLessonNumber">1</span> of <span id="totalLessons">8</span></span>
            <span><i class="fas fa-star"></i> <span id="lessonPoints">10</span> Points</span>
          </div>
        </div>
        <div class="content-actions">
          <button id="markCompleteBtn" class="action-btn" style="display: none;">
            <i class="fas fa-check"></i>
            Mark Complete
          </button>
        </div>
      </header>

      <section class="main-content" id="mainContent" style="display: none;">
        
        <div id="finalCoursePage" style="display: none;" class="final-page-content">
            <h1 style="color: var(--success-color); text-shadow: var(--hover-glow);">Course Completed!</h1>
            <p class="lead" style="margin-bottom: 2rem;">
                Congratulations! You have completed all lessons and earned your GP! The final step is to request your certificate.
            </p>
            
            <div class="overall-progress" style="margin-bottom: 3rem; background: var(--black-bg); border: 2px solid var(--success-color);">
                <div class="progress-label" style="font-size: 1.1rem; color: var(--success-color);">Your Final Course Grade Point (GP)</div>
                <div class="progress-text" style="font-size: 2rem; color: var(--success-color); font-weight: 800;"><span id="finalTotalPoints">0</span> Points</div>
                <p style="font-size: 0.9rem; margin-top: 0.5rem; opacity: 0.8;">(Based on 10 points per successfully completed lesson quiz)</p>
            </div>

            <div class="certificate-form-card">
                <h2>Certificate & Project Submission</h2>
                <p style="margin-bottom: 1.5rem; color: var(--warning-color);">
                    To receive your certificate, please fill in your details below. For courses with a project (e.g., Computer Science, Software Engineering, Visual Arts), please **email your Final Project** (as outlined in the last lesson) to: <strong style="color: var(--cyan-glow);">elvionailabs@gmail.com</strong>.
                </p>
                <form id="certificateForm" action="https://formspree.io/f/mldrbpwo" method="post">
                    <input type="hidden" name="_subject" id="formSubject">
                    <input type="hidden" name="Course Completed" id="completedCourseName">
                    <input type="hidden" name="Total Points Earned" id="formTotalPoints">
                    
                    <label for="fullName">Full Name (for Certificate):</label>
                    <input type="text" id="fullName" name="Full Name" required>

                    <label for="email">Email Address (for delivery):</label>
                    <input type="email" id="email" name="Email" required>

                    <label for="studentId">Elvion Student ID (Optional):</label>
                    <input type="text" id="studentId" name="Student ID">

                    <button type="submit" class="action-btn submit-btn">
                        <i class="fas fa-certificate"></i> Request Certificate
                    </button>
                </form>

                <div class="comment-section">
                    <h4>Feedback & Questions</h4>
                    <form>
                        <textarea placeholder="Share your experience, ask a question, or send a thank you note to Elvion!"></textarea>
                        <button type="submit" class="action-btn comment-btn secondary" style="background: var(--dark-navy); color: var(--cyan-glow);">Submit Feedback</button>
                    </form>
                </div>
            </div>
        </div>

        <div class="media-player" id="mediaPlayer">
          <div class="media-placeholder">
            <i class="fas fa-play-circle"></i>
            <p id="mediaPlaceholderText">Video/Media content coming soon</p>
            <p style="font-size: 0.9rem; opacity: 0.7;">For now, please read the lesson content below</p>
          </div>
        </div>

        <div class="content-card">
          <div id="lessonContent" class="lesson-content">
            </div>
        </div>

        <div id="quizContainer" class="quiz-container" style="display: none;">
          <h3 style="margin-bottom: 1.5rem; color: var(--warning-color);"><i class="fas fa-clipboard-check"></i> Mandatory Quiz: Pass to Proceed</h3>
          <p style="margin-bottom: 2rem; border-bottom: 1px solid rgba(0, 255, 255, 0.1); padding-bottom: 1rem;">
            You must correctly answer all questions below before the 'Next' lesson button is enabled.
          </p>
          <div id="quizQuestions">
            </div>
          <button id="submitQuizBtn" class="action-btn" style="width: 100%; margin-top: 2rem;">
            <i class="fas fa-paper-plane"></i> Submit Answers
          </button>
          <div id="quizResult" style="margin-top: 1rem;"></div>
        </div>
      </section>

      <nav class="lesson-navigation" id="lessonNavigation" style="display: none;">
        <div class="nav-info">
          <div class="lesson-indicator">
            Lesson <span id="navCurrentLesson">1</span> of <span id="navTotalLessons">8</span>
          </div>
          <span><i class="fas fa-trophy"></i> GP: <span id="totalPointsEarnedNav">0</span> Points</span>
        </div>
        <div class="nav-buttons">
          <button id="prevLessonBtn" class="action-btn secondary">
            <i class="fas fa-chevron-left"></i>
            Previous
          </button>
          <button id="nextLessonBtn" class="action-btn">
            Next
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
      </nav>
    </main>
  </div>

  <div id="completionModal" class="completion-modal">
    <div class="completion-content">
      <i class="fas fa-trophy completion-icon"></i>
      <h2 class="completion-title">Lesson Complete!</h2>
      <p class="completion-message">
        Congratulations! You've successfully completed the quiz and this lesson.
      </p>
      <div class="points-earned">
        <i class="fas fa-star"></i>
        You earned <span id="pointsEarned">10</span> points!
      </div>
      <div style="display: flex; gap: 1rem;">
        <button id="continueBtn" class="action-btn" style="flex: 1;">
          Continue Learning
        </button>
        <button id="backToDashboardBtn" class="action-btn secondary" style="flex: 1;">
          Back to Dashboard
        </button>
      </div>
    </div>
  </div>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import {
        getAuth,
        onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import {
        getFirestore,
        doc,
        getDoc,
        updateDoc
    } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAyROm0aBGjry6NUfhNM3e0qwPcCDoIqSk",
        authDomain: "elvionai.firebaseapp.com",
        projectId: "elvionai",
        storageBucket: "elvionai.firebasestorage.app",
        messagingSenderId: "161078300830",
        appId: "1:161078300830:web:f460df8591704eb0e96b8f"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // --- FALLBACK/DEFAULT LESSON & QUIZ FOR NEW COURSES ---
    const defaultLessonContent = `
        <h2>Welcome to Your Course!</h2>
        <p>This is the first lesson of your course. Here you will learn the foundational concepts.</p>
        <p>This course is designed to provide you with a comprehensive, pre-university foundation in your chosen field. Our learning methodology focuses on practical knowledge and critical thinking.</p>
        
        <h3>Elvion University Philosophy</h3>
        <p>Elvion University is dedicated to **providing free, quality pre-degree knowledge and certificates** to empower future students globally. Your commitment to completing this course is your most valuable credential.</p>
        
        <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-color: var(--warning-color);">
            <div class="area-header" style="color: var(--warning-color);"><span>Course Focus</span></div>
            <p>Please remember to focus on the core concepts of this subject. You will be tested on the content to ensure you grasp the fundamentals before moving to the next lesson.</p>
        </div>
    `;

    const defaultLesson = {
        id: 1,
        title: 'Course Introduction',
        duration: '40 min',
        content: defaultLessonContent,
        quiz: [
            { type: 'mcq', question: 'What is the main purpose of Elvion University?', options: ['Awarding accredited degrees', 'Providing free pre-degree knowledge and certificates', 'Replacing traditional universities', 'Offering high-cost private education'], answer: 'Providing free pre-degree knowledge and certificates' },
            { type: 'mcq', question: 'How is student progress measured in this course viewer?', options: ['Monthly Exams', 'Lesson by lesson mandatory quizzes', 'Instructor approval only', 'Number of videos watched'], answer: 'Lesson by lesson mandatory quizzes' },
        ]
    };

    // Helper to generate default lessons for other courses
    const generateDefaultLessons = (count, coursePrefix, isProject) => {
        return Array(count).fill(0).map((_, i) => {
            let lessonTitle = `Lesson ${i + 1}: Introduction to ${coursePrefix} Concepts`;
            let content = defaultLessonContent.replace(/Welcome!|This is the first lesson/g, `Welcome to ${coursePrefix}!`).replace(/Introduction/g, lessonTitle);

            if (i === 0) {
                // Keep the original quiz for the first lesson of a new course
                return {
                    ...defaultLesson,
                    id: i + 1,
                    title: `${coursePrefix} ${lessonTitle}`,
                    content: content,
                };
            }

            if (i === count - 1) {
                lessonTitle = isProject ? `Lesson ${i + 1}: Final Project / Capstone` : `Lesson ${i + 1}: Conclusion & Next Steps`;
                content = `<h2>${lessonTitle}</h2>
                    <p>Congratulations on reaching the final lesson of the ${coursePrefix} course!</p>
                    <p>This course's final requirement is a **Project Submission** (if \`isProject\` is true) or a final reflection. Follow the certificate steps on the next page.</p>
                    ${isProject ? `<p style="color: var(--cyan-glow);">**Project Submission Required:** Please check the last lesson for specific instructions and remember to **email your project to elvionailabs@gmail.com**.</p>` : ''}
                `;

                // Final lesson quiz should be specific if it's a project
                const finalQuiz = isProject ? [
                    { type: 'mcq', question: `For the ${coursePrefix} course, what is the final deliverable requirement?`, options: ['A final written exam', 'A Project/Capstone Submission', 'A face-to-face interview', 'A group presentation'], answer: 'A Project/Capstone Submission' },
                    { type: 'text', question: 'What is the email address to which you must submit your project for certificate review? (Enter exactly)', answer: 'elvionailabs@gmail.com' },
                ] : [
                    { type: 'mcq', question: `How many lessons did you complete in the ${coursePrefix} course?`, options: ['1', '5', '8', count.toString()], answer: count.toString() },
                    { type: 'mcq', question: 'What is the next suggested step after completing this course?', options: ['Retake the first lesson', 'Explore another Elvion course or request your certificate', 'Close the browser', 'Nothing'], answer: 'Explore another Elvion course or request your certificate' },
                ];

                return {
                    id: i + 1,
                    title: `${coursePrefix} ${lessonTitle}`,
                    duration: `${40 + Math.floor(Math.random() * 20)} min`, // Varied duration
                    content: content,
                    quiz: finalQuiz,
                };
            }

            // Simplified, universal quiz for placeholder lessons after the first one
            const simpleQuiz = [
                { type: 'mcq', question: `How many lessons are in the ${coursePrefix} course? (Hint: The answer is in the course metadata)`, options: ['1', '5', '8', count.toString()], answer: count.toString() },
                { type: 'mcq', question: `What is the most important skill for a ${coursePrefix} professional?`, options: ['Memorization', 'Critical Thinking & Problem Solving', 'Speed Reading', 'Ignoring details'], answer: 'Critical Thinking & Problem Solving' },
            ];

            return {
                id: i + 1,
                title: `${coursePrefix} ${lessonTitle}`,
                duration: `${40 + Math.floor(Math.random() * 20)} min`, // Varied duration
                content: content,
                quiz: simpleQuiz,
            };
        });
    };

    // --- ROBUST AND EXPANDED COMPUTER SCIENCE COURSE (CS101) ---
    // The lessons are now arranged sequentially by ID (1 through 8).
    const cs101Lessons = [
        {
            id: 1,
            title: 'L1: Foundations of Programming: Computational Thinking Across Disciplines',
            duration: '120 min',
            content: `
                <h2>Programming as a Universal Language</h2>
                <p>Programming is not just about writing codeâ€”it's a way of thinking that applies to biology (DNA sequences), economics (market models), physics (simulations), and art (generative design). This lesson explores how **computational thinking** transcends computer science and becomes a tool for solving problems in any domain.</p>

                <h3>Part 1: Computational Thinking - Theoretical Foundations</h3>
                <p>Jeannette Wing's seminal 2006 paper defined computational thinking as "the thought processes involved in formulating problems and their solutions so that the solutions are represented in a form that can be effectively carried out by an information-processing agent."</p>

                <h4>The Four Pillars - Deep Analysis</h4>
                
                <h5>1. Decomposition - Breaking Complexity</h5>
                <p>Breaking a large problem into smaller, manageable sub-problems.</p>
                <p><strong>Example:</strong> Analyzing a company by divisions (marketing, finance, operations) or solving a complex math equation by breaking it into simpler steps.</p>
                
                <pre><code class="language-python"># Computational Decomposition Example
# Problem: Calculate total cost of online order with tax and shipping

def calculate_item_total(items):
    """Calculate subtotal of all items"""
    return sum(item['price'] * item['quantity'] for item in items)

# Master function: combines all calculations
def calculate_total_order(items, tax_rate, weight, distance):
    # Implementation relies on smaller, separate functions (Decomposition)
    subtotal = calculate_item_total(items)
    # ... other calculations ...
    return subtotal # Simplified return
</code></pre>

                <p class="task-highlight">Task: Decompose a real-world process from your field of interest (e.g., planning a wedding, diagnosing a disease, launching a product) into at least 5 computational steps. Document in <code>decomposition_analysis.md</code>.</p>

                <h5>2. Pattern Recognition - Finding Universal Structures</h5>
                <p>Identifying similarities, trends, and regularities in data or problems. **Example:** Recognizing chord progressions in music or symptom patterns for medical diagnosis.</p>

                <h5>3. Abstraction - Essential vs. Incidental Complexity</h5>
                <p>Focusing on what matters and hiding unnecessary detail. A driver doesn't need to understand internal combustion to operate a carâ€”the steering wheel and pedals are **abstractions**.</p>

                <pre><code class="language-python"># HIGH-LEVEL (Abstracted, simple interface)
class EmailService:
    def send(self, to, subject, body):
        """Simple abstraction - user only provides content"""
        self._connect()
        self._compose_and_send(to, subject, body)
        self._disconnect()
    
    def _connect(self):
        # Implementation hidden from user
        pass
</code></pre>

                <h5>4. Algorithm Design - Step-by-Step Solutions</h5>
                <p>Algorithms exist everywhere: recipes, medical protocols, business processes. They define the exact steps and decision points needed to reach a defined outcome.</p>

                <h4>Exercise 1.1: Multi-Domain Algorithm Design</h4>
                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <tr style="background: rgba(99, 102, 241, 0.1);">
                        <th style="padding: 10px;">Domain</th>
                        <th style="padding: 10px;">Algorithm Example</th>
                        <th style="padding: 10px;">Key Decision Points</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Healthcare</td>
                        <td style="padding: 10px;">Triage protocol</td>
                        <td style="padding: 10px;">IF life-threatening THEN immediate care; ELSE assess severity</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Finance</td>
                        <td style="padding: 10px;">Loan approval</td>
                        <td style="padding: 10px;">IF credit_score > 700 AND income > threshold THEN approve</td>
                    </tr>
                </table>

                <p class="task-highlight">Task: Choose a field outside CS and write a detailed algorithm for a common process. Include conditions, loops, and edge cases. Save as <code>cross_domain_algorithm.txt</code>.</p>

                <h3>Part 2: Variables and Data Types - Mathematical Foundations</h3>
                
                <p>Understanding data types means understanding how computers represent information in binary and the memory constraints involved.</p>

                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <tr style="background: rgba(99, 102, 241, 0.1);">
                        <th style="padding: 10px;">Type</th>
                        <th style="padding: 10px;">Memory (typical)</th>
                        <th style="padding: 10px;">Range</th>
                        <th style="padding: 10px;">Use Case</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px;"><code>int</code></td>
                        <td style="padding: 10px;">4-8 bytes</td>
                        <td style="padding: 10px;">-2Â³Â¹ to 2Â³Â¹-1 (32-bit)</td>
                        <td style="padding: 10px;">Counting, indexing</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;"><code>float</code></td>
                        <td style="padding: 10px;">4-8 bytes</td>
                        <td style="padding: 10px;">~Â±3.4E38 (precision issues)</td>
                        <td style="padding: 10px;">Scientific calculations</td>
                    </tr>
                </table>

                <h4>Floating Point Precision - A Critical Issue</h4>
                <pre><code class="language-python"># The infamous floating point problem
a = 0.1 + 0.2
print(a)  # Output: 0.30000000000000004 (not exactly 0.3!)

# Why? Binary representation cannot precisely store 0.1
# Solution: Use decimal for exact arithmetic in finance/science.
from decimal import Decimal
b = Decimal('0.1') + Decimal('0.2')
print(b)  # Output: 0.3 (exact)
</code></pre>
                <p><strong>Cross-disciplinary analysis:</strong> In finance, rounding errors can cost millions. In physics simulations, accumulated float errors can make predictions diverge from reality.</p>

                <h3>Part 3: Development Environment - Professional Setup</h3>

                <h4>Why These Tools Matter</h4>
                <ul>
                    <li>**Python:** Powers Netflix recommendations, NASA data analysis, Instagram backend.</li>
                    <li>**Git/GitHub:** Essential for collaboration, version tracking, and portfolio hosting.</li>
                    <li>**VS Code:** Industry-standard Integrated Development Environment (IDE).</li>
                </ul>

                <h4>Advanced Setup: Virtual Environments</h4>
                <pre><code class="language-bash"># Why virtual environments? Isolation!
# Project A needs Django 3.2, Project B needs Django 4.0
# Solution: separate environments

python -m venv myproject_env
source myproject_env/bin/activate
pip install django pandas numpy
pip freeze > requirements.txt
</code></pre>

                <p class="task-highlight">Task: Set up a virtual environment, install 5 libraries (requests, pandas, matplotlib, flask, pytest), and document the process with screenshots. Save as <code>environment_setup.pdf</code>.</p>
                
                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <ul>
                        <li>Wing, J. M. (2006). "Computational Thinking." <code>doi.org/10.1145/1118178.1118215</code></li>
                        <li>PEP 8 Style Guide: <code>peps.python.org/pep-0008/</code> (For professional code standards).</li>
                    </ul>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'According to Jeannette Wing, computational thinking involves formulating problems so solutions can be:',
                    options: [
                        'Written in any human language',
                        'Represented in a form that can be effectively carried out by an information-processing agent',
                        'Understood only by programmers',
                        'Executed without computers'
                    ],
                    answer: 'Represented in a form that can be effectively carried out by an information-processing agent'
                },
                {
                    type: 'mcq',
                    question: 'Why does 0.1 + 0.2 not equal exactly 0.3 in most programming languages?',
                    options: [
                        'Programming error',
                        'Binary floating-point representation cannot precisely store certain decimal fractions',
                        'Computer hardware limitation',
                        'Python-specific bug'
                    ],
                    answer: 'Binary floating-point representation cannot precisely store certain decimal fractions'
                },
                {
                    type: 'text',
                    question: 'Explain the concept of abstraction using a real-world example outside of programming.',
                    answer: 'Driving a car abstracts engine mechanics; using an ATM abstracts banking operations; reading a map abstracts geographical terrain.'
                },
                {
                    type: 'mcq',
                    question: 'What is the primary purpose of a virtual environment in Python?',
                    options: [
                        'Make code run faster',
                        'Isolate project dependencies to avoid conflicts between different projects',
                        'Create backup copies of code',
                        'Compile Python to machine code'
                    ],
                    answer: 'Isolate project dependencies to avoid conflicts between different projects'
                },
                {
                    type: 'mcq',
                    question: 'What is pattern recognition in computational thinking?',
                    options: [
                        'Designing visual patterns',
                        'Identifying similarities, trends, and regularities in data or problems',
                        'Creating regular expressions',
                        'Matching text strings'
                    ],
                    answer: 'Identifying similarities, trends, and regularities in data or problems'
                },
                {
                    type: 'mcq',
                    question: 'Which debugging technique is most appropriate for production code running on live servers?',
                    options: [
                        'Print statements everywhere',
                        'Structured logging with different severity levels',
                        'Setting breakpoints with pdb',
                        'Commenting out code randomly'
                    ],
                    answer: 'Structured logging with different severity levels'
                },
                {
                    type: 'text',
                    question: 'Write the command to check which version of Python is installed on your system.',
                    answer: 'python --version'
                },
                {
                    type: 'mcq',
                    question: 'According to PEP 8, which is the correct naming convention for a Python function that calculates student grades?',
                    options: [
                        'CalculateStudentGrades',
                        'calculate_student_grades',
                        'CALCULATE_STUDENT_GRADES',
                        'calculateStudentGrades'
                    ],
                    answer: 'calculate_student_grades'
                },
                {
                    type: 'text',
                    question: 'Name two domains outside of computer science where algorithmic thinking is essential, and give one example from each.',
                    answer: 'Medicine (diagnostic protocols), Finance (trading algorithms), Manufacturing (quality control processes), etc.'
                },
                {
                    type: 'mcq',
                    question: 'What is the main goal of **Decomposition**?',
                    options: ['To add more code', 'To break a problem into smaller, manageable parts', 'To ignore details', 'To find patterns'],
                    answer: 'To break a problem into smaller, manageable parts'
                }
            ]
        },
        {
            id: 2,
            title: 'L2: Data Structures: Organizing and Managing Information at Scale',
            duration: '90 min',
            content: `
                <h2>Data Structures in Modern Software</h2>
                <p>Data structures are the building blocks of efficient software. They determine how information is organized, accessed, and manipulated. Choosing the right data structure can mean the difference between a program that runs in milliseconds versus one that takes hours.</p>

                <h3>Why Data Structures Matter</h3>
                <p>Imagine building a social network with 1 billion users. How do you store friendships? How do you find mutual friends in under a second? Or consider Spotify: how does it manage 100 million songs and instantly retrieve any track? The answer lies in carefully chosen **data structures**.</p>

                <h3>Part 1: Lists and Arrays</h3>
                <p>A list (or array) is an **ordered collection** of elements. Python lists are dynamic, allowing them to grow or shrink. Lists maintain insertion order and allow duplicate values.</p>

                <h4>Core List Operations & Complexity</h4>
                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <tr style="background: rgba(99, 102, 241, 0.1);">
                        <th style="padding: 10px; text-align: left;">Operation</th>
                        <th style="padding: 10px; text-align: left;">Time Complexity</th>
                        <th style="padding: 10px; text-align: left;">Use Case</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Access by index</td>
                        <td style="padding: 10px;">O(1)</td>
                        <td style="padding: 10px;">Direct access to any element</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Append</td>
                        <td style="padding: 10px;">O(1)</td>
                        <td style="padding: 10px;">Add to end</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Insert (middle)</td>
                        <td style="padding: 10px;">O(n)</td>
                        <td style="padding: 10px;">Insert at specific position (slow)</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;">Search</td>
                        <td style="padding: 10px;">O(n)</td>
                        <td style="padding: 10px;">Check if element exists (slow)</td>
                    </tr>
                </table>

                <h4>Practical Example: Building a Playlist Manager</h4>
                <pre><code class="language-python"># Save as: playlist_manager.py
class PlaylistManager:
    # ... (Implementation uses list for self.songs) ...
    def add_song(self, song):
        self.songs.append(song)
    def insert_song(self, position, song):
        self.songs.insert(position, song)
    # ... (rest of class) ...
</code></pre>
                <p class="task-highlight">Task: Implement the playlist manager, test all methods, and add two new features: (1) Move a song to a new position, (2) Find the index of a song. Save as <code>playlist_manager.py</code>.</p>

                <h3>Part 2: Dictionaries (Hash Maps)</h3>
                <p>Dictionaries store data as **key-value pairs**, providing extremely fast lookups. When you need to retrieve data by a unique identifier (like a user ID or product code), dictionaries are the **optimal choice ($\mathbf{O(1)}$ average time complexity)**.</p>

                <pre><code class="language-python"># Dictionary operations and performance
student = {
    "name": "Amara Okafor",
    "age": 21
}

# Fast lookup - O(1)
print(student["name"]) 

# Safe access with get() method
phone = student.get("phone", "Not provided") 
</code></pre>

                <h4>Real-World Application: Student Grade Management System</h4>
                <pre><code class="language-python"># Save as: grade_manager.py
class GradeManager:
    # Dictionary of dictionaries: student_id -> {name, grades}
    def __init__(self):
        self.students = {}
    
    def add_student(self, student_id, name):
        if student_id not in self.students:
            self.students[student_id] = {"name": name, "grades": {}}
    # ... (rest of class: add_grade, get_average, etc.) ...
</code></pre>
                <p class="task-highlight">Task: Extend this system with three features: (1) Delete a student, (2) Update a grade, (3) List all students in a specific course. Test thoroughly and save as <code>grade_manager.py</code>.</p>

                <h3>Part 3: Sets</h3>
                <p>Sets store **unique elements** with **no duplicates**. They are perfect for membership testing ($\mathbf{O(1)}$ average), removing duplicates, and mathematical set operations (union, intersection, difference).</p>

                <pre><code class="language-python"># Set operations and use cases
programming_languages = {"Python", "JavaScript", "Java", "C++"}
web_languages = {"JavaScript", "HTML", "CSS", "PHP"}

# Set operations
both = programming_languages.intersection(web_languages)  # Common elements
only_programming = programming_languages.difference(web_languages)

# Fast membership testing - O(1)
if "Python" in programming_languages:
    print("Python is a programming language")
</code></pre>

                <h4>Exercise 2.1: Friend Network Analyzer</h4>
                <p>Build a program that finds mutual friends between users using sets (intersection). This is a core social network feature.</p>
                <pre><code class="language-python"># Save as: friend_network.py
def find_mutual_friends(person1_friends, person2_friends):
    """Find friends in common between two people"""
    return person1_friends.intersection(person2_friends)
# ... (rest of application) ...
</code></pre>

                <p class="task-highlight">Task: Complete the friend network analyzer. Add features to: (1) Find friends of friends, (2) Calculate network size, (3) Detect isolated users. Save as <code>friend_network.py</code>.</p>

                <h3>Part 4: Stacks and Queues</h3>
                <p>These are **Abstract Data Types** that restrict access to manage data flow for specific purposes.</p>

                <h4>Stack (LIFO - Last In, First Out)</h4>
                <p>Think of a stack of plates. Used in function call management and **undo/redo features**.</p>

                <pre><code class="language-python"># Stack implementation and applications
class Stack:
    def push(self, item): self.items.append(item)
    def pop(self): return self.items.pop() 
# Application: Balanced Parentheses Checker relies on LIFO
</code></pre>

                <h4>Queue (FIFO - First In, First Out)</h4>
                <p>A line at a bank. Used to manage **print jobs, task scheduling**, and processing requests in order.</p>

                <pre><code class="language-python"># Queue implementation using collections.deque (efficient)
from collections import deque
class Queue:
    def enqueue(self, item): self.items.append(item)
    def dequeue(self): return self.items.popleft()
# Application: Print Queue Simulator relies on FIFO
</code></pre>

                <h4>Exercise 2.2: Complete Stack Applications</h4>
                <p class="task-highlight">Task: Implement these three programs and save each:</p>
                <ol>
                    <li><code>undo_system.py</code> - Build an undo/redo system for a text editor using two stacks</li>
                    <li><code>browser_history.py</code> - Simulate browser back/forward buttons with stacks</li>
                    <li><code>task_scheduler.py</code> - Create a priority task queue where high-priority tasks jump to the front</li>
                </ol>

                <h3>Part 5: Performance Analysis (Big O)</h3>
                <p>Understanding **time complexity** helps you choose the right data structure. **Big O notation** describes how performance scales with input size $n$.</p>

                <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
                    <tr style="background: rgba(99, 102, 241, 0.1);">
                        <th style="padding: 10px;">Complexity</th>
                        <th style="padding: 10px;">Name</th>
                        <th style="padding: 10px;">Example</th>
                    </tr>
                    <tr>
                        <td style="padding: 10px;"><code>O(1)</code></td>
                        <td style="padding: 10px;">Constant</td>
                        <td style="padding: 10px;">Dictionary lookup, array access by index</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;"><code>O(n)</code></td>
                        <td style="padding: 10px;">Linear</td>
                        <td style="padding: 10px;">List search, iteration</td>
                    </tr>
                    <tr>
                        <td style="padding: 10px;"><code>O(nÂ²)</code></td>
                        <td style="padding: 10px;">Quadratic</td>
                        <td style="padding: 10px;">Nested loops, bubble sort</td>
                    </tr>
                </table>

                <p class="task-highlight">Task: Run the benchmark comparing list vs. set search performance, record results, and write a brief analysis (200 words) explaining why sets are faster for membership testing. Save as <code>performance_analysis.md</code>.</p>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <ul>
                        <li>Python Data Structures Documentation: <code>docs.python.org/3/tutorial/datastructures.html</code></li>
                        <li>Visualizing Data Structures: <code>visualgo.net</code></li>
                        <li>Big O Cheat Sheet: <code>bigocheatsheet.com</code></li>
                    </ul>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'What is the average time complexity for looking up a value by key in a Python dictionary?',
                    options: ['O(1)', 'O(log n)', 'O(n)', 'O(nÂ²)'],
                    answer: 'O(1)'
                },
                {
                    type: 'mcq',
                    question: 'Which data structure would be most efficient for checking if a user has already visited a webpage (to avoid duplicates)?',
                    options: ['List', 'Dictionary', 'Set', 'Queue'],
                    answer: 'Set'
                },
                {
                    type: 'mcq',
                    question: 'In a stack data structure, which element is removed first?',
                    options: ['The first element added', 'The last element added', 'A random element', 'The middle element'],
                    answer: 'The last element added'
                },
                {
                    type: 'text',
                    question: 'Explain one real-world application where a queue (FIFO) would be more appropriate than a stack (LIFO).',
                    answer: 'Print job management, customer service ticket system, task scheduling, or any scenario where first-come-first-served is needed.'
                },
                {
                    type: 'mcq',
                    question: 'What is the time complexity of appending an element to the end of a Python list?',
                    options: ['O(1) amortized', 'O(log n)', 'O(n)', 'O(n log n)'],
                    answer: 'O(1) amortized'
                },
                {
                    type: 'mcq',
                    question: 'Which operation would be most efficient on a set compared to a list?',
                    options: ['Access by index', 'Maintain order', 'Check membership (if element exists)', 'Allow duplicates'],
                    answer: 'Check membership (if element exists)'
                },
                {
                    type: 'mcq',
                    question: 'You need to implement a browser back button. Which data structure is most suitable?',
                    options: ['Queue', 'Stack', 'Set', 'Dictionary'],
                    answer: 'Stack'
                },
                {
                    type: 'text',
                    question: 'What is the main difference between a list and a set in Python? Name two differences.',
                    answer: 'Lists allow duplicates and maintain order; sets store only unique elements and have no guaranteed order.'
                },
                {
                    type: 'mcq',
                    question: 'Which Python collection would you use to count the frequency of each word in a document most efficiently?',
                    options: ['List', 'Dictionary', 'Set', 'Tuple'],
                    answer: 'Dictionary'
                },
                {
                    type: 'mcq',
                    question: 'In the balanced parentheses checker example, what would happen if you used a queue instead of a stack?',
                    options: [
                        'It would work the same',
                        'It would fail because FIFO order does not match the nesting structure',
                        'It would be faster',
                        'It would use less memory'
                    ],
                    answer: 'It would fail because FIFO order does not match the nesting structure'
                }
            ]
        },
        {
            id: 3,
            title: 'L3: Object-Oriented Programming: Building Scalable Systems',
            duration: '90 min',
            content: `
                <h2>Why Object-Oriented Programming?</h2>
                <p>Object-Oriented Programming (**OOP**) lets you build code by mimicking the structure of real-world systems. Instead of treating everything as just data and functions, you group attributes and behaviors together in **self-contained objects**. OOP is essential in everything from web apps to games and enterprise systems.</p>

                <h3>OOP Concepts in Depth</h3>
                <ul>
                    <li>
                        <strong>Encapsulation:</strong> Group data (attributes) and logic (methods) together so the object's state can only be changed by its own methods, protecting internal data integrity.
                        <pre><code class="language-python">class Account:
  def __init__(self, number, owner, balance):
    self._balance = balance  # protected/private data
  def deposit(self, amount):
    self._balance += amount # Access via method
  def get_balance(self):
    return self._balance # Access via method
</code></pre>
                    </li>
                    <li>
                        <strong>Inheritance:</strong> Build new types by extending existing ones (**subclass** extends **superclass**).
                        <pre><code class="language-python">class Animal:
  def speak(self):
    print("Some sound")

class Dog(Animal): # Dog inherits Animal's properties
  def speak(self):
    print("Woof!")
</code></pre>
                    </li>
                    <li>
                        <strong>Polymorphism:</strong> Classes can share the same interface (e.g., the \`speak()\` method), but have their own unique behaviors.
                        <pre><code class="language-python">def animal_sound(animal):
  animal.speak() # Polymorphic call

dog = Dog()
cat = Cat()
animal_sound(dog)  # Woof!
animal_sound(cat)  # Meow!
</code></pre>
                    </li>
                    <li>
                        <strong>Abstraction:</strong> Hide internal complexity. Only expose necessary parts to the user (e.g., using the \`send()\` method in an Email class without seeing the complex SMTP handshake).
                        <pre><code class="language-python">from abc import ABC, abstractmethod

class Vehicle(ABC): # Abstract Base Class
  @abstractmethod
  def move(self):
    pass
# Car must implement move()
class Car(Vehicle):
  def move(self):
    print("Driving a car")
</code></pre>
                    </li>
                </ul>

                <h4>Guided Project: Zoo Management System</h4>
                <p>The system requires using **Inheritance** (Lion, Elephant, Parrot extend Animal) and **Polymorphism** (the \`all_speak\` method works on all animals).</p>
                <pre><code class="language-python"># Save as: zoo.py
class Animal: # Base Class
  def __init__(self, name):
    self.name = name
  def speak(self):
    print(f"{self.name} makes a generic sound.")

class Lion(Animal): # Subclass
  def speak(self):
    print(f"{self.name} roars.")

# ... (Elephant, Parrot subclasses and Zoo class follow) ...
</code></pre>
                <p class="task-highlight">Task: Expand the Zoo by allowing animals to have diets, ages, and a method for feeding time. Print a daily log of feeding all animals with their names and diets. Save as <code>zoo.py</code>.</p>

                <h3>Design Exercises</h3>
                <ul>
                    <li>Refactor the banking system: introduce a new <code>PremiumAccount</code> with bonus interest, using inheritance.</li>
                    <li>Use OOP principles to design a Library Management System (books, members, loans).</li>
                    <li>Explain, in your own words, why polymorphism is vital in large-scale appsâ€”give an example from your experience or from open-source projects.</li>
                </ul>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <p>Research **Design Patterns** (like the Factory Pattern) to see how OOP principles are applied to solve common architectural problems.</p>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'What keyword is used to create a subclass in Python?',
                    options: ['extends', 'inherits', 'class', 'base'],
                    answer: 'class'
                },
                {
                    type: 'mcq',
                    question: 'In OOP, what is "encapsulation"?',
                    options: [
                        'Reducing memory usage',
                        'Grouping data and methods together in a class',
                        'Making methods public',
                        'Avoiding inheritance'
                    ],
                    answer: 'Grouping data and methods together in a class'
                },
                {
                    type: 'text',
                    question: 'Describe a practical use-case for inheritance in software. Why is it useful?',
                    answer: 'Reusable code logic between parent and child classes (e.g., all bank accounts share a withdraw method, but a savings account adds an interest method).'
                },
                {
                    type: 'mcq',
                    question: 'What does polymorphism enable in a team project?',
                    options: [
                        'Copy/pasting code',
                        'Multiple objects sharing the same interface',
                        'Hard-coding all values',
                        'Using many programming languages'
                    ],
                    answer: 'Multiple objects sharing the same interface'
                },
                {
                    type: 'mcq',
                    question: 'Which Python keyword is used for an abstract base class?',
                    options: ['abstract', 'base', 'ABC', 'super'],
                    answer: 'ABC'
                }
            ]
        },
        {
            id: 4,
            title: 'L4: Database Systems: Foundations and Real-World Use',
            duration: '90 min',
            content: `
                <h2>Introduction to Databases</h2>
                <p>A database manages large, structured data efficiently and securely. **Relational databases** (like MySQL, PostgreSQL, SQLite) use tables, rows, columns, and **SQL** for queries. **NoSQL databases** (MongoDB, Redis) store key-value pairs, JSON, documents, or graphs for maximal flexibility.</p>

                <h3>What Makes a Good Database?</h3>
                <ul>
                    <li>Data integrity (no loss, always accurate)</li>
                    <li>Fast access by query (Performance)</li>
                    <li>Supports multiple users concurrently (Concurrency)</li>
                    <li>Security and disaster recovery (Backups, permissions)</li>
                </ul>

                <h3>Relational Design</h3>
                <p>Tables represent entities (e.g., Students, Courses). Key rules:</p>
                <ul>
                    <li>**Primary key:** Unique value for each record (Student ID)</li>
                    <li>**Foreign key:** Links records between tables (Student ID in Enrollment table)</li>
                    <li>**Normalization:** Process to remove redundancy for efficient storage</li>
                </ul>
                <pre><code class="language-sql">
CREATE TABLE Students (
  id INT PRIMARY KEY,
  name TEXT,
  email TEXT
);

CREATE TABLE Enrollment (
  student_id INT,
  course_id INT,
  grade FLOAT,
  FOREIGN KEY(student_id) REFERENCES Students(id)
);
</code></pre>
                <p class="task-highlight">Task: Draw an ER diagram for a university with Students, Courses, and Instructors. List all possible links and constraints in a short text file.</p>

                <h3>SQL in Action</h3>
                <pre><code class="language-sql">
-- Find all students in a given course
SELECT Students.name, Enrollment.grade
FROM Students
JOIN Enrollment ON Students.id = Enrollment.student_id
WHERE Enrollment.course_id = 101;
</code></pre>

                <h3>NoSQL: Flexibility and Scale</h3>
                <p>MongoDB example, storing user documents (flexible schema):</p>
                <pre><code class="language-json">
{
  "_id": "user123",
  "name": "Chidinma Eze",
  "courses": ["CS101", "MATH201"],
  "profile": { "year": 2023, "completed": true }
}
</code></pre>
                <p class="task-highlight">Task: Design a JSON document schema to store a user's grades per course and overall GPA.</p>

                <h3>Advanced: Transactions and Indexing</h3>
                <ul>
                    <li>**Transactions:** Ensure **all-or-nothing** data updates (critical for moving money).</li>
                    <li>**Indexes:** Speed up search queries (like the index in a book).</li>
                </ul>
                <p class="task-highlight">Research: Find one real-world database outage (e.g., Twitter, Facebook, major banks) and write 150 words summarizing the cause and fix.</p>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <p>Research the **ACID properties** (Atomicity, Consistency, Isolation, Durability) that define a reliable transaction system in relational databases.</p>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'Which SQL statement retrieves all columns from the table Students?',
                    options: ['SELECT * FROM Students;', 'INSERT INTO Students;', 'UPDATE Students;', 'DROP Students;'],
                    answer: 'SELECT * FROM Students;'
                },
                {
                    type: 'mcq',
                    question: 'What is the purpose of a foreign key?',
                    options: [
                        'Uniquely identifies table columns',
                        'Links records between tables',
                        'Deletes records',
                        'Splits tables in half'
                    ],
                    answer: 'Links records between tables'
                },
                {
                    type: 'text',
                    question: 'Write a SQL statement to find all students whose names start with A.',
                    answer: "SELECT * FROM Students WHERE name LIKE 'A%';"
                },
                {
                    type: 'mcq',
                    question: 'Which MongoDB structure best stores user data and grades?',
                    options: ['Array', 'Table', 'Document', 'Tuple'],
                    answer: 'Document'
                },
                {
                    type: 'mcq',
                    question: 'Why use transactions in databases?',
                    options: [
                        'Make code faster',
                        'Ensure all-or-nothing data updates',
                        'Allow duplicate primary keys',
                        'Prevent email sending'
                    ],
                    answer: 'Ensure all-or-nothing data updates'
                }
            ]
        },
        {
            id: 5,
            title: 'L5: Software Engineering Principles: From Idea to Product',
            duration: '90 min',
            content: `
                <h2>Software Engineering: Structured Development</h2>
                <p>Software engineering transforms ideas into **reliable, maintainable software products**. Itâ€™s about creating scalable systems, working as teams, and continuously improving quality. Key principles include planning, iteration, testing, and documentation.</p>

                <h3>Development Life Cycle (SDLC)</h3>
                <ol>
                    <li>**Requirements:** Gather and document needs. What are the users' problems?</li>
                    <li>**Design:** Draw diagrams (UML, ERD) to show *how* the system works.</li>
                    <li>**Implementation:** Coding, building the actual software.</li>
                    <li>**Testing:** Verify features work (Unit, integration, user acceptance tests).</li>
                    <li>**Deployment:** Launch for user access.</li>
                    <li>**Maintenance:** Bug fixes, updates, improvements.</li>
                </ol>

                <h3>Development Methodologies</h3>
                <ul>
                    <li>
                        **Agile:** Fast, **iterative**, continuous feedback; popular in tech firms.
                    </li>
                    <li>
                        **Waterfall:** **Sequential steps**, best for tightly-scoped projects with fixed requirements.
                    </li>
                    <li>
                        **Kanban & Scrum:** Popular frameworks for implementing Agile.
                    </li>
                </ul>
                <p class="task-highlight">Task: Research one real-world Agile project and summarize its sprint process in 150 words.</p>

                <h3>Version Control with Git and GitHub</h3>
                <pre><code class="language-bash">git init
git add .
git commit -m "Initial version"
git push origin main
</code></pre>
                <p>
                    **Branching:** Develop features in isolation, which prevents breaking the main, working version of the code until the feature is tested and ready to merge.
                </p>
                <p class="task-highlight">Task: Fork an open-source repo on GitHub, create a new branch, and submit a simple change or README edit (Simulated). </p>

                <h3>Testing: Automated and Manual</h3>
                <ul>
                    <li>**Unit Test:** Test smallest units, e.g. functions/classes.</li>
                    <li>**Integration Test:** Check how multiple components work together.</li>
                    <li>**Acceptance Test (UAT):** Final step, actual users verify system meets requirements.</li>
                </ul>
                <pre><code class="language-python">def add(x, y): return x + y

def test_add():
  assert add(2, 3) == 5 # Unit Test Example
</code></pre>

                <h3>Documentation and Collaboration</h3>
                <p>
                    Well-documented code and clear project manuals help future maintainers and new team members. Use README files, **docstrings**, issue tracking, and comments.
                </p>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <p>Read the **Agile Manifesto** to understand the twelve core principles that guide iterative software development.</p>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'A software development methodology that favors frequent delivery and adapting to change is called:',
                    options: ['Waterfall', 'Agile', 'Rigid', 'Integration'],
                    answer: 'Agile'
                },
                {
                    type: 'mcq',
                    question: 'What is the main purpose of branching in Git?',
                    options: [
                        'To create more bugs',
                        'To isolate new features/changes until tested and ready',
                        'To delete old code',
                        'To change languages'
                    ],
                    answer: 'To isolate new features/changes until tested and ready'
                },
                {
                    type: 'mcq',
                    question: 'Which testing phase ensures actual users approve the functionality?',
                    options: ['Unit', 'Integration', 'Acceptance', 'Deployment'],
                    answer: 'Acceptance'
                },
                {
                    type: 'text',
                    question: 'Why is documentation important for software longevity?',
                    answer: 'It explains what the code does, how it works, and how to maintain it for future developers, ensuring project longevity.'
                },
                {
                    type: 'mcq',
                    question: 'In the SDLC, which phase comes after "Implementation"?',
                    options: ['Design', 'Testing', 'Analysis', 'Deployment'],
                    answer: 'Testing'
                }
            ]
        },
        {
            id: 6,
            title: 'L6: Computer Networks: Systems Thinking and Global Impact',
            duration: '120 min',
            content: `
                <h2>Networks: The Architecture of Digital Society</h2>
                <p>Computer networks power nearly all modern interactions. The science of networking extends to fields like **epidemiology** (disease spread) and **logistics** (traffic/package routing), where systems thinking is essential.</p>

                <h3>In Focus: OSI Modelâ€”Layers With Real-World Echoes</h3>
                <p>The **OSI (Open Systems Interconnection) Model** describes communication in 7 layers, critical for troubleshooting:</p>
                <ul>
                    <li>**Layer 1â€”Physical:** Cables, WiFi, fibre (the raw hardware connection).</li>
                    <li>**Layer 3â€”Network:** **Routing**, **IP addresses**. Analogous to urban planners designing street layouts for traffic flow.</li>
                    <li>**Layer 4â€”Transport:** **TCP/UDP**â€”compare package delivery companies (guaranteed delivery vs. cheapest/speediest no-guarantee mailing).</li>
                    <li>**Layers 5â€“7 (Application):** Secure banking sessions (**HTTPS**), cloud apps, and collaboration tools.</li>
                </ul>

                <h4>Industry Cross-Check: Cybersecurity & Health</h4>
                <ul>
                    <li>**Network security:** Hospitals prevent ransomware attacks by **segmenting networks**â€”analogous to **quarantining** patient rooms to limit infection spread.</li>
                    <li>**Case Study:** Research the 2017 NHS ransomware attack: which layers of the stack failed, and how did public health teams respond using IT and medical protocol at once?</li>
                </ul>

                <h3>Protocol Analysis and Applied Case</h3>
                <ul>
                    <li>**DNS Manipulation:** Internet censorship works via DNS tampering; compare this to how information moves through social protest networks.</li>
                    <li>**TCP (Reliable):** Used for web pages, email, and banking where data integrity is paramount.</li>
                    <li>**UDP (Fast):** Used for live video/audio where dropping a few packets is acceptable for speed.</li>
                </ul>

                <h4>Lab: Building a Robust Chat App</h4>
                <p>This task requires applying transport layer concepts to handle unreliable real-world connections.</p>
                <ol>
                    <li>Using <code>socket</code> in Python, create a multi-user chatroom (design for dropped messages, lag, reconnections).</li>
                    <li>Extend your chat app: Add private messaging, broadcast, and â€œnetwork diagnosticsâ€ (users can ping, trace, and display their IP from inside the app).</li>
                </ol>
                <p class="task-highlight">Document all error cases encounteredâ€”network timeouts, out-of-order messages, abrupt disconnectsâ€”and propose fixes borrowed from real-world network protocols.</p>

                <h4>Research & Writing Task</h4>
                <ul>
                    <li>Write 300 words explaining similarities and differences between digital network failure and an epidemiology case (e.g. COVID-19 superspreaders).</li>
                </ul>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <p>Research the concept of the **"Traceroute"** command and how it helps visualize Layer 3 routing by leveraging the Time-To-Live (TTL) field in IP packets.</p>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'Which OSI layer would be most affected if a cityâ€™s electrical grid is struck by lightning and physical internet cables are fried?',
                    options: ['Data Link', 'Physical', 'Presentation', 'Session'],
                    answer: 'Physical'
                },
                {
                    type: 'text',
                    question: 'Describe a way in which â€œload balancingâ€ of road traffic is similar to or different from digital packet routingâ€”give a real example.',
                    answer: 'Similar: Both use algorithms to distribute load (cars/packets) across multiple paths to optimize flow/minimize congestion. Different: Packets can be instantly rerouted; traffic movement is slower/less flexible.'
                },
                {
                    type: 'mcq',
                    question: 'Which protocol is most commonly used for streaming live events (where speed is more important than lossless delivery)?',
                    options: ['TCP', 'UDP', 'FTP', 'SMTP'],
                    answer: 'UDP'
                },
                {
                    type: 'text',
                    question: 'How does hospital network segmentation compare with the practice of quarantining infectious patients in health science?',
                    answer: 'Both are analogous; segmentation separates digital systems (like firewalls) to prevent malware/infection spread, just as quarantining separates patients to prevent biological infection spread.'
                },
                {
                    type: 'mcq',
                    question: 'Which tool can best show you the â€œpathâ€ a message takes across networks?',
                    options: ['ping', 'traceroute', 'ifconfig', 'nslookup'],
                    answer: 'traceroute'
                }
            ]
        },
        {
            id: 7,
            title: 'L7: Artificial Intelligence: Algorithms and Societies',
            duration: '120 min',
            content: `
                <h2>AI as a Multidisciplinary Force</h2>
                <p>The reach of **AI** goes far beyond computersâ€”it shapes justice (predictive policing), healthcare (diagnosis), and environmental science (climate models). This lesson explores AIâ€™s theoretical roots and nuanced impacts on diverse fields.</p>

                <h3>Theory: Data, Representation, and Decision-Making</h3>
                <ul>
                    <li>**Cross-Disciplinary Insight:** AI models resemble medical diagnostics (X-ray interpretation) and legal risk scores, highlighting the real ethical consequences of algorithmic decisions.</li>
                    <li>**Algorithm Transparency:** Doctors and lawyers need to â€œsee the reasoning.â€ **AI Explainability** (interpretable models, feature importance) is now a growing legal and ethical requirement.</li>
                    <li class="task-highlight">Write a summary of a news article where opaque AI caused a real-world controversy (search: COMPAS recidivism or Amazon CV filter bias).</li>
                </ul>

                <h4>Hands-On: Interpretable Models</h4>
                <p>Simple models like Decision Trees are highly interpretable, unlike complex neural networks ("black boxes").</p>
                <pre><code class="language-python"># Simple decision tree for explainability
from sklearn.tree import DecisionTreeClassifier, export_text
X = [[0,0], [1,1], [0,1], [1,0]]
y = [0,1,1,0]
tree = DecisionTreeClassifier()
tree.fit(X, y)
print(export_text(tree, feature_names=["input1", "input2"]))
</code></pre>

                <h3>Applied Case Study: AI in Medicine</h3>
                <ol>
                    <li>Research AI-driven radiology or COVID triage.</li>
                    <li>Analyze one system for accuracy, bias, and transparency.</li>
                    <li class="task-highlight">Design your own mini-diagnostic system: Given simple â€œsymptomsâ€ as key-value inputs, write a rules-based classifier in code (simulated task).</li>
                </ol>

                <h4>Lab: Data Visualization, Fairness, and Bias</h4>
                <p>Data visualization is essential for uncovering algorithmic bias across different social groups.</p>
                <pre><code class="language-python"># Data visualizationâ€”model fairness across groups
import pandas as pd, matplotlib.pyplot as plt
df = pd.DataFrame({"score": [0.8,0.4,0.9,0.6,0.2], "group": ["A","B","A","B","A"], "label": [1,0,1,1,0]})
grouped = df.groupby('group').mean()
grouped['score'].plot(kind='bar')
plt.title('Average AI Score by Group')
plt.show()
</code></pre>
                <p>Can you spot any unfair trends? What could cause them?</p>

                <h3>Critical Reflection</h3>
                <p>Debate: Should AI make decisions in court? In hospital triage? Who is responsible for AI mistakesâ€”engineers, users, legislators?</p>
                <p class="task-highlight">Write a 250-word personal reflection on the pros and cons of AI in a field you care aboutâ€”how would you ensure fairness and transparency?</p>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <p>Research the **"Black Box Problem"** in deep learning and the methods used (like LIME or SHAP) to make complex models more interpretable.</p>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'Which discipline is most concerned with AI explainability for real-world legal decisions?',
                    options: ['Finance', 'Law', 'Art', 'Agriculture'],
                    answer: 'Law'
                },
                {
                    type: 'text',
                    question: 'Describe a case where AI bias caused harm in medicine, law, or education. What transparency/fairness fixes could be used?',
                    answer: 'Example: Facial recognition being less accurate for darker skin tones (Bias); Fix: Require diverse training data and use interpretable models (Transparency).'
                },
                {
                    type: 'mcq',
                    question: 'Which Python tool is best for visualizing model performance and fairness across different social groups?',
                    options: ['math', 'matplotlib', 'nano', 'pytest'],
                    answer: 'matplotlib'
                },
                {
                    type: 'mcq',
                    question: 'What is one benefit of using decision trees over deep neural networks in a sensitive application?',
                    options: [
                        'Better raw accuracy',
                        'Faster computation',
                        'More interpretable decisions (you can see the "why")',
                        'No need for data'
                    ],
                    answer: 'More interpretable decisions (you can see the "why")'
                },
                {
                    type: 'mcq',
                    question: 'The problem where AI models are too complex to understand the reasoning for a decision is known as the:',
                    options: ['Turing Test', 'Black Box Problem', 'O(1) Problem', 'NP-Hard Problem'],
                    answer: 'Black Box Problem'
                }
            ]
        },
        {
            id: 8,
            title: 'L8: Capstone Project: Synthesis & Societal Impact',
            duration: '150 min',
            content: `
                <h2>Capstone: Building for Real-World, Real People</h2>
                <p class="lead" style="color: var(--warning-color);">This project is not just proof of skills, but a demonstration of your readiness to work across boundaries. Youâ€™ll deliver code and analysis that matter for technology, people, systems, and society.</p>

                <h3>Your Task: Integrative Challenge</h3>
                <p>Your capstone must synthesize concepts from all lessons (L1-L7) and connect technology with a field outside of core CS (e.g., health, finance, education, arts).</p>
                <ol>
                    <li>
                        **Software Engineering:** Use iterative SDLCâ€”show your requirements, design (with diagrams), code, test plan, and deployment instructions. 
                        <ul><li>Include at least one diagram: ERD for a database, or UML sequence/class diagram for your system.</li></ul>
                    </li>
                    <li>
                        **Networking:** Incorporate a communication protocol (e.g., your app interacts with a remote API, or does peer-to-peer messaging via sockets).
                    </li>
                    <li>
                        **AI/Data:** Include a small ML prediction (even a simple rules-based system) or at least show data analytics/visualization relevant to your field.
                    </li>
                </ol>

                <h3>Deliverables (Mandatory)</h3>
                <ul>
                    <li>**Source Code, tests, and professional README (GitHub link required)**</li>
                    <li>
                        **Technical reflection report (1-2 pages)**â€”describe your problem, choices, and include: 
                        <ul>
                            <li>One table or chart showing performance or design trade-offs.</li>
                            <li>Security, fairness, or ethical consideration relevant to your project.</li>
                            <li>Future workâ€”how your project could tie into another field/discpline.</li>
                        </ul>
                    </li>
                </ul>

                <h3>Professional Standards</h3>
                <ul>
                    <li>Apply and document coding standards (**PEP 8**)</li>
                    <li>Include automated tests for major features (**Unit Testing**)</li>
                    <li>Demonstrate data structure efficiency (L2) and OOP usage (L3).</li>
                </ul>
                <p class="task-highlight">**ACTION:** Submit to <code>elvionailabs@gmail.com</code>. Email subject: â€œCS101 Capstone Submission â€“ [Your Name]â€.</p>

                <h3>Key Takeaways</h3>
                <p>Mastery comes from integrationâ€”combining code, data, communication, and critical reflection on how your work serves real people and real problems.</p>

                <div class="further-reading-section">
                    <h4>ðŸ“š Academic References & Further Reading</h4>
                    <p>Review the capstone project documentation requirements of leading university programs (MIT, Stanford) to ensure your final report meets professional standards.</p>
                </div>
            `,
            quiz: [
                {
                    type: 'mcq',
                    question: 'Which of these is NOT required for your project deliverable?',
                    options: ['Source code', 'Automated tests', 'Game controller', 'Technical report'],
                    answer: 'Game controller'
                },
                {
                    type: 'text',
                    question: 'Describe in 2-3 sentences how your capstone could be modified to serve a new discipline (e.g., education, health, arts, business).',
                    answer: 'A chat app could be modified for mental health support with triage rules (Health) or adapted for adaptive learning by tracking student progress (Education).'
                },
                {
                    type: 'mcq',
                    question: 'Which communication protocol would be best for real-time messaging in your app?',
                    options: ['SMTP', 'TCP sockets', 'IMAP', 'DHCP'],
                    answer: 'TCP sockets'
                },
                {
                    type: 'mcq',
                    question: 'What should your reflection include?',
                    options: [
                        'Only code files',
                        'Performance or design trade-offs, security/ethical concerns, cross-disciplinary application',
                        'Just test results',
                        'Game design tips'
                    ],
                    answer: 'Performance or design trade-offs, security/ethical concerns, cross-disciplinary application'
                },
                {
                    type: 'mcq',
                    question: 'What professional standard must your final code adhere to?',
                    options: ['Using only print statements', 'Code must be over 1000 lines', 'Applying PEP 8 style guidelines', 'Ignoring docstrings'],
                    answer: 'Applying PEP 8 style guidelines'
                }
            ]
        }
    ];

    // --- SOFTWARE ENGINEERING COURSE CONTENT (ALL Template Literals) ---
    const swe101Lessons = [
        {
            id: 1,
            title: 'L1: Software Engineering Discipline & Mindset',
            duration: '50 min',
            content: `
                <h2>What is Software Engineering? (SWE)</h2>
                <p>Software Engineering is the systematic, disciplined, quantifiable approach to the development, operation, and maintenance of software. It's not just coding; it's about building complex systems reliably, on time, and within budget, treating software development as an engineering discipline.</p>

                <h3>Why Engineering?</h3>
                <p>Unlike simple programming (where one person writes code for a small task), Software Engineering deals with:</p>
                <ul>
                    <li>**Scale:** Projects involving hundreds of developers and millions of lines of code.</li>
                    <li>**Reliability:** The software must work correctly, especially in critical applications (e.g., medical, aviation).</li>
                    <li>**Maintainability:** The ability for future teams to update and fix the software efficiently.</li>
                </ul>

                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--warning-color);">
                    <div class="area-header" style="color: var(--warning-color);"><span>The SWE Mindset</span></div>
                    <p>The core mindset of an engineer is: **Plan, Test, Document, and Optimize**. A software engineer spends far more time designing and verifying than writing the initial code.</p>
                </div>
                
                <h3>Activity: The Bridge Analogy</h3>
                <p>Consider a bridge builder (Civil Engineer) vs. someone nailing two boards together (Hobbyist). The bridge requires extensive planning, stress testing, material science, and regulatory compliance. Software development for a bank's security system is like building a bridge; an engineer is required.</p>
                
                <h3>Further Reading</h3>
                <ul>
                    <li>IEEE/ISO Standard for Software Engineering: <code>iso.org/standard/24640.html</code></li>
                    <li>"The Mythical Man-Month" by Frederick Brooks (On software project management).</li>
                </ul>
            `,
            quiz: [
                { type: 'mcq', question: 'Software Engineering is defined as a systematic, disciplined, quantifiable approach to:', options: ['Only coding tasks', 'The development, operation, and maintenance of software', 'Only bug fixing', 'Writing short scripts'], answer: 'The development, operation, and maintenance of software' },
                { type: 'mcq', question: 'Which characteristic is a major concern for Software Engineering but less so for simple programming?', options: ['Writing variable names', 'Choosing a text editor', 'Dealing with project scale and maintainability', 'Debugging basic loops'], answer: 'Dealing with project scale and maintainability' },
            ],
        },
        {
            id: 2,
            title: 'L2: SDLC and Methodologies (Agile vs. Waterfall)',
            duration: '60 min',
            content: `
                <h2>The Software Development Lifecycle (SDLC)</h2>
                <p>The SDLC is a process followed by a software project within a software organization. It outlines a detailed plan for how to develop, maintain, replace, or alter software systems. The common phases are: Planning, Requirements Analysis, Design, Implementation (Coding), Testing, Deployment, and Maintenance.</p>

                <h3>Waterfall Methodology</h3>
                <p>The Waterfall model is a sequential design process, where progress flows steadily downwards like a waterfall. Each phase must be completed and signed off before the next phase can begin.</p>
                <ul>
                    <li>**Pros:** Simple to understand, easy to manage due to rigid phases, good for small projects with clearly defined, unchanging requirements.</li>
                    <li>**Cons:** High risk for complex projects; no working software until late in the cycle; difficult to respond to changing requirements.</li>
                </ul>

                <h3>Agile Methodology</h3>
                <p>Agile is an iterative, incremental approach. It focuses on delivering value quickly and responding to change. It is guided by the **Agile Manifesto** principles: individuals and interactions over processes and tools, working software over comprehensive documentation, customer collaboration over contract negotiation, and responding to change over following a plan.</p>
                <ul>
                    <li>**Key Concepts:** **Sprints** (short, time-boxed iterations, typically 2-4 weeks), **Daily Standups**, **Product Backlogs**.</li>
                    <li>**Pros:** High customer satisfaction, early and continuous delivery of working software, highly adaptable to changes.</li>
                    <li>**Cons:** Requires intense customer involvement, can be hard to measure progress for complex projects without clear documentation.</li>
                </ul>

                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--primary-color);">
                    <div class="area-header" style="color: var(--primary-color);"><span>Real-World SDLC</span></div>
                    <p>Most modern tech companies use variations of Agile (like Scrum or Kanban) because product requirements in the tech industry change constantly. Waterfall is generally reserved for government contracts or embedded systems where requirements are fixed from the start.</p>
                </div>
            `,
            quiz: [
                { type: 'mcq', question: 'Which SDLC methodology requires that each phase be completed and signed off before the next phase begins?', options: ['Agile', 'Scrum', 'Kanban', 'Waterfall'], answer: 'Waterfall' },
                { type: 'mcq', question: 'The Agile methodology prioritizes "working software" over what, according to the manifesto?', options: ['Individuals and interactions', 'Comprehensive documentation', 'Responding to change', 'Customer collaboration'], answer: 'Comprehensive documentation' },
            ],
        },
        {
            id: 3,
            title: 'L3: Requirements and Design Documentation',
            duration: '45 min',
            content: `
                <h2>The Importance of Documentation</h2>
                <p>In software engineering, documentation is the blueprint for development. It ensures everyoneâ€”from the customer to the developerâ€”is aligned on what needs to be built and how it will function. Two critical types of documents are requirements and design.</p>

                <h3>Requirements Documentation (SRS)</h3>
                <p>The **Software Requirements Specification (SRS)** documents the functional and non-functional requirements of the system. This answers: **"What will the system do?"**</p>
                <ul>
                    <li>**Functional Requirements:** Define the features and services the system provides (e.g., "The system shall allow users to log in with a valid username and password").</li>
                    <li>**Non-functional Requirements:** Define the qualities of the system (e.g., **Performance:** "The system shall load the dashboard in under 2 seconds." **Security:** "All user data must be encrypted.").</li>
                </ul>

                <h3>Design Documentation</h3>
                <p>The Design Document details the high-level architecture and low-level component design. This answers: **"How will the system be built?"**</p>
                <ul>
                    <li>**UML Diagrams:** **Unified Modeling Language** diagrams (like Class Diagrams or Use Case Diagrams) are used to visually model the system's structure and behavior.</li>
                    <li>**Use Cases:** Describes how a user interacts with the system to achieve a specific goal (e.g., "User logs in" or "User creates a new order").</li>
                </ul>

                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--success-color);">
                    <div class="area-header" style="color: var(--success-color);"><span>The Engineer's Motto</span></div>
                    <p>A poorly written requirement leads to poorly written code. A Software Engineer's first job is not to code, but to **ensure the requirements are complete, consistent, and unambiguous.**</p>
                </div>
            `,
            quiz: [
                { type: 'mcq', question: 'Which requirement specifies the qualities of a system, such as speed or security?', options: ['Functional Requirement', 'Business Requirement', 'Non-functional Requirement', 'User Story'], answer: 'Non-functional Requirement' },
                { type: 'mcq', question: 'The Software Requirements Specification (SRS) primarily answers which question?', options: ['How long will it take to build?', 'What will the system do?', 'What coding language is best?', 'How much will it cost?'], answer: 'What will the system do?' },
            ],
        },
        {
            id: 4,
            title: 'L4: Introduction to Design Patterns',
            duration: '75 min',
            content: `
                <h2>Solving Common Problems with Design Patterns</h2>
                <p>In software engineering, a **Design Pattern** is a reusable solution to a commonly occurring problem within a given context in software design. They are not finished designs that can be plugged straight into your code; they are templates or blueprints for how to solve a problem.</p>

                <h3>The Three Categories</h3>
                <p>Patterns are usually categorized into three groups:</p>
                <ol>
                    <li>**Creational Patterns:** Concerned with the way objects are created (e.g., Factory, Singleton).</li>
                    <li>**Structural Patterns:** Concerned with composing classes and objects (e.g., Adapter, Decorator).</li>
                    <li>**Behavioral Patterns:** Concerned with communication between objects (e.g., Observer, Strategy).</li>
                </ol>

                <h3>Pattern Deep Dive: The Singleton Pattern (Creational)</h3>
                <p>The Singleton Pattern ensures a class has only **one instance** and provides a global point of access to it. This is useful for things like a single database connection pool or a global configuration manager.</p>
                <pre><code>// Example Concept: Singleton
class ConfigurationManager {
    private static instance: ConfigurationManager;
    private constructor() { /* Load settings */ }
    
    public static getInstance(): ConfigurationManager {
        if (!ConfigurationManager.instance) {
            ConfigurationManager.instance = new ConfigurationManager();
        }
        return ConfigurationManager.instance;
    }
}</code></pre>

                <h3>Pattern Deep Dive: The Factory Pattern (Creational)</h3>
                <p>The Factory Pattern provides an interface for creating objects in a superclass, but allows subclasses to alter the type of objects that will be created. This decouples the object creation logic from the client code.</p>
                <p style="color: var(--cyan-glow);">**Benefit:** Using design patterns leads to code that is more robust, reusable, and easier to maintain because it follows well-established engineering best practices.</p>
            `,
            quiz: [
                { type: 'mcq', question: 'A Design Pattern is best described as:', options: ['A finished, plug-and-play piece of code', 'A template for solving a common problem in a specific context', 'A legal contract for software design', 'A programming language feature'], answer: 'A template for solving a common problem in a specific context' },
                { type: 'mcq', question: 'Which creational pattern ensures a class has only one instance and provides a global access point?', options: ['Observer', 'Factory', 'Decorator', 'Singleton'], answer: 'Singleton' },
            ],
        },
        {
            id: 5,
            title: 'L5: Final Project: Architecting a System',
            duration: '90 min',
            content: `
                <h2>Course Capstone: The Architectural Design Document</h2>
                <p>Congratulations on completing the core lessons! Your final requirement is to apply the principles of Requirements Analysis, SDLC, and Design to create a professional **Architectural Design Document** for a new software system.</p>

                <h3>Project Brief: The "Elvion Academy Planner"</h3>
                <p>Design a system that allows Elvion University students to track their course progress, manage due dates, and visualize their overall Grade Point (GP) progress across all courses.</p>

                <h3>Required Sections for Submission</h3>
                <p>Your Design Document (PDF or Markdown file) must include the following sections (2000-word minimum total):</p>
                <ol>
                    <li>**Overview & Goals:** (500 words) What is the system? What problem does it solve? Define the target user.</li>
                    <li>**Requirements (SRS):** (500 words) Detail at least 5 **Functional** and 5 **Non-functional** requirements (e.g., Performance, Security, Usability).</li>
                    <li>**SDLC Justification:** (300 words) Which methodology (Agile or Waterfall) would you choose for this project and why?</li>
                    <li>**Architectural Design:** (700 words)
                        <ul>
                            <li>Propose a high-level architecture (e.g., 3-Tier, Microservices).</li>
                            <li>Identify two key components (e.g., Database, Authentication Service).</li>
                            <li>**Design Pattern Application:** Specify one Creational and one Structural/Behavioral design pattern you would use in a component and justify its use.</li>
                        </ul>
                    </li>
                </ol>
                
                <div class="interactive-code-area" style="background: rgba(18, 26, 48, 0.85); border-left: 4px solid var(--success-color);">
                    <div class="area-header" style="color: var(--success-color);"><span>Submission Instructions</span></div>
                    <p>This is a non-code project. Your final submission is the written document. Save your document as: <strong>SWE101_YourName_DesignDoc.pdf</strong>.</p>
                    <p style="color: var(--error-color); font-weight: bold;">**ACTION:** Email your final document to: <code>elvionailabs@gmail.com</code></p>
                </div>
                <p>Once you pass the final quiz below, click "Final Exam/Certificate" in the navigation bar to proceed with certificate request.</p>
            `,
            quiz: [
                { type: 'mcq', question: 'For the SWE101 course, what is the final deliverable requirement?', options: ['A full, working code application', 'An Architectural Design Document', 'A face-to-face interview', 'A group presentation'], answer: 'An Architectural Design Document' },
                { type: 'text', question: 'What is the email address to which you must submit your project for certificate review? (Enter exactly)', answer: 'elvionailabs@gmail.com' },
            ],
        }
    ];


    // Assembling all courses
    const allCourses = [
        // CS101 now uses the robust, detailed lessons
        { id: 'cs101', title: 'Computer Science', description: 'Fundamentals of computing, programming, and algorithms', icon: 'fas fa-laptop-code', totalLessons: 8, estimatedHours: 120, mediaType: 'video', lessons: cs101Lessons },
        // Software Engineering Course
        { id: 'swe101', title: 'Software Engineering', description: 'Design, develop, and maintain large-scale software systems.', icon: 'fas fa-cogs', totalLessons: 5, estimatedHours: 80, mediaType: 'video', lessons: swe101Lessons },
        // OTHER COURSES WITH GENERATED PLACEHOLDERS
        { id: 'law101', title: 'Law (LLB)', description: 'Comprehensive study of legal principles and practice.', icon: 'fas fa-balance-scale', totalLessons: 6, estimatedHours: 90, mediaType: 'video', lessons: generateDefaultLessons(6, 'LAW', false) },
        { id: 'eng101', title: 'English & Literary Studies', description: 'Study of English language, literature, and critical analysis.', icon: 'fas fa-pen-nib', totalLessons: 4, estimatedHours: 60, mediaType: 'audio', lessons: generateDefaultLessons(4, 'ENG', false) },
        { id: 'his101', title: 'History & Strategic Studies', description: 'World history, Nigerian history, and strategic studies.', icon: 'fas fa-globe-africa', totalLessons: 5, estimatedHours: 75, mediaType: 'audio', lessons: generateDefaultLessons(5, 'HIS', false) },
        { id: 'bus101', title: 'Business Administration', description: 'Principles of management, marketing, finance, and entrepreneurship.', icon: 'fas fa-chart-line', totalLessons: 7, estimatedHours: 100, mediaType: 'audio', lessons: generateDefaultLessons(7, 'BUS', true) },
        { id: 'mass101', title: 'Mass Communication', description: 'Journalism, public relations, broadcasting, and digital media communication.', icon: 'fas fa-bullhorn', totalLessons: 6, estimatedHours: 90, mediaType: 'audio', lessons: generateDefaultLessons(6, 'MASS', false) },
        { id: 'math101', title: 'Mathematics Education', description: 'Methods and strategies for teaching mathematics.', icon: 'fas fa-calculator', totalLessons: 5, estimatedHours: 70, mediaType: 'audio', lessons: generateDefaultLessons(5, 'MATED', false) },
        { id: 'aed101', title: 'Adult Education', description: 'Teaching and learning strategies for adult learners.', icon: 'fas fa-chalkboard-teacher', totalLessons: 4, estimatedHours: 60, mediaType: 'audio', lessons: generateDefaultLessons(4, 'ADULT', false) },
        {
            id: 'visart101',
            title: 'Visual Arts & Digital Media',
            description: 'A study of animation, painting, graphic design, and digital art.',
            icon: 'fas fa-palette',
            totalLessons: 6,
            estimatedHours: 95,
            mediaType: 'video',
            lessons: generateDefaultLessons(6, 'VA', true)
        },
    ];

    let currentUser = null;
    let userData = null;
    let currentCourse = null;
    let currentLesson = 1;
    let totalLessons = 0;
    let quizPassed = false; // New state to track if quiz is passed for navigation

    // URL Parameters
    const urlParams = new URLSearchParams(window.location.search);
    const courseId = urlParams.get('courseId');
    const lessonParam = urlParams.get('lesson');

    // ... (DOM Content Loaded and Star Animation code remains the same)

    // Mobile Menu Toggle
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const courseSidebar = document.getElementById('courseSidebar');

    mobileMenuToggle.addEventListener('click', () => {
        courseSidebar.classList.toggle('active');
    });

    // Close sidebar when clicking outside on mobile
    document.addEventListener('click', (e) => {
        if (window.innerWidth <= 992) {
            if (!courseSidebar.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                courseSidebar.classList.remove('active');
            }
        }
    });

    // Auth State Management
    onAuthStateChanged(auth, async (user) => {
        if (user) {
            currentUser = user;
            await loadUserData();
            await initializeCourseViewer();
        } else {
            // Redirect to enrollment page if not logged in
            window.location.href = 'enroll.html';
        }
    });

    async function loadUserData() {
        try {
            const userDocRef = doc(db, 'users', currentUser.uid);
            const userDoc = await getDoc(userDocRef);

            if (userDoc.exists()) {
                userData = userDoc.data();
                // Ensure totalPoints exists for new users
                if (userData.totalPoints === undefined) {
                    userData.totalPoints = 0;
                    await updateDoc(userDocRef, { totalPoints: 0 });
                }
            } else {
                // Redirect to dashboard (or enrollment flow) if user data is missing
                window.location.href = 'studyingatelvion.html';
            }
        } catch (error) {
            console.error('Error loading user data:', error);
            alert('Error loading user data. Please try again.');
        }
    }

    async function initializeCourseViewer() {
        if (!courseId) {
            alert('No course specified');
            window.location.href = 'studyingatelvion.html';
            return;
        }

        currentCourse = findCourseById(courseId);
        if (!currentCourse) {
            alert('Course not found');
            window.location.href = 'studyingatelvion.html';
            return;
        }

        totalLessons = currentCourse.totalLessons;
        currentLesson = parseInt(lessonParam) || 1;

        // Check if user is enrolled
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        if (!enrolledCourse) {
            alert('You are not enrolled in this course');
            window.location.href = 'studyingatelvion.html';
            return;
        }

        setupCourseInterface();
        renderLessonsList();
        loadLesson(currentLesson);

        document.getElementById('loadingContainer').style.display = 'none';
        document.getElementById('contentHeader').style.display = 'flex';
        document.getElementById('mainContent').style.display = 'block';
        document.getElementById('lessonNavigation').style.display = 'flex';
    }

    function findCourseById(courseId) {
        return allCourses.find(c => c.id === courseId);
    }

    function setupCourseInterface() {
        document.getElementById('courseIconLarge').className = `course-icon-large ${currentCourse.icon}`;
        document.getElementById('courseTitle').textContent = currentCourse.title;
        document.getElementById('courseSubtitle').textContent = currentCourse.description;

        // Populate Certificate Form details
        document.getElementById('formSubject').value = `Certificate Request: ${currentCourse.title}`;
        document.getElementById('completedCourseName').value = currentCourse.title;

        updateOverallProgress();
    }

    function updateOverallProgress() {
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        const progress = enrolledCourse?.progress || 0;
        const completedLessons = enrolledCourse?.completedLessons?.length || 0;

        document.getElementById('overallProgressBar').style.width = `${progress}%`;
        document.getElementById('overallProgressText').textContent = `${progress}% Complete (${completedLessons}/${totalLessons} lessons)`;

        // Update Total Points for GP (sidebar and nav)
        document.getElementById('totalPointsEarnedSidebar').textContent = userData.totalPoints || 0;
        document.getElementById('totalPointsEarnedNav').textContent = userData.totalPoints || 0;
        document.getElementById('formTotalPoints').value = userData.totalPoints || 0;
        document.getElementById('finalTotalPoints').textContent = userData.totalPoints || 0;
    }

    function renderLessonsList() {
        const container = document.getElementById('lessonsContainer');
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        const completedLessons = enrolledCourse?.completedLessons || [];

        container.innerHTML = '';

        currentCourse.lessons.forEach((lesson) => {
            const lessonNumber = lesson.id;
            const isCompleted = completedLessons.includes(lessonNumber);
            const isCurrent = lessonNumber === currentLesson;
            const isAccessible = lessonNumber <= (enrolledCourse?.currentLesson || 1);

            const lessonItem = document.createElement('div');
            lessonItem.className = `lesson-item ${isCurrent ? 'active' : ''} ${isCompleted ? 'completed' : ''}`;

            let statusIcon, statusClass;
            if (isCompleted) {
                statusIcon = '<i class="fas fa-check"></i>';
                statusClass = 'completed';
            } else if (isCurrent) {
                statusIcon = lessonNumber;
                statusClass = 'current';
            } else if (isAccessible) {
                statusIcon = lessonNumber;
                statusClass = ''; // Accessible but not current/completed
            } else {
                statusIcon = '<i class="fas fa-lock"></i>';
                statusClass = 'locked';
            }

            lessonItem.innerHTML = `
                <div class="lesson-status ${statusClass}">${statusIcon}</div>
                <div class="lesson-details">
                    <div class="lesson-title">${lesson.title}</div>
                    <div class="lesson-duration">${lesson.duration}</div>
                </div>
            `;

            if (isAccessible) {
                lessonItem.style.cursor = 'pointer';
                lessonItem.addEventListener('click', () => {
                    if (lessonNumber !== currentLesson) {
                        loadLesson(lessonNumber);
                        courseSidebar.classList.remove('active'); // Close on mobile navigation
                    }
                });
            } else {
                lessonItem.style.opacity = '0.5';
                lessonItem.style.cursor = 'not-allowed';
            }

            container.appendChild(lessonItem);
        });

        // Add the final certificate page link
        if (enrolledCourse?.progress === 100) {
            const finalItem = document.createElement('div');
            finalItem.className = `lesson-item ${currentLesson === totalLessons + 1 ? 'active' : ''}`;
            finalItem.style.borderLeftColor = 'var(--success-color)';
            finalItem.innerHTML = `
                <div class="lesson-status completed" style="background: var(--success-color);"><i class="fas fa-certificate"></i></div>
                <div class="lesson-details">
                    <div class="lesson-title" style="color: var(--success-color); font-weight: 700;">Final Exam/Certificate</div>
                    <div class="lesson-duration">Your Course GP is Ready</div>
                </div>
            `;
            finalItem.style.cursor = 'pointer';
            finalItem.addEventListener('click', () => {
                loadLesson(totalLessons + 1);
                courseSidebar.classList.remove('active'); // Close on mobile navigation
            });
            container.appendChild(finalItem);
        }
    }

    function loadLesson(lessonNumber) {
        currentLesson = lessonNumber;
        quizPassed = false; // Reset quiz state for the new lesson

        // Update URL without reloading
        const newUrl = new URL(window.location);
        newUrl.searchParams.set('lesson', lessonNumber);
        window.history.pushState({}, '', newUrl);

        // Hide all main content elements first
        document.getElementById('finalCoursePage').style.display = 'none';
        document.getElementById('contentHeader').style.display = 'flex';
        document.getElementById('lessonNavigation').style.display = 'flex';
        const contentCard = document.querySelector('.content-card');
        const quizContainer = document.getElementById('quizContainer');
        const mediaPlayer = document.getElementById('mediaPlayer');

        contentCard.style.display = 'block';
        mediaPlayer.style.display = 'flex';

        if (currentLesson === totalLessons + 1) {
            // Final Page Logic
            document.getElementById('contentHeader').style.display = 'none';
            document.getElementById('lessonNavigation').style.display = 'none';
            document.getElementById('finalCoursePage').style.display = 'block';
            contentCard.style.display = 'none';
            quizContainer.style.display = 'none';
            mediaPlayer.style.display = 'none';

            updateOverallProgress(); // Refresh GP
        } else {
            // Lesson Page Logic
            const lesson = currentCourse.lessons.find(l => l.id === lessonNumber);
            if (!lesson) return;

            // Update header
            document.getElementById('lessonTitle').textContent = lesson.title;
            document.getElementById('lessonDuration').textContent = lesson.duration;
            document.getElementById('currentLessonNumber').textContent = lessonNumber;
            document.getElementById('totalLessons').textContent = totalLessons;
            document.getElementById('lessonPoints').textContent = '10';
            document.getElementById('markCompleteBtn').style.display = 'none';

            // Update navigation
            document.getElementById('navCurrentLesson').textContent = lessonNumber;
            document.getElementById('navTotalLessons').textContent = totalLessons;

            // Update content
            document.getElementById('lessonContent').innerHTML = lesson.content;

            // Update media player
            const mediaPlaceholderText = document.getElementById('mediaPlaceholderText');
            if (currentCourse.mediaType === 'audio') {
                mediaPlayer.innerHTML = `
                    <audio controls style="width:100%; height: auto; outline:none; border-radius:10px; box-shadow:0 0 8px var(--cyan-glow);">
                        <source src="university/generic_audio.mp3" type="audio/mpeg">
                        Your browser does not support the audio element.
                    </audio>
                `;
                mediaPlaceholderText.textContent = 'Audio content for this lesson is available above.';
            } else {
                mediaPlayer.innerHTML = `
                <div class="media-placeholder">
                    <i class="fas fa-play-circle"></i>
                    <p id="mediaPlaceholderText">Video content coming soon</p>
                    <p style="font-size: 0.9rem; opacity: 0.7;">For now, please read the lesson content below</p>
                </div>
                `;
                mediaPlaceholderText.textContent = 'Video content coming soon';
            }

            // Render Quiz
            const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
            const isCompleted = enrolledCourse?.completedLessons?.includes(currentLesson);

            if (lesson.quiz) {
                quizContainer.style.display = 'block';
                renderQuiz(lesson.quiz, isCompleted);
            } else {
                quizContainer.style.display = 'none';
            }
        }

        // Update navigation buttons and state
        updateNavigationControls();

        // Update sidebar
        renderLessonsList();

        // Scroll to top
        window.scrollTo(0, 0);
    }

    function updateNavigationControls() {
        const prevBtn = document.getElementById('prevLessonBtn');
        const nextBtn = document.getElementById('nextLessonBtn');
        const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
        const isCompleted = enrolledCourse?.completedLessons?.includes(currentLesson);
        const isCourseFullyCompleted = enrolledCourse?.progress === 100;

        // Previous Button Logic
        prevBtn.disabled = currentLesson <= 1;

        // Next Button Logic
        if (currentLesson === totalLessons) {
            nextBtn.textContent = 'Final Exam/Certificate';
            // Enable only if all lessons are completed (progress 100%)
            nextBtn.disabled = !isCourseFullyCompleted && !isCompleted; // Use isCompleted as a fallback if progress hasn't updated immediately
        } else if (currentLesson === totalLessons + 1) {
            // On Final Page, next is always disabled
            nextBtn.textContent = 'Course Completed';
            nextBtn.disabled = true;
        } else if (isCompleted || quizPassed) {
            nextBtn.textContent = 'Next Lesson';
            nextBtn.disabled = false;
        } else {
            nextBtn.textContent = 'Pass Quiz to Unlock';
            nextBtn.disabled = true;
        }
    }

    // --- QUIZ LOGIC (Updated to include animation/feedback) ---

    function renderQuiz(quizData, isLessonCompleted) {
        const quizQuestionsContainer = document.getElementById('quizQuestions');
        quizQuestionsContainer.innerHTML = '';
        document.getElementById('quizResult').innerHTML = ''; // Clear result area

        // Hide submit button if lesson is already completed
        const submitBtn = document.getElementById('submitQuizBtn');
        submitBtn.style.display = isLessonCompleted ? 'none' : 'block';

        quizData.forEach((q, index) => {
            const questionElement = document.createElement('div');
            questionElement.className = 'quiz-question-wrapper';
            questionElement.style.marginBottom = '2rem'; // Separating questions

            // Check if the quiz is a code output type or a plain MCQ/Text type
            const questionContent = q.type === 'code-output' ? q.question : `Question ${index + 1}: ${q.question}`;

            questionElement.innerHTML = `
                <div class="quiz-question">${questionContent}</div>
                <div class="quiz-options" data-question-index="${index}">
                    ${q.type === 'mcq' || q.type === 'code-output' ? q.options.map(option => `
                        <div class="quiz-option" data-answer="${option}" ${isLessonCompleted ? 'style="cursor: default;"' : ''}>${option}</div>
                    `).join('') : ''}
                    ${q.type === 'text' ? `
                        <input type="text" class="text-input-answer" placeholder="Type your answer here..." style="width: 100%; padding: 1rem; border-radius: 8px; border: 2px solid rgba(0, 255, 255, 0.3); background: rgba(0, 0, 0, 0.5); color: var(--text-color); font-size: 1rem;" ${isLessonCompleted ? 'disabled' : ''}>
                    ` : ''}
                </div>
            `;
            quizQuestionsContainer.appendChild(questionElement);
        });

        // Add event listeners for MCQ selection only if not completed
        if (!isLessonCompleted) {
            quizQuestionsContainer.querySelectorAll('.quiz-option').forEach(option => {
                option.addEventListener('click', function () {
                    const optionsGroup = this.closest('.quiz-options');
                    // Deselect all others in the group
                    optionsGroup.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
                    // Select the clicked one
                    this.classList.add('selected');
                });
            });
        } else {
            // If completed, visually mark the correct answer on load
            quizData.forEach((q, index) => {
                const optionsGroup = document.querySelector(`.quiz-options[data-question-index="${index}"]`);
                if (q.type === 'mcq' || q.type === 'code-output') {
                    // Mark the correct answer
                    optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                } else if (q.type === 'text') {
                    const input = optionsGroup.querySelector(`.text-input-answer`);
                    // Ensure input box shows the correct answer if the lesson is complete
                    input.value = q.answer;
                    input.style.border = `2px solid var(--success-color)`;
                }
            });
            document.getElementById('quizResult').innerHTML = `<div class="quiz-feedback correct"><i class="fas fa-check-circle"></i> **Lesson Already Completed!** You may move to the next lesson.</div>`;
            quizPassed = true;
            updateNavigationControls();
        }
    }

    document.getElementById('submitQuizBtn').addEventListener('click', () => {
        const lesson = currentCourse.lessons.find(l => l.id === currentLesson);
        const quizData = lesson.quiz;
        let allCorrect = true;
        let score = 0;

        // Reset and evaluate
        quizData.forEach((q, index) => {
            const optionsGroup = document.querySelector(`.quiz-options[data-question-index="${index}"]`);
            let isCorrect = false;

            if (q.type === 'mcq' || q.type === 'code-output') {
                const selectedOption = optionsGroup.querySelector('.quiz-option.selected');

                // Clear all previous result classes and animation classes first
                optionsGroup.querySelectorAll('.quiz-option').forEach(opt => opt.classList.remove('correct', 'incorrect'));

                if (selectedOption) {
                    // Ensure comparison is case and whitespace insensitive for robustness
                    const selectedAnswer = selectedOption.dataset.answer.trim();
                    const correctAnswer = q.answer.trim();

                    if (selectedAnswer === correctAnswer) {
                        isCorrect = true;
                        selectedOption.classList.add('correct');
                    } else {
                        selectedOption.classList.add('incorrect');
                        // Highlight the correct answer
                        optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                    }
                } else {
                    // User did not select an answer, fail and highlight correct answer
                    optionsGroup.querySelector(`.quiz-option[data-answer="${q.answer}"]`)?.classList.add('correct');
                }
            } else if (q.type === 'text') {
                const input = optionsGroup.querySelector('.text-input-answer');
                const userAnswer = input.value.trim().toLowerCase().replace(/[.,;]/g, ''); // Remove common punctuation
                const correctAnswer = q.answer.trim().toLowerCase().replace(/[.,;]/g, '');

                // Simple check for text answer equivalence
                // Note: For complex text answers, this requires fuzzy matching which is beyond simple client-side JS.
                // We use exact/near-exact match here.
                if (userAnswer === correctAnswer || (q.type === 'text' && q.answer.includes(userAnswer))) { // Added a simple inclusion check for partial credit in some cases, although quiz design should favor exact matches.
                    isCorrect = true;
                    input.style.border = `2px solid var(--success-color)`;
                } else {
                    input.style.border = `2px solid var(--error-color)`;
                }
            }

            if (isCorrect) {
                score++;
            } else {
                allCorrect = false;
            }
        });

        const quizResultElement = document.getElementById('quizResult');
        const totalQuestions = quizData.length;
        // Require 80% to pass
        const requiredScore = Math.ceil(totalQuestions * 0.8);
        const passed = score >= requiredScore;

        if (passed) {
            quizResultElement.innerHTML = `
                <div class="quiz-feedback correct">
                    <i class="fas fa-check-circle"></i> **Quiz Passed!** You got ${score}/${totalQuestions} correct. Lesson unlocked!
                </div>
            `;
            // Mark lesson complete and show modal.
            markLessonComplete();
            document.getElementById('submitQuizBtn').style.display = 'none'; // Hide submit after passing
        } else {
            quizResultElement.innerHTML = `
                <div class="quiz-feedback incorrect">
                    <i class="fas fa-times-circle"></i> **Quiz Failed.** Score: ${score}/${totalQuestions}. You need ${requiredScore} to pass. Please review the lesson and try again.
                </div>
            `;
            // Disable navigation controls if quiz failed
            quizPassed = false;
            updateNavigationControls();
        }
    });

    // --- END QUIZ LOGIC ---


    // Event Listeners
    document.getElementById('prevLessonBtn').addEventListener('click', () => {
        if (currentLesson === totalLessons + 1) {
            loadLesson(totalLessons); // Back from final page to last lesson
        } else if (currentLesson > 1) {
            loadLesson(currentLesson - 1);
        }
    });

    document.getElementById('nextLessonBtn').addEventListener('click', () => {
        if (currentLesson < totalLessons) {
            // This is only enabled if the lesson is completed/quiz is passed
            loadLesson(currentLesson + 1);
        } else if (currentLesson === totalLessons) {
            // Go to final page (Only enabled if progress is 100)
            const enrolledCourse = userData.enrolledCourses?.find(c => c.courseId === courseId);
            if (enrolledCourse?.progress === 100 || enrolledCourse?.completedLessons?.includes(totalLessons)) {
                loadLesson(currentLesson + 1);
            }
        }
    });

    document.getElementById('continueBtn').addEventListener('click', () => {
        document.getElementById('completionModal').style.display = 'none';
        if (currentLesson < totalLessons) {
            loadLesson(currentLesson + 1);
        } else if (currentLesson === totalLessons) {
            loadLesson(currentLesson + 1); // Go to the final certificate page
        }
    });

    // Corrected Dashboard Redirect
    document.getElementById('backToDashboardBtn').addEventListener('click', () => {
        window.location.href = 'studyingatelvion.html';
    });

    async function markLessonComplete() {
        try {
            const enrolledCourseIndex = userData.enrolledCourses.findIndex(c => c.courseId === courseId);
            if (enrolledCourseIndex === -1) return;

            const enrolledCourse = userData.enrolledCourses[enrolledCourseIndex];

            // Check for double completion (to prevent point inflation)
            if (enrolledCourse.completedLessons?.includes(currentLesson)) {
                // Already completed, just update session state and show modal
                quizPassed = true;
                updateNavigationControls();
                document.getElementById('pointsEarned').textContent = '0 (Already earned)';
                document.getElementById('completionModal').style.display = 'flex';
                return;
            }

            // Add to completed lessons
            if (!enrolledCourse.completedLessons) {
                enrolledCourse.completedLessons = [];
            }
            enrolledCourse.completedLessons.push(currentLesson);

            // Update current lesson access: currentLesson + 1
            enrolledCourse.currentLesson = Math.max(enrolledCourse.currentLesson || 1, currentLesson + 1);

            // Calculate progress
            const completedCount = enrolledCourse.completedLessons.length;
            enrolledCourse.progress = Math.round((completedCount / totalLessons) * 100);

            // Update user data: GP/Points logic is here
            userData.enrolledCourses[enrolledCourseIndex] = enrolledCourse;
            userData.completedLessons = (userData.completedLessons || 0) + 1;
            userData.totalPoints = (userData.totalPoints || 0) + 10; // 10 points per lesson

            // Save to database
            await updateDoc(doc(db, 'users', currentUser.uid), {
                enrolledCourses: userData.enrolledCourses,
                completedLessons: userData.completedLessons,
                totalPoints: userData.totalPoints
            });

            // Update UI
            updateOverallProgress();
            renderLessonsList();

            // Mark Quiz as passed for this session
            quizPassed = true;
            updateNavigationControls();

            // Show completion modal
            document.getElementById('pointsEarned').textContent = '10';
            document.getElementById('completionModal').style.display = 'flex';

        } catch (error) {
            console.error('Error marking lesson complete:', error);
            alert('Error updating progress. Please try again.');
        }
    }

    // Initialize stars (outside of DOMContentLoaded to be safe with module imports)
    document.addEventListener('DOMContentLoaded', () => {
        const starsContainer = document.getElementById('stars-container');
        const numStars = 100;
        const minSize = 1;
        const maxSize = 3;
        for (let i = 0; i < numStars; i++) {
            const star = document.createElement('div');
            star.className = 'star';
            const size = Math.random() * (maxSize - minSize) + minSize;
            star.style.width = `${size}px`;
            star.style.height = `${size}px`;
            star.style.left = `${Math.random() * 100}%`;
            star.style.top = `${Math.random() * 100}%`;
            star.style.animationDelay = `${Math.random() * 4}s`;
            star.style.animationDuration = `${3 + Math.random() * 2}s`;
            starsContainer.appendChild(star);
        }
    });

</script>
</body>
</html>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J1YTKP10ZX"></script>
<script>
Â  window.dataLayer = window.dataLayer || [];
Â  function gtag(){dataLayer.push(arguments);}
Â  gtag('js', new Date()); 

Â  gtag('config', 'G-J1YTKP10ZX');
</script>

Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  
Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â  Â Â Â  
